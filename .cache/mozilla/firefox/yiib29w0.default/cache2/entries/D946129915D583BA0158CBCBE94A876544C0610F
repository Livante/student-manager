var divTop = page,exA,exB,tipRuta,idOrasSelected,moduriCautareSelected,moduriCautare,ajaxStatistici = [],control,controlOptions,rute,nrWaypoints
var isMobile=false;

function getTaxi(minMax) {
	$("#tab_alternativ_taxi").remove();
	var amGasitOras = 0;
	$.each(pageVars['orase'], function(k, oras) {
		if (oras['bounds'][0][0] != null && oras['bounds'][0][0] <= minMax[0][0] && oras['bounds'][0][1] != null && oras['bounds'][0][1] <= minMax[0][1] && oras['bounds'][1][0] != null && oras['bounds'][1][0] >= minMax[1][0] && oras['bounds'][1][1] != null && oras['bounds'][1][1] >= minMax[1][1] && amGasitOras == 0) {
			amGasitOras = 1;
			if (oras['pret_taxi'] > 0) {
				pageVars['generale']['directionsDisplayTaxi']['pret'] = oras['pret_taxi'];
				if (tipRuta == 'auto') {
					if ($("#tab_alternativ_taxi").length == 0) {
						$(".rute_alternative").append(createTabTaxi(pageVars['texte']['string_taxi'], oras['pret_taxi']));
					};
				} else if (tipRuta == 'pe-jos' || tipRuta == 'bicicleta' || tipRuta == 'autobuz') {
					getRutaTaxi(oras['pret_taxi']);
				};
			};
		};
	});
	if (amGasitOras == 0) {
		$.ajax({
			url: '/inc/ajax.php',
			dataType: 'script',
			type: 'post',
			data: {
				'for': 'bounds_orase_taxi',
				'minLat': minMax[0][0],
				'minLng': minMax[0][1],
				'maxLat': minMax[1][0],
				'maxLng': minMax[1][1]
			},
			success: function() {
				if (d !== null) {
					pageVars['orase'].push(d);
					getTaxi(minMax);
				};
			}
		});
	};
};
function getRutaTaxi(pret){
	var latOrigin, lngOrigin, latDestination, lngDestination;
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][0].toString().indexOf('|') == -1) {latOrigin = parseFloat(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][0]);} else {latOrigin = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][0].split('|'); latOrigin = parseFloat(latOrigin[0]);};
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][1].toString().indexOf('|') == -1) {lngOrigin = parseFloat(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][1]);} else {lngOrigin = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][1].split('|'); lngOrigin = parseFloat(lngOrigin[0]);};
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][0].toString().indexOf('|') == -1) {latDestination = parseFloat(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][0]);} else {latDestination = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][0].split('|'); latDestination = parseFloat(latDestination[0]);};
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][1].toString().indexOf('|') == -1) {lngDestination = parseFloat(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][1]);} else {lngDestination = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][1].split('|'); lngDestination = parseFloat(lngDestination[0]);};
	
	$.ajax({
		url: 'https://router.project-osrm.org/route/v1/driving/'+lngOrigin+','+latOrigin+';'+lngDestination+','+latDestination,
		dataType: 'json',
		type: 'get',
		data: {
			'overview': 'simplified',
			'geometries': 'geojson',
			'alternatives': 'false'
		},
		success: function(res) {
			if (res && res.code=="Ok") {
				pageVars.generale.taxi.path = [];
				for (var i=0; i<res.routes[0].geometry.coordinates.length; i++) {
					pageVars.generale.taxi.path.push(res.routes[0].geometry.coordinates[i].reverse());
				};
				pageVars.generale.taxi.durata = res.routes[0].duration;
				pageVars.generale.taxi.distanta = res.routes[0].distance;
				if ($("#tab_alternativ_taxi").length == 0) {
					$(".rute_alternative").append(createTabTaxi(pageVars['texte']['string_taxi'], pageVars['generale']['directionsDisplayTaxi'].pret));
				};
				pageVars.generale.taxi.obj.setLatLngs(res.routes[0].geometry.coordinates);
			};
		}
	});
};

function mouseOverTabTaxi(pret) {
	$("#tab_alternativ_taxi").attr("class", "ruta_alternativa_selected");
	if (tipRuta == 'auto') {
		var distanta = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['distanta'];
		var durata = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['durata'];
	} else if (tipRuta == 'pe-jos' || tipRuta == 'bicicleta' || tipRuta == 'autobuz') {
		var distanta = pageVars.generale.taxi.distanta;
		var durata = pageVars.generale.taxi.durata;
		pageVars.generale.taxi.obj.setLatLngs(pageVars.generale.taxi.path);
		pageVars.generale.taxi.obj.addTo(getFrame('iframe_harta').map);
	};
	updateConsum([distanta, durata], pret);
};

function mouseOutTabTaxi() {
	$("#tab_alternativ_taxi").attr("class", "ruta_alternativa");
	pageVars.generale.taxi.obj.setLatLngs([]);
	pageVars.generale.taxi.obj.remove();
	updateConsum(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'], 0);
};

function getRutaServer(data, tip, e){
	clearStradaObiectiv();
	pageVars['generale']['rutaGoogleInProcess'] = 1;
	refreshVarsPageVars();
	var waypoints = [];
	for (i = 0; i < pageVars[tip]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length; i++) {
		waypoints.push({
			latLng: getFrame('iframe_harta').getPoint(pageVars[tip]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][i][0], pageVars[tip]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][i][1]),
			name: pageVars[tip]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][i],
			options: {allowUTurn: true}
		});
	};
	if (control) {
		control.setWaypoints(waypoints);
		controlOptions.lineOptions = {styles:[{color: pageVars[tip]['orase'][idOrasSelected]['culori'][pageVars[tip]['orase'][idOrasSelected]['nume_culoare_selected']],opacity: 0.7,weight: 5}]};
	};
};

//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Facute
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function getOptiuniSelectate() {
	refreshVarsPageVars();
	var optiuni = [];
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ui'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ui'].length > 0) {
		for (var i = 0; i < pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ui'].length; i++) {
			$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ui'][i], function(key, value) {
				if (value[0] == true && value[4] && value[4] > 0) {
					optiuni.push(value[4]);
				};
			});
		};
	};
	return optiuni;
};

function showCookieTerms() {
	showInfoAlert("<span style=\"font-size: 22px;\">Cookie-urile ne ajut" + String.fromCharCode(259) + " s" + String.fromCharCode(259) + " v" + String.fromCharCode(259) + " oferim serviciile noastre.</span><br />" +
		"<span style=\"font-size: 12px;\">Utiliz" + String.fromCharCode(226) + "nd aceste servicii, accepta" + String.fromCharCode(355) + "i modul " + String.fromCharCode(238) + "n care noi " + String.fromCharCode(351) + "i partenerii no" + String.fromCharCode(351) + "tri utiliz" + String.fromCharCode(259) + "m cookie-urile.</span> <a href=\"javascript:void(0);\" onclick=\"showCookiePolicies();\" style=\"font-size: 12px; color: black;\">Afla" + String.fromCharCode(355) + "i mai multe</a>", null);
	$(".div_alert").addClass("cookie");
};

function showCookiePolicies() {
	inchideAlert();
	if ($("#bottom-cookie").is(":visible")) {
		return;
	};
	removeDivsInfo();
	$("#bottom-cookie").show();
	if ($.inArray(['bottom-cookie', 'hide', true], pageVars['generale']['id_div_for_hidden']) == -1) {
		pageVars['generale']['id_div_for_hidden'].push(['bottom-cookie', 'hide', true]);
	};
	$.cookie('cookie_accepted', 1, {
		expires: 365,
		path: '/'
	});
};

function CheckPhoneNumber(TheNumber) {
	var valid = 1;
	var GoodChars = "0123456789()-+. ";
	var i = 0;
	if (TheNumber == "") {
		valid = 0;
	};
	for (i = 0; i <= TheNumber.length - 1; i++) {
		if (GoodChars.indexOf(TheNumber.charAt(i)) == -1) {
			valid = 0;
		};
	};
	return valid;
};
t_rid = 'distanta-ro';

function traficRO() {
	t_js_dw_time = new Date().getTime();
	t_js_load_src = ((document.location.protocol == 'http:') ? 'http://storage.' : 'https://secure.') + 'trafic.ro/js/trafic.js?tk=' + (Math.pow(10, 16) * Math.random()) + '&t_rid=' + t_rid;
	if (document.createElement && document.getElementsByTagName && document.insertBefore) {
		t_as_js_en = true;
		var sn = document.createElement('script');
		sn.type = 'text/javascript';
		sn.async = true;
		sn.src = t_js_load_src;
		var psn = document.getElementsByTagName('script')[0];
		psn.parentNode.insertBefore(sn, psn);
	}
};
var emailfilter = /^\w+[\+\.\w-]*@([\w-]+\.)*\w+[\w-]*\.([a-z]{2,4}|\d+)$/i;

function checkmail(e) {
	var returnval = emailfilter.test(e);
	return returnval;
};

function isNumberKey(evt, t) {
	var k = 0;
	var numar = t.id.substr(10, 1);
	var charCode = (evt.which) ? evt.which : event.keyCode;
	if (charCode > 31 && (charCode < 48 || charCode > 57)) {
		n[numar] = '';
		t.value = '';
	} else {
		k = 1;
	};
	if (k == 1) {
		if (parseInt(t.value) > 0 && parseInt(t.value) < 50) {
			n[numar] = parseInt(t.value);
			return true;
		} else {
			if (t.value == '') {
				n[numar] = 0;
				t.value = '';
			} else {
				t.value = n[numar];
			};
		};
	};
};

function getChar(e) {
	var keynum;
	if (window.event) {
		keynum = e.keyCode;
	} else if (e.which) {
		keynum = e.which;
	};
	return keynum;
};

function stu(l) {
	var u = '';
	for (var i = 0; i < l.length; i++) {
		if (l.charCodeAt(i) > 127) {
			u += '&#' + l.charCodeAt(i) + ';';
		} else {
			u += l.charAt(i);
		};
	};
	return u;
};

function inchideBanner() {
	return; /* unitate = $("#" + idUnit).detach(); */
	$("#inchideBanner").hide();
	$(mesajUnit).css({
		'visibility': 'visible'
	});
	$('body').append(mesajUnit);
	inapoiBuyNow();
};
var showBanner = function() {
	return; /* $('body').append(unitate); */
	$("#inchideBanner").show();
	$(mesajUnit).css({
		'visibility': 'hidden'
	}); /* mesajUnit = $("#" + idMesajUnit).detach(); */
};

function amPlatitDeja() {
	return;
	hideBuyNow();
	hideMesajPlataExpirata();
	hideMesajEmailInexistent();
	$("#plata_go").css({
		'visibility': 'visible'
	});
	$("#link_inapoi").show();
	$("#plata_loading").css({
		'display': 'none'
	});
	$("#email_platit_deja").attr({
		'disabled': false
	});
	showFormEmailBuy();
};

function inapoiBuyNow() {
	return;
	hideFormEmailBuy();
	hideMesajPlataExpirata();
	hideMesajEmailInexistent();
	showBuyNow();
};

function showFormEmailBuy() {
	return;
	$("#link_inapoi").show();
	$("#form_email").show();
	$("#email_platit_deja").focus();
};

function hideFormEmailBuy() {
	return;
	$("#link_inapoi").hide();
	$("#form_email").hide();
};

function showBuyNow() {
	return;
	$("#link_am_platit_deja").show();
	$("#form_buy").show();
};

function hideBuyNow() {
	return;
	$("#link_am_platit_deja").hide();
	$("#form_buy").hide();
};

function showMesajPlataExpirata() {
	return;
	$("#plata_expirata").show();
};

function hideMesajPlataExpirata() {
	return;
	$("#plata_expirata").hide();
};

function showMesajEmailInexistent() {
	return;
	$("#email_inexistent").show();
};

function hideMesajEmailInexistent() {
	return;
	$("#email_inexistent").hide();
};

function checkEmailPlata() {
	return;
	var email = $("#email_platit_deja").val();
	if (checkmail(email) === false) {
		$("#email_platit_deja").css({
			'color': 'red'
		});
		return;
	};
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'check_email_paypal',
			'email': email
		},
		success: function(d) {
			d = eval(d);
			switch (d[0]) {
				case 'NU_EXISTA':
					hideFormEmailBuy();
					hideBuyNow();
					hideMesajPlataExpirata();
					$("#plata_go").css({
						'visibility': 'visible'
					});
					$("#plata_loading").css({
						'display': 'none'
					});
					$("#email_platit_deja").attr({
						'disabled': false
					});
					showMesajEmailInexistent();
					break;
				case 'OK':
					$("#" + idMesajUnit).remove(); /* $("#" + idUnit).remove(); */
					$.cookie('noBanner', 1, {
						expires: d[2],
						path: '/'
					});
					break;
				case 'PERIOADA_EXPIRATA':
					hideFormEmailBuy();
					hideBuyNow();
					hideMesajEmailInexistent();
					$("#plata_go").css({
						'visibility': 'visible'
					});
					$("#plata_loading").css({
						'display': 'none'
					});
					$("#email_platit_deja").attr({
						'disabled': false
					});
					$("#data_platii").html(d[1]);
					$("#data_expirarii").html(d[2]);
					showMesajPlataExpirata();
					break;
			};
		},
		beforeSend: function() {
			$("#plata_go").css({
				'visibility': 'hidden'
			});
			$("#link_inapoi").hide();
			$("#plata_loading").css({
				'display': 'inline-block'
			});
			$("#email_platit_deja").attr({
				'disabled': true
			});
		}
	});
	return;
};

function keyDownEmailPlatitDeja(e) {
	return;
	$("#email_platit_deja").css({
		'color': 'black'
	});
	if (returnKeyCode(e) == 13) {
		checkEmailPlata();
	};
};
function cutCoords(coord) {
	var maxLength = 9;
	coord = (Math.round(coord * Math.pow(10, maxLength - 3)) / Math.pow(10, maxLength - 3)).toString();
	var str_zero = '';
	if (coord.length < maxLength) {
		for (var i = 0; i < (maxLength - coord.length); i++) {
			str_zero = str_zero + '0';
		};
	};
	coord = coord + str_zero;
	return coord;
};
function focusFormularContact() {
	$("#mesaj_after_contact").html("");
	if ($("#nume").val() == "") {
		$("#nume").focus();
		return;
	};
	if ($("#email").val() == "" || checkmail($("#email").val()) == false) {
		$("#email").focus();
		return;
	};
	if ($("#telefon").val() == "" || CheckPhoneNumber($("#telefon").val()) == 0 || $("#telefon").val().length < 10) {
		$("#telefon").focus();
		return;
	};
	if ($("#mesaj").val() == "") {
		$("#mesaj").focus();
		return;
	};
	return 1;
};

function trimiteContact() {
	if (focusFormularContact() == 1) {
		var nume = stu($("#nume").val()).replace(/&/g, '_ampersant_').replace(/\\n/g, '<br />').replace(/\+/g, '_plus_');
		var email = stu($("#email").val()).replace(/&/g, '_ampersant_').replace(/\\n/g, '<br />').replace(/\+/g, '_plus_');
		var telefon = stu($("#telefon").val()).replace(/&/g, '_ampersant_').replace(/\\n/g, '<br />').replace(/\+/g, '_plus_');
		var mesaj = stu($("#mesaj").val()).replace(/&/g, '_ampersant_').replace(/\\n/g, '<br />').replace(/\+/g, '_plus_');
		$.ajax({
			url: '/inc/ajax.php',
			dataType: 'text',
			type: 'post',
			data: {
				'for': 'contact',
				'nume': nume,
				'email': email,
				'telefon': telefon,
				'mesaj': mesaj
			},
			success: function(data) {
				if (data == '1') {
					$("#mesaj_after_contact").html(pageVars['texte']['mesaj_after_contact'])
				} else {
					$("#mesaj_after_contact").html(pageVars['texte']['mesaj_after_no_contact'])
				};
				$("#mesaj_after_contact").show();
				$("#nume").val('');
				$("#email").val('');
				$("#telefon").val('');
				$("#mesaj").val('');
				defaultValInputs($("#nume"), pageVars['texte']['nume_contact']);
				defaultValInputs($("#email"), pageVars['texte']['email_contact']);
				defaultValInputs($("#telefon"), pageVars['texte']['telefon_contact']);
				defaultValInputs($("#mesaj"), pageVars['texte']['mesaj_contact']);
			}
		});
	};
};

function setWidthAOptiuni(width) {
	$("#optiuni").width(width);
};
var browser = getBrowser();

function resolveIEBugs() {
	if (browser == 'MSIE') {
		$("#hst").css("background-image", "url('" + pathToImg + "px-trans.png')");
		$("#plus_minus").css("background-image", "url('" + pathToImg + "px-trans.png')");
		$("#trafic").css("background-image", "url('" + pathToImg + "px-trans.png')");
		$("#drumuri").css("background-image", "url('" + pathToImg + "px-trans.png')");
		$('.div_alert').css("background-image", "url('" + pathToImg + "px-trans.png')");
	};
};

function assignDivsBottom() {
	$("#bottom-info").append($("#info").html());
	$("#info").remove();
	$("#bottom-termeni").append(createEl('h1', {}, pageVars['texte']['string_termeni_conditii']), createEl('p', {}, pageVars['texte']['termeni_conditii']));
	$("#bottom-distante").append(createEl('h1', {}, pageVars['texte']['string_harti_distante']), createEl('p', {
		'style': 'float:left;',
		'id': 'linkuri-harti'
	}));
	prepareLinksHarti($("#links-harti").html(), 'linkuri-harti');
	$("#links-harti").remove();
	$("#bottom-contact").append(createFormularContact());
	$("#bottom-cookie").append(createCookiePolicies());
};

function positionDivBottomMijloc() {
	left = Math.round(($("#bottom").outerWidth() / 2) - ($("#bottom-mijloc").outerWidth() / 2));
	$("#bottom-mijloc").css("left", left);
};

function getBrowser() {
	var x = navigator.userAgent;
	for (var i = 0; i < pageVars['generale']['browsers'].length; i++) {
		if (x.indexOf(pageVars['generale']['browsers'][i]) != -1) {
			return pageVars['generale']['browsers'][i];
			break;
		};
	};
};

function returnKeyCode(e) {
	if (e) {
		return e.keyCode;
	};
};

function shorterString(string, limit) {
	if (string.length > limit) {
		string = string.substr(0, limit - 4) + "...";
	};
	return string;
};

function randomNumber(minim, maxim) {
	rand = Math.round(Math.random() * (maxim - minim) + minim);
	return rand;
};

function transformSecundeToText(secunde, string_simbol) {
	minute = Math.round(secunde / 60);
	ore = Math.floor(minute / 60);
	minute = minute - (ore * 60);
	zile = Math.floor(ore / 24);
	ore = ore - (zile * 24);
	string = ((zile > 0) ? zile + ' ' + ((zile == 1) ? pageVars['texte']['string_zi'] : pageVars['texte']['string_zile']) + ', ' : '') + ((ore > 0) ? ore + ' ' + ((string_simbol == 'string') ? ((ore == 1) ? pageVars['texte']['string_ora'] : pageVars['texte']['string_ore']) : pageVars['texte']['string_simbol_ore']) + ' ' : '') + ((minute > 0) ? minute + ' ' + pageVars['texte']['string_simbol_minute'] : '');
	return string;
};

function transformDistantaToText(distanta, um) {
	dist = Math.round(distanta / parseFloat(pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][4]));
	return dist + ' ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1];
};

function getNrCustomObjects(obj) {
	var length = 0;
	for (var i in obj) {
		length++;
	};
	return length;
};

function calculateVolumCarburant() {
	return Math.ceil(pageVars['generale']['litri_la_suta'] * pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][4] / pageVars['generale']['unitati_masura_volum'][pageVars['generale']['default_um']][2] / 100) / 10;
};

function setVarsTranslate() {};

function calculateDIS(cost, secunde, metri) {
	return (Math.round(cost * Math.pow(secunde, 2) / Math.pow(metri, 3) * 100000000) / 100).toString().replace('.', ',');
};

function calculateDistanta(metri, no) {
	var UM = metri / pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][4];
	var rest = metri - Math.round(parseInt(UM) * pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][4]);
	if (pageVars['generale']['default_um'] == 0) {
		if (UM > 15) {
			rest = 0;
			return Math.round(UM) + ' ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1];
		} else if (UM > 5) {
			rest = Math.round(rest / 100);
			return Math.floor(UM) + ((rest > 0) ? "," + rest : "") + ' ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1];
		} else if (UM > 1) {
			rest = Math.round(rest / 10);
			return Math.floor(UM) + ((rest > 0) ? ((rest < 10) ? ",0" + rest : "," + rest) : "") + ' ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1];
		} else if (!no) {
			return (Math.round(metri * 100) / 100).toString().replace(".", ",") + ' ' + pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][2];
		} else if (no) {
			return (Math.round(metri)).toString().replace(".", ",") + ' ' + pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][2];
		};
	} else {
		if (UM > 15) {
			rest = 0;
			return Math.round(UM) + ' ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1];
		} else if (UM > 5) {
			rest = Math.round(Math.round(rest / pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][4]) / 100) * 100;
			return Math.floor(UM) + ' ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1] + ' ' + pageVars['texte']['si'] + ' ' + rest + ' ' + pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][2];
		} else if (UM > 1) {
			rest = Math.round(Math.round(rest / pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][4]) / 10) * 10;
			return Math.floor(UM) + ' ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1] + ' ' + pageVars['texte']['si'] + ' ' + rest + ' ' + pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][2];
		} else if (!no) {
			rest = Math.round(rest / pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][4] * 100) / 100;
			return rest.toString().replace(".", ",") + ' ' + pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][2];
		} else if (no) {
			rest = Math.round(rest / pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][4]);
			return rest.toString().replace(".", ",") + ' ' + pageVars['generale']['unitati_masura_distante2'][pageVars['generale']['default_um']][2];
		};
	};
};

function calculateShareMaxWidth() {
	// pe atat ii ramane sa se intinda
	var catMaiAre = $("#top").width() - 252 - $("#orase").width();
	// lui ii trebuie 
	var catIiTrebuie = $("#share").width();
	var marginRight = catMaiAre - catIiTrebuie;
	if (marginRight > 0) {
		marginRight = 0;
	};
	return marginRight;
};

function setPageTitle() {
	window.document.title = pageVars[tipRuta]['orase'][idOrasSelected][pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare'][moduriCautareSelected]]['title'];
};

function attachDivTop() {
	refreshVarsPageVars();
	var divs = ['default', 'oras', 'orase'];
	$.each(divs, function(key, value) {
		$("#top > #" + value).remove();
	});
	$("#top_blablacar").remove();
	switch (divTop) {
		case 'index':
			//$("#top #share").before(createTopBlablacar());
			break;
		case 'oras':
			break;
		case 'oras-oras':
			if (tipRuta == 'linie-dreapta') {
				$("#top #share").before(
					createSpanTopOrasOrasLinieDreapta(
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][0],
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'].length - 1],
						calculateDistanta(
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results']['distanta']
						)
					)
				);
			} else if (tipRuta == 'autobuz') {
				if (moduriCautare == 'rute') {
					$("#top #share").before(
						createSpanTopOrasOras(
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['statii'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['order'][0]]['nume'],
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['statii'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['order'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['order'].length - 1]]['nume'],
							calculateDistanta(
								pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['buses'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['buses']][0],
								1
							),
							transformSecundeToText(
								pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['buses'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['buses']][3],
								'simbol'
							)
						)
					);
				} else if (moduriCautare == 'linii') {
					$("#top #share").before(
						createSpanTopAutobuzeLinie(
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['nume_tip_mijloc_articulat'],
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['nume'],
							pageVars[tipRuta]['orase'][idOrasSelected]['nume']
						)
					);
				} else if (moduriCautare == 'statii') {
					$("#top #share").before(
						createSpanTopAutobuzeStatie(
							pageVars['texte']['statia'] + ' ' + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['nume'],
							pageVars[tipRuta]['orase'][idOrasSelected]['nume']
						)
					);
				};
			} else if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] >= 0) {
				$("#top #share").before(
					createSpanTopOrasOras(
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][0],
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'].length - 1],
						transformDistantaToText(
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['distanta'],
							pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][2]
						),
						transformSecundeToText(
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['durata'],
							'simbol'
						)
					)
				);
			};
			break;
		case 'autobuze':
			$("#top #share").before(createSpanTopDefault());
			break;
		case 'autobuze-linie':
			$("#top #share").before(createSpanTopDefault());
			break;
		case 'autobuze-statie':
			$("#top #share").before(createSpanTopDefault());
			break;
		default:
			$("#top #share").before(createSpanTopDefault());
	};
	/* $("#top #share").show().css({
		right: calculateShareMaxWidth()
	}); */
};

function setHashHandi() {
	if (page != 'index') {
		return;
	};
	if (pageVars['generale']['hash'] != "" && !history.pushState) {
		window.location.href = 'https://' + location.host + '/#!' + pageVars['generale']['hash'];
		pageVars['generale']['hash'] = "";
	};
};

function refreshVarsPageVars() {
	tipRuta = pageVars['generale']['tip_ruta'];
	idOrasSelected = pageVars[tipRuta]['id_oras_selected'];
	moduriCautareSelected = pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare_selected'];
	moduriCautare = pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare'][moduriCautareSelected];
};

function calculeazaPretTaxi(distanta, pret) {
	pret = Math.ceil(distanta / 1000 * pret + pret * 1.5);
	return pret;
};

function adjustHeightDetaliiConsum() {
	var dif_ctr_t = $("#content_tab_ruta").height() - $("#traseu").height();
	var height = $("#main").height() - $("#top").height() - $("#taburi").height() - $("#content_tab_detalii_consum").height() - $("#content_tab_detalii_autohop").height();
	$("#content_tab_ruta").height(height - 40);
	$("#traseu").height(height - 40 - dif_ctr_t);
};

function calculateViteza(metri, secunde) {
	return Math.round(metri * 3600 / secunde / pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][4]) + ' ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][3];
};

function calculateCost(metri) {
	var tip_combistibil;
	$.each(pageVars['auto']['orase'][0]['rute']['optiuni']['ui'][1], function(key, array) {
		if (pageVars['auto']['orase'][0]['rute']['optiuni']['ui'][1][key][0] == true) {
			tip_combistibil = key;
		};
	});
	return Math.round(metri / 1000 / 100 * pageVars['generale']['litri_la_suta'] * pageVars['generale']['preturi_combustibil'][tip_combistibil]);
};

function calculateConsumTotal(metri) {
	return returnNumberWithDecimals(Math.round(metri * pageVars['generale']['litri_la_suta'] / 10 / 1000 / pageVars['generale']['unitati_masura_volum'][pageVars['generale']['default_um']][2]) / 10) + ' ' + pageVars['generale']['unitati_masura_volum'][pageVars['generale']['default_um']][1];
};

function clickBlaBlaCar(obj) {
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'clickuri_bannere',
			'pentru': 'blablacar',
			'url_from': location.href,
			'url_to': $(obj).attr("href")
		},
		success: function(d) {}
	});
};

function clickBlaBlaCar2(obj) {
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'clickuri_bannere',
			'pentru': 'blablacar2',
			'url_from': location.href,
			'url_to': $(obj).attr("href")
		},
		success: function(d) {}
	});
};

function clickBannerMapBla(obj) {
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'clickuri_bannere',
			'pentru': 'blablamap',
			'url_from': location.href,
			'url_to': $(obj).attr("href")
		},
		success: function(d) {}
	});
};

function clickBlaBlaCarTop(obj) {
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'clickuri_bannere',
			'pentru': 'blablacartop',
			'url_from': location.href,
			'url_to': $(obj).attr("href")
		},
		success: function(d) {}
	});
};

function hideMarker() {
	pageVars['generale']['marker'].remove();
};

function hideMarkerPoint() {
	pageVars['generale']['markerPoint'].remove();
};

function hidePolyInside() {
	pageVars['generale']['lineInside'].remove();
};

function getOraTipZi() {
	var d = new Date();
	var ora = d.getHours();
	var ziua = d.getDay();
	if (ziua >= 1 && ziua < 6) {
		ziua = 1;
	} else if (ziua == 6) {
		ziua = 2;
	} else if (ziua == 0) {
		ziua = 3;
	};
	return [ora, ziua];
};

function calculateBoundsFromCoords(coords) {
	var minLat = null;
	var minLng = null;
	var maxLat = null;
	var maxLng = null;
	$.each(coords, function(key, coord) {
		if (minLat == null || minLat > coord[0]) {
			minLat = coord[0];
		};
		if (minLng == null || minLng > coord[1]) {
			minLng = coord[1];
		};
		if (maxLat == null || maxLat < coord[0]) {
			maxLat = coord[0];
		};
		if (maxLng == null || maxLng < coord[1]) {
			maxLng = coord[1];
		};
	});
	return [
		[minLat, minLng],
		[maxLat, maxLng]
	];
};

function nextColor() {
	var i = 0;
	var culoare;
	var zz = 0;
	$.each(pageVars[tipRuta]['orase'][idOrasSelected]['culori'], function(key, value) {
		if (i == 0 || zz == 1) {
			culoare = key;
			zz = 0;
		};
		if (key == pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']) {
			zz = 1;
		};
		i++;
	});
	return culoare;
};

function prevColor() {
	var i = null;
	var culoare;
	$.each(pageVars[tipRuta]['orase'][idOrasSelected]['culori'], function(key, value) {
		if (key == pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']) {
			if (i != null) {
				return false;
			};
		};
		culoare = key;
		i = 1;
	});
	return culoare;
};

function mouseOverTabRetur(obj) {
	$(obj).attr("class", "ruta_alternativa_selected");
};

function mouseOutTabRetur(obj) {
	$(obj).attr("class", "ruta_alternativa");
};

function returnCeasFromSec(sec) {
	var minute = Math.floor(sec / 60);
	var ora = Math.floor(minute / 60);
	var minut = minute - ora * 60;
	ceas = ((ora < 10) ? '0' + ora : ora) + ':' + ((minut < 10) ? '0' + minut : minut);
	return ceas;
};

function setOra(objOra) {
	$("#td_plecati_la > div").hide();
	$("#td_ajungeti_la > div").hide();
	$("#tab_orar").hide();
	if (objOra) {
		$("#td_plecati_la > div > span").html(returnCeasFromSec(objOra[0]));
		$("#td_ajungeti_la > div > span").html(returnCeasFromSec(objOra[objOra.length - 1]));
		$("#td_plecati_la > div").show();
		$("#td_ajungeti_la > div").show();
		$("#tab_orar").show();
	};
};

function mouseOverCotRutaAutobuz(obj) {
	$(obj).attr("class", "cot_over");
};

function mouseOutCotRutaAutobuz(obj) {
	$(obj).attr("class", "cot");
};

function getFreeInput() {
	refreshVarsPageVars();
	indexObject = -1;
	pv = pageVars["autobuz"]['orase'][idOrasSelected][moduriCautare];
	for (i = 0; i < pv['varsInputs'].length; i++) {
		if (pv['varsInputs'][i] == '') {
			ready = 0;
			indexObject = i;
			break;
		};
	};
	return indexObject;
};

function getStatusInputs(e) {
	refreshVarsPageVars();
	ready = 1;
	url = [];
	ajax = [];
	pv = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare];
	for (i = 0; i < pv['varsInputs'].length; i++) {
		if (pv['varsInputs'][i] == '') {
			ready = 0;
			indexObject = i;
			break;
		};
		if (pv['urlsVarsInputs'][i] != '') {
			if (pageVars['generale']['tip_ruta'] == "autobuz") {
				if (moduriCautare == "linii") {
					url[i] = pv['urlsVarsInputs'][i];
				} else {
					if (pv['idsVarsInputs'][i] > 0) {
						url[i] = pv['urlsVarsInputs'][i] + '_' + pv['idsVarsInputs'][i];
					} else {
						if (pv['coordVarsInputs'][i][0] != 0 && pv['coordVarsInputs'][i][1] != 0) {
							url[i] = pv['coordVarsInputs'][i][0] + ',' + pv['coordVarsInputs'][i][1];
						} else {
							ready = 0;
							indexObject = i;
							break;
						};
					};
				};
			} else {
				url[i] = pv['urlsVarsInputs'][i];
			};
		} else {
			if (pv['coordVarsInputs'][i][0] != 0 && pv['coordVarsInputs'][i][1] != 0) {
				url[i] = pv['coordVarsInputs'][i][0] + ',' + pv['coordVarsInputs'][i][1];
			} else {
				ready = 0;
				indexObject = i;
				break;
			};
		};
		if (pageVars['generale']['tip_ruta'] == "autobuz") {
			if (moduriCautare == "linii") {
				if (pv['urlsVarsInputs'][i] != '') {
					ajax[i] = pv['urlsVarsInputs'][i];
				} else {
					ready = 0;
					indexObject = i;
					break;
				};
			} else {
				if (pv['idsVarsInputs'][i] == 0) {
					if (pv['coordVarsInputs'][i][0] != 0 && pv['coordVarsInputs'][i][1] != 0) {
						ajax[i] = pv['coordVarsInputs'][i];
					} else {
						ready = 0;
						indexObject = i;
						break;
					};
				} else if (pv['idsVarsInputs'][i] > 0) {
					ajax[i] = pv['idsVarsInputs'][i];
				} else {
					ready = 0;
					indexObject = i;
					break;
				};
			};
		} else {
			if (pv['coordVarsInputs'][i][0] != 0 && pv['coordVarsInputs'][i][1] != 0) {
				ajax[i] = pv['coordVarsInputs'][i];
			} else {
				ready = 0;
				indexObject = i;
				break;
			};
		};
	};
	if (ready == 1) {
		return {
			'url': url,
			'ajax': ajax,
			'ready': ready
		};
	} else {
		return {
			'indexObject': indexObject,
			'ready': ready
		};
	};
};

function setHashDefault(e) {
	if (history.pushState) {
		refreshVarsPageVars();
		if (window.top.location.pathname != '/' + ((idOrasSelected > 0) ? pageVars[tipRuta]['orase'][idOrasSelected]['url'] + '/' : "") + pageVars[tipRuta]['orase'][idOrasSelected]['url_sectiune'] + '/') {
			setHash(((idOrasSelected > 0) ? pageVars[tipRuta]['orase'][idOrasSelected]['url'] + '/' : "") + pageVars[tipRuta]['orase'][idOrasSelected]['url_sectiune'] + '/', e);
		};
	} else {
		if (page != 'index') {
			return;
		};
		refreshVarsPageVars();
		if (window.top.location.hash != '#!' + ((idOrasSelected > 0) ? pageVars[tipRuta]['orase'][idOrasSelected]['url'] + '/' : "") + pageVars[tipRuta]['orase'][idOrasSelected]['url_sectiune'] + '/') {
			setHash(((idOrasSelected > 0) ? pageVars[tipRuta]['orase'][idOrasSelected]['url'] + '/' : "") + pageVars[tipRuta]['orase'][idOrasSelected]['url_sectiune'] + '/', e);
		};
	};
};

function updateInputFromMap() {};

function deg2rad(angle) {
	return (angle / 180) * Math.PI;
};

function calculateDistanceFromLatLong(point1, point2) {
	earthMeanRadius = 6371009;
	deltaLatitude = deg2rad(point2[0] - point1[0]);
	deltaLongitude = deg2rad(point2[1] - point1[1]);
	a = Math.sin(deltaLatitude / 2) * Math.sin(deltaLatitude / 2) + Math.cos(deg2rad(point1[0])) * Math.cos(deg2rad(point2[0])) * Math.sin(deltaLongitude / 2) * Math.sin(deltaLongitude / 2);
	c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
	distance = earthMeanRadius * c;
	return distance;
};

function resolveImgsLeftInputs() {
	refreshVarsPageVars();
	_inputs = $("#table_cautare > tbody:first > tr > td:nth-child(2) > div > input");
	$.each(_inputs, function(key, value) {
		$(_inputs[key]).css({
			'color': ''
		});
		img = $(value).parent().parent().prev().children().first();
		img.attr("title", "");
		if (_inputs.length == 1) {
			img.attr("src", pathToImg + "litere/" + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['nume'].substring(0, 1).toLowerCase() + ".png");
		} else {
			if (pageVars['generale']['select_on_map_active'] == key) {
				$(img).attr("src", pathToImg + "mylocation-icon-selected.png");
				$(img).attr("title", pageVars['texte']['click_pe_harta']);
			} else {
				$(img).attr("src", pathToImg + "litere/" + pageVars['generale']['litere'][key].toLowerCase() + ".png");
			};
		};
	});
};

function emptyVarsRuta(objFor) {
	refreshVarsPageVars();
	indexObjFor = $.inArray(objFor, $(".input-ruta"));
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObjFor] = $(objFor).val();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][indexObjFor] = 0;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][indexObjFor] = [0, 0];
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexObjFor] = $(objFor).val();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][indexObjFor] = '';
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['markersVarsInputs'][indexObjFor] = '';
};

function prelucreazaSugestii(obj, val, data) {
	refreshVarsPageVars();
	$("#div-suggest").remove();
	nrBox = $.inArray(obj, $(".input-ruta"));
	if ($(obj).val() == val && nrBox > -1) {
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['selectable'] == 0) {
			if ($(obj).val() == '') {
				return;
			};
			sugestiiVal = pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val];
			if (sugestiiVal && sugestiiVal.length > 0) {
				$(obj).val(sugestiiVal[0][1]);
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][nrBox] = sugestiiVal[0][1];
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][nrBox] = sugestiiVal[0][0];
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][nrBox] = sugestiiVal[0][3];
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][nrBox] = sugestiiVal[0][1];
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][nrBox] = sugestiiVal[0][2];
				pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][sugestiiVal[0][1]] = sugestiiVal;
			};
		} else {
			$("#main").append(createDivMainSuggest());
			pos = $(obj).offset();
			if (pos) {
				if (isMobile) {
					$("#div-suggest").css({"top":pos.top + $(obj).parent().outerHeight() - 2,"left":pos.left});
				} else {
					$("#div-suggest").css("top", pos.top + $(obj).parent().outerHeight());
				};
			};
			$.each(data, function(key, sugestie) {
				if (sugestie && sugestie[2] && sugestie[1] && sugestie[0] && val) {
					$("#div-suggest").append(createSuggest(nrBox, key, sugestie[2], sugestie[1], sugestie[0], val));
				};
			});
		};
	};
	hideMapLocatie();
};

function makeURL(text) {
	if (!text) {
		return "";
	};
	text = text.replace(/[ \\-]+/g, '-');
	t = '';
	for (i = 0; i < text.length; i++) {
		if (pageVars['generale']['diacritice'][text.charCodeAt(i)]) {
			t += pageVars['generale']['diacritice'][text.charCodeAt(i)];
		} else {
			t += text.charAt(i);
		};
	};
	text = t.toLowerCase().replace(/[^0-9A-Za-z-]/gi, '').replace(/-+/g, ' ').replace(/[ ]/g, '-');
	return text;
};

function evidentiazaInput(text, val) {
	textURL = makeURL(text);
	from = textURL.indexOf(makeURL(val));
	to = from + val.length;
	newText1 = text.substring(0, from);
	newText2 = text.substring(from, to);
	newText3 = text.substring(to);
	return newText1 + '<span>' + newText2 + '</span>' + newText3;
};

function putPageVars() {};

function adaugaSelectSuggest(obj) {
	$(obj).siblings("span").css('margin-right', '22px');
	$(obj).parent().append(createSelectSuggest($.inArray(obj, $("#table_cautare > tbody:first .input-ruta"))));
};

function eliminaSelectSuggest(obj) {
	$(obj).siblings("span").css('margin-right', '0px');
	$(obj).siblings("img").remove();
};

function checkSelectOras() {
	if (pageVars['generale']['tip_ruta'] == "autobuz") {
		if ($("#table_cautare > tbody:first > tr:last td").length == 3) {
			hideAddDestinatie();
			$("#table_cautare > tbody:first > tr:last td:first").remove();
			$("#table_cautare > tbody:first > tr:last td:first").attr("colspan", 2);
			$("#table_cautare > tbody:first > tr:last td:first").append(createSelectOras());
		};
		$("#switch-localitati > img").attr("title", pageVars['texte']['inverseaza_statiile']);
	} else {
		if ($("#table_cautare > tbody:first > tr:last td").length < 3) {
			$("#select-oras-cautare").remove();
			$("#table_cautare > tbody:first > tr:last td:first").attr("colspan", 1);
			$("#table_cautare > tbody:first > tr:last td:first").before(createEl("td"));
			showAddDestinatie();
		};
		$("#switch-localitati > img").attr("title", pageVars['texte']['inverseaza_localitatile']);
	};
};

function getFrame(id) {
	frame = $("#" + id).get(0).contentWindow;
	return frame;
};

function checkNrOptiuniTipRuta() {
	refreshVarsPageVars();
	if ($("#div_" + tipRuta + "_" + moduriCautare + " > div:first input").length > $("#div_" + tipRuta + "_" + moduriCautare + " > div:last input").length) {
		$("#div_unitati_masura_distante").css("margin-top", "-20px");
	} else {
		$("#div_unitati_masura_distante").css("margin-top", "0px");
	};
};

function resolveInputsSelect() {
	checkSelectOras();
	checkNrOptiuniTipRuta();
};

function showInfoAlert(content, delay) {
	$('.div_alert').html(content);
	showAlert((delay) ? delay : null);
};

function inchideAlert() {
	$('.div_alert').hide(100);
	if ($(".div_alert").hasClass("cookie")) {
		$(".div_alert").removeClass("cookie");
		$.cookie('cookie_accepted', 1, {
			expires: 365,
			path: '/'
		});
	};
};

function prepareBeforeObiectiv() {};

function defaultValInputs(obj, val) {
	if ($(obj).val() == '') {
		$(obj).parent().children('span').html(val);
		$(obj).parent().children('span').fadeIn(500);
	} else {
		$(obj).parent().children('span').fadeOut(500);
		$(obj).parent().children('span').html('');
	};
};

function resolveInputsVals() {
	refreshVarsPageVars();
	_inputs = $("#table_cautare > tbody:first > tr > td:nth-child(2) > div > input");
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'] = [];
	$.each(_inputs, function(key, value) {
		if (key == 0) {
			if ($(value).val() == '' || $(value).val() == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']] || $(value).val() == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']]) {
				$(value).val('');
				defaultValInputs($(value), pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']]);
			};
			$(value).attr("onclick", "clickInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']] + "');");
			$(value).attr("onfocus", "focusInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']] + "');");
			$(value).attr("onblur", "blurInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']] + "');");
			$(value).attr("onkeyup", "keyUpInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']] + "',event);");
		};
		if (key > 0 && key < _inputs.length - 1) {
			if ($(value).val() == '' || $(value).val() == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']] || $(value).val() == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']]) {
				$(value).val('');
				defaultValInputs($(value), pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']]);
			};
			$(value).attr("onclick", "clickInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']] + "');");
			$(value).attr("onfocus", "focusInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']] + "');");
			$(value).attr("onblur", "blurInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']] + "');");
			$(value).attr("onkeyup", "keyUpInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']] + "',event);");
		};
		if (key == _inputs.length - 1) {
			if ($(value).val() == '' || $(value).val() == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']] || $(value).val() == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']]) {
				$(value).val('');
				defaultValInputs($(value), pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']]);
			};
			$(value).attr("onclick", "clickInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']] + "');");
			$(value).attr("onfocus", "focusInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']] + "');");
			$(value).attr("onblur", "blurInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']] + "');");
			$(value).attr("onkeyup", "keyUpInputRuta(this,'" + pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']] + "',event);");
		};
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key] = $(value).val();
	});
};

function popState(obj) {
	if (obj !== null) {};
};

function resolveSwitchRemove() {
	refreshVarsPageVars();
	nrInputs = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length;
	$("#table_cautare > tbody:first > tr:nth-child(2) td:nth-child(3)").width(12);
	if (nrInputs == 2) {
		$("#table_cautare > tbody:first > tr:nth-child(2) td:nth-child(3)").append(createSwitchLocalitati());
	} else if (nrInputs > 2) {
		$(inputs).parent().parent().next().append(createEl("img", {
			'src': pathToImg + 'inchide.png',
			'class': 'inchide',
			'onclick': 'stergeDestinatia(this);',
			'title': pageVars['texte']['sterge_destinatia'],
			'alt': pageVars['texte']['sterge_destinatia']
		}));
	} else if (nrInputs == 1) {};
};

function adjustShaddowAvansat() {
	$("#cautare_ruta_inner div.bg-content-tab").remove();
	$("#div_avansat div.bg-content-tab").remove();
	if ($("#cautare_ruta_inner").height() < $("#div_avansat").height()) {
		$("#div_avansat").append(createEl("div", {
			'class': 'bg-content-tab',
			'style': 'left: 0px;'
		}));
	} else {
		$("#cautare_ruta_inner").append(createEl("div", {
			'class': 'bg-content-tab'
		}));
	};
	$("#div_avansat").append(createEl("div", {
		'class': 'bg-content-tab',
		'style': 'right: -4px;'
	}));
};

function mouseoverTabOptiune(tab) {};

function mouseoutTabOptiune(tab) {};

function clickVeziDirectii(obj, e) {
	refreshVarsPageVars();
	$.cookie('tip_traseu', tipRuta, {
		expires: 30,
		path: '/'
	});
	$.cookie('id_oras_selected', idOrasSelected, {
		expires: 30,
		path: '/'
	});
	data = getStatusInputs(e);
	if (data == false || (data && data['ready'] == 0)) {
		if (data['indexObject'] >= 0) {
			$(".input-ruta:eq(" + data['indexObject'] + ")").trigger("focus");
			if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['select_on_map'] != 0) {
				if (pageVars['generale']['select_on_map_active'] == -1) {
					img = $(".input-ruta:eq(" + data['indexObject'] + ")").parent().parent().prev().children().first();
					img.attr("src", pathToImg + "mylocation-icon.png");
					img.attr("title", pageVars['texte']['selectati_locatia_click_harta']);
				};
			};
			setHashDefault(e);
		};
	} else if (data && data['ready'] == 1) {
		if (tipRuta != 'linie-dreapta') {
			$("#buton_vezi_directii").attr("value", ".........");
			$("#buton_vezi_directii").attr("disabled", true);
			$(".input-ruta").attr("disabled", true);
			pageVars['generale']['taxi'] = {
				"path": [],
				"durata": 0,
				"distanta": 0,
				"obj": getFrame('iframe_harta').getPolylineTaxi()
			};
		};
		switch (tipRuta) {
			case "auto":
				getRutaServer(data, 'auto', e);
				break;
			case "pe-jos":
				getRutaServer(data, 'pe-jos', e);
				break;
			case "bicicleta":
				getRutaServer(data, 'bicicleta', e);
				break;
			case "autobuz":
				switch (moduriCautare) {
					case "rute":
						getRutaAutobuz(data, e);
						break;
					case "linii":
						getLinie(data, e);
						break;
					case "statii":
						getStatie(data, e);
						break;
				};
				break;
			case "linie-dreapta":
				getDistanta(data, e);
				break;
		};
	};
	pageVars['generale']['select_on_map_active'] = -1;
};

function stabilesteTaburi() {
	pageVars['generale']['tabs'] = [];
	switch (divTop) {
		case 'index':
			pageVars['generale']['tabs'] = ['ruta'];
			break;
		case 'oras':
			pageVars['generale']['tabs'] = ['ruta', 'strada_obiectiv'];
			break;
		case 'oras-oras':
			if (pageVars['generale']['tip_ruta'] == 'auto') {
				pageVars['generale']['tabs'] = ['ruta'];
			} else if (pageVars['generale']['tip_ruta'] == 'autobuz') {
				if (moduriCautare == 'linii') {
					pageVars['generale']['tabs'] = ['linie', 'orar'];
				};
				if (moduriCautare == 'statii') {
					pageVars['generale']['tabs'] = ['statie', 'orar'];
				};
				if (moduriCautare == 'rute') {
					pageVars['generale']['tabs'] = ['ruta'];
				};
			} else if (pageVars['generale']['tip_ruta'] == 'linie-dreapta') {
				pageVars['generale']['tabs'] = ['ruta'];
			} else {
				pageVars['generale']['tabs'] = ['ruta'];
			};
			break;
		default:
			pageVars['generale']['tabs'] = ['ruta'];
	};
	if (pageVars['generale']['oras']['nume'] && divTop != 'oras') {
		pageVars['generale']['tabs'].push('strada_obiectiv');
	};
	if (divTop == 'oras') {};
	return pageVars['generale']['tabs'];
};

function setScrollRezultate() {
	$(function() {
		$('img').load(function() {
			$("#traseu > div.content_traseu:eq(0)").scrolltastic({
				up: $("#div_plecare"),
				down: $("#div_sosire")
			});
		});
	});
};

function setScrollRezultateNoImg() {
	$("#traseu > div.content_traseu:eq(0)").css("min-height", $("#traseu").height());
	$(function() {
		$("#traseu > div.content_traseu:eq(0)").scrolltastic({
			up: $("#div_plecare"),
			down: $("#div_sosire")
		});
	});
};

function removeTypeOfDivsInfo(id) {
	pvh = [];
	$.each(pageVars['generale']['id_div_for_hidden'], function(key, div) {
		if (div[0] == id) {
			if (div[1] == "remove") {
				$("#" + div[0]).remove();
			} else if (div[1] == "hide") {
				$("#" + div[0]).hide();
			};
		} else {
			if ($.inArray(div, pvh) == -1) {
				pvh.push(div);
			};
		};
	});
	pageVars['generale']['id_div_for_hidden'] = pvh;
};

function removeDivsInfo() {
	$.each(pageVars['generale']['id_div_for_hidden'], function(key, div) {
		if (div[1] == "remove") {
			$("#" + div[0]).remove();
		} else if (div[1] == "hide") {
			$("#" + div[0]).hide();
		};
	});
	pageVars['generale']['id_div_for_hidden'] = [];
};

function ascundeDivs(e) {
	refreshVarsPageVars();
	setHashHandi();
	$("#div-suggest").remove();
	if (pageVars['generale']['focusSuggest'] === false || !pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][$(pageVars['generale']['focusSuggest']).val()]) {
		resolveSelectArrowInputs();
	} else {
		$(pageVars['generale']['focusSuggest']).trigger("focus");
		pageVars['generale']['focusSuggest'] = false;
	};
	if (pageVars['generale']['id_div_for_hidden'].length == 0) {
		return;
	};
	pvh = [];
	$.each(pageVars['generale']['id_div_for_hidden'], function(key, div) {
		if (div[2] == true) {
			pageVars['generale']['id_div_for_hidden'][key][2] = false;
			if ($.inArray(pageVars['generale']['id_div_for_hidden'][key], pvh) == -1) {
				pvh.push(pageVars['generale']['id_div_for_hidden'][key]);
			};
		} else {
			if ($("#" + div[0]).is(":visible")) {
				offset = $("#" + div[0]).offset();
				if (e.pageX || e.pageY) {
					posx = e.pageX;
					posy = e.pageY;
				} else if (e.clientX || e.clientY) {
					posx = e.clientX + document.body.scrollLeft + document.documentElement.scrollLeft;
					posy = e.clientY + document.body.scrollTop + document.documentElement.scrollTop;
				};
				if (posy && posx && posy < offset.top || posy > offset.top + $("#" + div[0]).outerHeight() || posx < offset.left || posx > offset.left + $("#" + div[0]).outerWidth()) {
					if (div[1] == "remove") {
						$("#" + div[0]).remove();
					} else if (div[1] == "hide") {
						$("#" + div[0]).hide();
					};
				} else {
					if ($.inArray(pageVars['generale']['id_div_for_hidden'][key], pvh) == -1) {
						pvh.push(pageVars['generale']['id_div_for_hidden'][key]);
					};
				};
			};
		};
	});
	pageVars['generale']['id_div_for_hidden'] = pvh;
};

function clickBottomLink(obj) {
	el = obj.id.substring(12);
	if ($("#bottom-" + el).is(":visible")) {
		return;
	};
	removeDivsInfo();
	$("#bottom-" + el).show();
	if (el == 'contact') {
		focusFormularContact();
	};
	if ($.inArray(['bottom-' + el, 'hide', true], pageVars['generale']['id_div_for_hidden']) == -1) {
		pageVars['generale']['id_div_for_hidden'].push(['bottom-' + el, 'hide', true]);
	};
};

function closeDivBottom(obj) {
	obj.style.display = 'none';
};

function clickSaveConfiguratie() {};

function showTools() {};

function printConfiguratie() {};

function shareConfiguratie() {};

function clickTab(obj, x) {
	if ($("#taburi>ul>li").length <= 1) {
		return;
	};
	var rel = $(obj).attr("rel");
	if (($("#" + rel).length > 0 && rel != 'content_tab_strada_obiectiv') || ($("#a_content_tab_ruta").length > 0 && rel != 'content_tab_strada_obiectiv')) {
		if ($("#" + rel).is(":visible")) {
			$("#" + rel).hide();
			if (rel == 'content_tab_ruta') {
				$("#content_tab_detalii_autohop").hide();
				$("#content_tab_detalii_consum").hide();
				$("#content_tab_detalii_ruta").hide();
			};
			if (rel == 'content_tab_linie') {
				$("#content_tab_detalii_linie").hide();
			};
			if (rel == 'content_tab_statie') {
				$("#content_tab_detalii_statie").hide();
			};
			$(obj).attr("class", "");
			/* $("#" + idUnit).hide(); */
		} else {
			$.each($("#taburi a"), function(key, a) {
				$("#" + $(a).attr("rel")).hide();
				$(a).attr("class", "");
			});
			$("#content_tab_detalii_consum").hide();
			$("#content_tab_detalii_autohop").hide();
			$("#content_tab_detalii_linie").hide();
			$("#content_tab_detalii_statie").hide();
			$("#content_tab_detalii_ruta").hide();
			$("#" + rel).show();
			if (rel == 'content_tab_ruta') {
				$("#content_tab_detalii_consum").show();
				//$("#content_tab_detalii_autohop").show();
				$("#content_tab_detalii_ruta").show();
				if (pageVars['generale']['oras']['nume'] != '') {
					$("#content_tab_strada_obiectiv").hide();
					$("#cautare_ruta_inner").show();
					$(obj).attr("class", "current");
				};
			};
			if (rel == 'content_tab_linie') {
				$("#content_tab_detalii_linie").show();
			};
			if (rel == 'content_tab_statie') {
				$("#content_tab_detalii_statie").show();
			};
			$(obj).attr("class", "current");
			/* $("#" + idUnit).show(); */
		};
	};
	if (rel == 'content_tab_strada_obiectiv') {
		$.each($("#taburi a"), function(key, a) {
			$("#" + $(a).attr("rel")).hide();
			$(a).attr("class", "");
		});
		if ($("#div_avansat").length > 0) {
			clickOptiuni();
		};
		$("#cautare_ruta_inner").hide();
		$("#content_tab_detalii_consum").hide();
		$("#content_tab_detalii_autohop").hide();
		$("#content_tab_detalii_ruta").hide();
		$("#content_tab_detalii_linie").hide();
		$("#content_tab_detalii_statie").hide();
		$("#content_tab_strada_obiectiv").show();
		$(obj).attr("class", "current");
		/* $("#" + idUnit).show(); */
	};
	if (tipRuta == 'autobuz' && moduriCautare == 'linii') {
		$("#traseu").html($("#traseu").html());
		setScrollRezultateNoImg();
	};
};

function setTabSelected(index) {
	$("#taburi a").eq(index).attr("class", "current");
};

function clickZoomIn() {
	getFrame('iframe_harta').map.setZoom(getFrame('iframe_harta').map.getZoom() + 1);
	var rutaTrasata = 'NU';
	if (pageVars[tipRuta]['google'] && pageVars['generale']['directionsDisplay'][tipRuta] && pageVars['generale']['directionsDisplay'][tipRuta].polylineOptions) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'autobuz' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
};

function clickZoomOut() {
	getFrame('iframe_harta').map.setZoom(getFrame('iframe_harta').map.getZoom() - 1);
	var rutaTrasata = 'NU';
	if (pageVars[tipRuta]['google'] && pageVars['generale']['directionsDisplay'][tipRuta] && pageVars['generale']['directionsDisplay'][tipRuta].polylineOptions) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'autobuz' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
};

function updateBlaBlaCar(distanta) {
	//var from=data['url'][0];
	var from = encodeURIComponent(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][0]);
	//var to=data['url'][data['url'].length-1];
	var to = encodeURIComponent(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1]);
	var waypoints = new Array();
	
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length > 2) {
		for (var i = 1; i < pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1; i++) {
			waypoints.push(encodeURIComponent(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][i]));
		};
	};
	$("#pret_blablacar,#pret_blablacar2").html(Math.ceil((distanta / 1000 * 0.14 * 2.3) / 5) * 5 + " Lei");
	//$("#link_blablacar").attr({href:"https://www.autohop.ro/?utm_source=partner&utm_medium=Distanta&utm_campaign=From:"+from+"-To:"+to+((waypoints.length>0)?"-Waypoints:"+waypoints.join("|"):"")});
	//$("#link_blablacar").attr({href:"https://www.blablacar.ro/ofera-locuri-noi?p=distanta&hide_map=1&from="+from+"&to="+to+"&waypoints="+((waypoints.length>0)?waypoints.join("|"):"")+"&comuto_cmkt=RO_DISTANTA_DRVR_FUNN&utm_source=DISTANTA&utm_medium=banner&utm_campaign=RO_DISTANTA_DRVR_FUNN"});
	$("#link_blablacar").attr({
		//href: "https://www.blablacar.ro/lp/rodistanta?redirect_to=blablacar_trip_funnelPublication_funnel&p=distanta&hide_map=1&from=" + from + "&to=" + to + "&waypoints=" + ((waypoints.length > 0) ? waypoints.join("|") : "") + "&comuto_cmkt=RO_DISTANTA_DRVR_NEWFUNN&utm_source=DISTANTA&utm_medium=banner&utm_campaign=RO_DISTANTA_DRVR_NEWFUNN"
		//href: "https://www.blablacar.ro/ofera-locuri-noi?p=distanta&hide_map=1&from=" + from + "&to=" + to + "&waypoints=" + ((waypoints.length > 0) ? waypoints.join("|") : "") + "&comuto_cmkt=RO_DISTANTA_DRVR_FUNN&utm_source=DISTANTA&utm_medium=banner&utm_campaign=RO_DISTANTA_DRVR_FUNN"
		href: "https://www.blablacar.ro/lp/rodistanta?redirect_to=blablacar_trip_publication_step1&p=distanta&hide_map=1&from=" + from + "&to=" + to + "&waypoints=" + ((waypoints.length > 0) ? waypoints.join("|") : "") + "&comuto_cmkt=RO_DISTANTA_DRVR_NEWFUNN&utm_source=DISTANTA&utm_medium=banner&utm_campaign=RO_DISTANTA_DRVR_NEWFUNN"
	});
	//$("#link_blablacar2").attr({href:"https://www.blablacar.ro/ofera-locuri-noi?p=distanta&hide_map=1&from="+from+"&to="+to+"&waypoints="+((waypoints.length>0)?waypoints.join("|"):"")+"&comuto_cmkt=RO_DISTANTA_DRVR_FUNN2&utm_source=DISTANTA&utm_medium=banner&utm_campaign=RO_DISTANTA_DRVR_FUNN2"});
	$("#share_blablacar").attr({
		//href: "https://www.blablacar.ro/lp/rodistanta?redirect_to=blablacar_trip_funnelPublication_funnel&p=distanta&hide_map=1&from=" + from + "&to=" + to + "&waypoints=" + ((waypoints.length > 0) ? waypoints.join("|") : "") + "&comuto_cmkt=RO_DISTANTA_DRVR_TOPHEADER2&utm_source=DISTANTA&utm_medium=banner&utm_campaign=RO_DISTANTA_DRVR_TOPHEADER2"
		//href: "https://www.blablacar.ro/ofera-locuri-noi?p=distanta&hide_map=1&from=" + from + "&to=" + to + "&waypoints=" + ((waypoints.length > 0) ? waypoints.join("|") : "") + "&comuto_cmkt=RO_DISTANTA_DRVR_TOPHEADER2FUNN&utm_source=DISTANTA&utm_medium=banner&utm_campaign=RO_DISTANTA_DRVR_TOPHEADER2FUNN"
		href: "https://www.blablacar.ro/lp/rodistanta?redirect_to=blablacar_trip_publication_step1&p=distanta&hide_map=1&from=" + from + "&to=" + to + "&waypoints=" + ((waypoints.length > 0) ? waypoints.join("|") : "") + "&comuto_cmkt=RO_DISTANTA_DRVR_TOPHEADER2&utm_source=DISTANTA&utm_medium=banner&utm_campaign=RO_DISTANTA_DRVR_TOPHEADER2"
	});
	$("#top #share").css({
		right: calculateShareMaxWidth()
	});
};

function clickInfoWindowDeLa(content) {
	clickTab($("#a_content_tab_ruta"), 0);
	var first = $("input.input-ruta").first();
	var last = $("input.input-ruta").last();
	var val1 = first.val();
	var val2 = last.val();
	first.val(content);
	if (val2 == content) {
		last.val('');
	};
	if (val1 != '' && val1 != content) {
		last.val(val1);
	};
	defaultValInputs(first, pageVars['texte']['de_la']);
	defaultValInputs(last, pageVars['texte']['pana_la']);
};

function clickInfoWindowPanaLa(content) {
	clickTab($("#a_content_tab_ruta"), 0);
	var first = $("input.input-ruta").first();
	var last = $("input.input-ruta").last();
	var val1 = first.val();
	var val2 = last.val();
	last.val(content);
	if (val1 == content) {
		first.val('');
	};
	if (val2 != '' && val2 != content) {
		first.val(val2);
	};
	defaultValInputs(first, pageVars['texte']['de_la']);
	defaultValInputs(last, pageVars['texte']['pana_la']);
};

function removeInputValsIfId(tip, tipCautare, optiune) {
	var idTipMijloc = 0;
	if (pageVars[tip]['orase'][idOrasSelected][tipCautare]['optiuni']['ui'][0][optiune]) {
		idTipMijloc = pageVars[tip]['orase'][idOrasSelected][tipCautare]['optiuni']['ui'][0][optiune][4];
	} else if (pageVars[tip]['orase'][idOrasSelected][tipCautare]['optiuni']['ui'][1][optiune]) {
		idTipMijloc = pageVars[tip]['orase'][idOrasSelected][tipCautare]['optiuni']['ui'][1][optiune][4];
	};
	if (parseInt(idTipMijloc) > 0) {
		$.each($(".input-ruta"), function(key, obj) {
			$(obj).val("");
			pageVars[tip]['orase'][idOrasSelected][tipCautare]['varsInputs'][key] = '';
			pageVars[tip]['orase'][idOrasSelected][tipCautare]['idsVarsInputs'][key] = 0;
			pageVars[tip]['orase'][idOrasSelected][tipCautare]['coordVarsInputs'][key] = [0, 0];
			pageVars[tip]['orase'][idOrasSelected][tipCautare]['textCoordVarsInputs'][key] = '';
			pageVars[tip]['orase'][idOrasSelected][tipCautare]['urlsVarsInputs'][key] = '';
			pageVars[tip]['orase'][idOrasSelected][tipCautare]['markersVarsInputs'][key] = '';
			if (key == 0) {
				textDef = pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']];
			} else if (key == $(".input-ruta").size() - 1) {
				textDef = pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']];
			} else {
				textDef = pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']];
			};
			defaultValInputs(obj, textDef);
		});
	};
};

function setHash(hash, e) {
	if (history.pushState) {
		var stateObj = {};
		history.replaceState(stateObj, null, ((hash.indexOf('/') == 0) ? "" : "/") + hash);
	} else {
		if (page != 'index') {
			return;
		};
		if ($.inArray(browser, ['Chrome', 'Firefox']) > -1 || e) {
			window.top.location.hash = '#!' + hash;
		} else {
			pageVars['generale']['hash'] = hash;
		};
	};
};

function modificaConsumAutoOptiuni(plusMinus) {
	if (plusMinus == 'plus') {
		pageVars['generale']['litri_la_suta'] += 0.5;
	} else {
		pageVars['generale']['litri_la_suta'] -= 0.5;
	};
	$.cookie('consum', pageVars['generale']['litri_la_suta'], {
		expires: 30,
		path: '/'
	});
	$("#consum_selector_optiuni").html(returnNumberWithDecimals(calculateVolumCarburant(), 1) + ' ' + pageVars['generale']['unitati_masura_volum'][pageVars['generale']['default_um']][1] + '/100 ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1]);
};

function returnNumberWithDecimals(numberFloat, no) {
	numberFloat = numberFloat.toString();
	if (numberFloat.indexOf('.') == -1) {
		numberFloat = numberFloat + '.0';
	};
	numberFloat = numberFloat.replace('.', ',');
	if (!no) {
		numberFloat = numberFloat.replace(',0', '');
	};
	return numberFloat;
};

function showAddDestinatie() {
	hideAddDestinatie();
	$("#table_cautare > tbody:first > tr:last td:first").append(createButonAddDestinatie());
	$("#table_cautare > tbody:first > tr:last td:first").next().append(createTextAddDestinatie());
};

function hideAddDestinatie() {
	$("#buton_adauga_destinatie").remove();
	$("#adauga_destinatie").remove();
};

function getOptimBannerNew() {
	latime = $(window).width();
	inaltime = $(window).height() * 7 / 10;
	for (var i = 0; i < pageVars['generale']['tipuri_ad'].length; i++) {
		if (pageVars['generale']['tipuri_ad'][i][1][0] / (100 - pageVars['generale']['banner']['procent_width_liber']) * 100 > latime) {
			continue;
		};
		if (pageVars['generale']['tipuri_ad'][i][1][1] > inaltime) {
			continue;
		};
		suprafataBanner = pageVars['generale']['tipuri_ad'][i][1][0] * pageVars['generale']['tipuri_ad'][i][1][1];
		if (suprafataBanner / pageVars['generale']['banner']['procent_ocupat'] * 100 > latime * inaltime) {
			continue;
		};
		if (pageVars['generale']['suprafete'].length < pageVars['generale']['banner']['nr_bannere_diversitate']) {
			pageVars['generale']['suprafete'].push(suprafataBanner);
		} else {
			minim = getMin(pageVars['generale']['suprafete'], suprafataBanner);
			if (minim == suprafataBanner) {
				continue;
			};
			suprafete = getOutNr(pageVars['generale']['suprafete'], minim, suprafataBanner);
		};
	};
	getBannerSuprafata(pageVars['generale']['suprafete']);
};

function getOutNr(nrs, nr, nrNou) {
	for (var _i = 0; _i < nrs.length; _i++) {
		if (nr == nrs[_i]) {
			nrs.splice(_i, 1, nrNou);
		};
	};
	return nrs;
};

function getMin(nrs, nrNou) {
	var _n = 0;
	for (var _i = 0; _i < nrs.length; _i++) {
		_n = (_n == 0) ? Math.max(_n, nrs[_i]) : Math.min(_n, nrs[_i]);
	};
	_n = Math.min(_n, nrNou);
	return _n;
};

function getBannerSuprafata(suprafete) {
	var selected;
	var rand = Math.random();
	var progres = 1 / suprafete.length;
	for (var _i = 0; _i < suprafete.length; _i++) {
		if (rand < progres * (_i + 1)) {
			selected = suprafete[_i];
			break;
		};
	};
	for (var _i = 0; _i < pageVars['generale']['tipuri_ad'].length; _i++) {
		if (pageVars['generale']['tipuri_ad'][_i][1][0] * pageVars['generale']['tipuri_ad'][_i][1][1] == selected) {
			bannerAd = pageVars['generale']['tipuri_ad'][_i][0];
			pageVars['generale']['nrBannerAd'] = _i;
			break;
		};
	};
};

function hideMapLocatie() {
	$("#div-container").remove();
	removeTypeOfDivsInfo('div-container');
};

function mouseOverTabRuta(obj, nr) {
	$(obj).parent().children("a").attr("class", "ruta_alternativa");
	$(obj).attr("class", "ruta_alternativa_selected");
	pageVars['generale']['rutaAlternativa'].setLatLngs(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr - 1]['polys'].getLatLngs());
	pageVars['generale']['rutaAlternativa'].setStyle({
		color: pageVars[tipRuta]['orase'][idOrasSelected]['culori'][pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']]
	});
	pageVars['generale']['rutaAlternativa'].addTo(getFrame('iframe_harta').map);
	updateConsum((nr - 1), 0);
	
	updateBlaBlaCar(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr - 1]['info']['distanta']);
};

function mouseOutTabRuta(obj, nr) {
	$(obj).parent().children("a").attr("class", "ruta_alternativa");
	$(obj).parent().children("a:nth-child(" + (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] + 1) + ")").attr("class", "ruta_alternativa_selected");
	pageVars['generale']['rutaAlternativa'].setLatLngs([]);
	pageVars['generale']['rutaAlternativa'].remove();
	updateConsum(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'], 0);
	
	updateBlaBlaCar(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['distanta']);
};

function modifyTimp(updown) {
	if (updown == 'minus') {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['durata'] = Math.max(60, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['durata'] - 300);
	} else if (updown == 'plus') {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['durata'] += 300;
	};
	updateConsum(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'], 0);
};

function modifyViteza(updown) {
	var viteza = Math.round(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['distanta'] * 3600 / pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['durata'] / pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][4]);
	if (updown == 'minus') {
		viteza = Math.max(1, viteza - 1);
	} else if (updown == 'plus') {
		viteza += 1;
	};
	if (tipRuta == 'pe-jos') {
		pageVars['generale']['viteza_pieton_m_s'] = viteza * pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][4] / 3600;
	};
	if (tipRuta == 'bicicleta') {
		pageVars['generale']['viteza_bicicleta_m_s'] = viteza * pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][4] / 3600;
	};
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['durata'] = Math.round(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['distanta'] / viteza / pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][4] * 3600);
	updateConsum(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'], 0);
};

function modifyConsum(updown) {
	if (updown == 'minus') {
		pageVars['generale']['litri_la_suta'] = Math.max(0.5, pageVars['generale']['litri_la_suta'] - 0.5);
	} else if (updown == 'plus') {
		pageVars['generale']['litri_la_suta'] = pageVars['generale']['litri_la_suta'] + 0.5;
	};
	$.cookie('consum', pageVars['generale']['litri_la_suta'], {
		expires: 30,
		path: '/'
	});
	updateConsum(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'], 0);
};


//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
//
// Ultima data
//
//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

function clearStradaObiectiv() {
	if (pageVars['generale']['oras']['markerStradaObiectiv']) {
		pageVars['generale']['oras']['markerStradaObiectiv'].remove();
	};
	if (pageVars['generale']['oras']['infoWindowStradaObiectiv']) {
		pageVars['generale']['oras']['infoWindowStradaObiectiv'].closePopup();
	};
};

function onMapLoad() {
	refreshVarsPageVars();
	$("#b_string_cautare").html(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['nume_afisat_cautare']);
	$("#a_content_tab_ruta").html(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['nume']);
	$("#buton_vezi_directii").val(pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['text_buton']]);
	$("#buton_vezi_directii").attr("title", pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['title_buton']]);
	pageVars['generale']['map_loaded'] = 1;
	control = getFrame('iframe_harta').control;
	controlOptions = getFrame('iframe_harta').L.setOptions(control,{});
	if (document.getElementById(pageVars['generale']['idDivAdSense']) == null && browser !== 'Opera') {};
	if (pageVars['generale']['click_vezi_directii'] == 1) {
		// aici e cand e pe pagina unui oras
		if (typeof oras != 'undefined') {
			processGeo(oras + ', ' + pageVars['generale']['nume_tara']);
			showInfoAlert(oras + ', ' + pageVars['generale']['nume_tara'], 1500);
		};
		clickVeziDirectii();
		pageVars['generale']['click_vezi_directii'] = 0;
	};
	if (page == 'thank-you') {
		$.cookie('noBanner', 1, {
			expires: 30,
			path: '/'
		});
		showInfoAlert(pageVars['texte']['mesaj_thank_you']);
	};
	/* checkMobile();
	$(window).resize(function(){checkMobile();});
	
	// AdSense
	if (isMobile) {
		$("#add_desktop").remove();
		//console.log("height: "+$("#add_mobil").height()+", width: "+$("#add_mobil").width());
		//$("#add_mobil > table > tbody > tr > td").append(createEl("ins",{class:"adsbygoogle",style:"display:block;","data-ad-client":"ca-pub-6075443944137975","data-ad-slot":"8766333732","data-ad-format":"auto"}));
		$("#add_mobil").append(createEl("ins",{class:"adsbygoogle mobil",style:"display: block;","data-ad-client":"ca-pub-6075443944137975","data-ad-slot":"8766333732","data-ad-format":"auto"}));
		//$("#add_mobil > ins.adsbygoogle.mobil").css({height:$("#add_mobil").height(),width:$("#add_mobil").width()});
		//$("#add_mobil > table > tbody > tr > td").append(createEl("ins",{class:"adsbygoogle",style:"display:block;","data-ad-client":"ca-pub-6075443944137975","data-ad-slot":"3272369797","data-ad-format":"auto"}));
		//$("#add_mobil > table > tbody > tr > td").append(createEl("ins",{class:"adsbygoogle",style:"display:block;width:320px;height:100px","data-ad-client":"ca-pub-6075443944137975","data-ad-slot":"6606792417"}));
	} else {
		$("#add_mobil").remove();
		//$("#add_desktop > table > tbody > tr > td").append(createEl("ins",{class:"adsbygoogle",style:"display:inline-block;width:160px;height:600px","data-ad-client":"ca-pub-6075443944137975","data-ad-slot":"5345682436"}));
		$("#add_desktop > table > tbody > tr > td").append(createEl("ins",{class:"adsbygoogle",style:"display:block;","data-ad-client":"ca-pub-6075443944137975","data-ad-slot":"3272369797","data-ad-format":"auto"}));
	};
	(adsbygoogle = window.adsbygoogle || []).push({}); */
	
	if ($.cookie('cookie_accepted') == null) {showCookieTerms();};
};

function checkMobile() {
	if ($(window).width()<750) {
		isMobile=true;
		//$("#add_mobil").css({"margin-top": $("div#main").height()});
	} else {
		isMobile=false;
	};
	//alert($(window).width()+","+$(window).height());
};

function clickCot(obj) {
	clearCots();
	showMarkerVisible($(obj).children(".nr").html());
	pageVars['generale']['infoWindow'].on({
		remove: function () {
			clearCots();
			hideMarkerVisible();
		}
	});
	pageVars['generale']['infoWindow'].setContent(createContentInfoWindow(obj));
	pageVars['generale']['markerVisible'].bindPopup(pageVars['generale']['infoWindow']).openPopup();
	getFrame('iframe_harta').map.setView(pageVars['generale']['markerVisible'].getLatLng(),getFrame('iframe_harta').map.getZoom());
	$(obj).attr("class", "cot_over");
	$(obj).attr("onmouseout", "");
	pageVars['generale']['cotClicked'] = $(obj).children(".nr").html();
	cotOver(obj);
};

function showMarkerVisible(pos) {
	pageVars['generale']['markerVisible'].setLatLng(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['cotituri'][pos - 1][3]);
	pageVars['generale']['markerVisible'].addTo(getFrame('iframe_harta').map);
};

function hideMarkerVisible() {
	pageVars['generale']['markerVisible'].remove();
};

function keyDownCalculRuta(obj, e) {
	refreshVarsPageVars();
	nrBox = $.inArray(obj, $(".input-ruta"));
	if (returnKeyCode(e) == 13) {
		clickSuggest($.inArray(obj, $(".input-ruta")), pageVars['generale']['id_sugestie_selected'] - 1, $("#div-suggest div:eq(" + (pageVars['generale']['id_sugestie_selected'] - 1) + ")"), $(obj).val());
		blurInputRuta(obj, $(obj).val());
		hideMapLocatie();
		resolveSelectArrowInputs();
		clickVeziDirectii(obj, e);
	} else {
		switch (returnKeyCode(e)) {
			case 38:
				keyDownSuggestSageata(obj, 'sus');
				break;
			case 40:
				keyDownSuggestSageata(obj, 'jos');
				break;
			case 27:
				$("#div-suggest").remove();
				resolveSelectArrowInputs();
				hideMapLocatie();
				break;
		};
	};
	$(obj).css({
		'color': ''
	});
};

function updateConsum(id, tip) {
	if (tipRuta == 'autobuz') {
		if (tip == 0) {
			$("div#content_tab_detalii_ruta > table > tbody > tr.point:eq(0) > td").empty().html("A: "+pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs[0]);
			$("div#content_tab_detalii_ruta > table > tbody > tr.point:eq(1) > td").empty().html(pageVars.generale.litere[pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs.length-1].toUpperCase()+": "+pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs[pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs.length-1]);
			var obj = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['buses'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['buses']];
			$("#consum > tbody > tr:eq(2) > td:eq(2)").html(obj[5] + ' ' + ((obj[5] == 1) ? pageVars['texte']['mijloc'] : pageVars['texte']['mijloace']) + ', ' + obj[6] + ' ' + ((obj[6] == 1) ? pageVars['texte']['statie'] : pageVars['texte']['statii']));
			$("#td_distanta").html(calculateDistanta(obj[0]));
			$("#td_timp").html(transformSecundeToText(obj[3], 'simbol'));
			$("#td_viteza").html(calculateViteza(obj[0], obj[3]));
			$("#td_pe_jos").html(calculateDistanta(obj[1], 1));
			$("#td_cost").html(returnNumberWithDecimals(Math.round(obj[4] * 10) / 10) + ' ' + pageVars['texte']['moneda']);
			$("#td_dis").html(calculateDIS(obj[4], obj[3], obj[0]));
			$("#tr_combi > td:eq(0) > table:eq(0) > tbody:eq(0) > tr:eq(0) > td:eq(0)").html(pageVars['texte']['pe_jos']);
		} else {
			$("div#content_tab_detalii_ruta > table > tbody > tr.point:eq(0) > td").empty().html("A: "+pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs[0]);
			$("div#content_tab_detalii_ruta > table > tbody > tr.point:eq(1) > td").empty().html(pageVars.generale.litere[pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs.length-1].toUpperCase()+": "+pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs[pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs.length-1]);
			var cost = calculeazaPretTaxi(id[0], tip);
			$("#td_plecati_la div").hide();
			$("#td_ajungeti_la div").hide();
			$("#td_distanta").html(transformDistantaToText(id[0], pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][2]));
			$("#td_mijloace_statii").html("");
			$("#td_timp").html(transformSecundeToText(id[1], 'simbol'));
			$("#td_dis").html(calculateDIS(cost, id[1], id[0]));
			$("#td_cost").html(cost + ' ' + pageVars['texte']['moneda']);
			$("#consum > tbody > tr:eq(2) > td:eq(2)").html("");
			$("#td_viteza").html(calculateViteza(id[0], id[1]));
			$("#tr_combi > td:eq(0) > table:eq(0) > tbody:eq(0) > tr:eq(0) > td:eq(0)").html(pageVars['texte']['string_consum_total']);
			$("#td_pe_jos").html(calculateConsumTotal(id[0]));
		};
		if (tip > 0) {
			$("div#content_tab_detalii_ruta > table > tbody > tr.point:eq(0) > td").empty().html("A: "+pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs[0]);
			$("div#content_tab_detalii_ruta > table > tbody > tr.point:eq(1) > td").empty().html(pageVars.generale.litere[pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs.length-1].toUpperCase()+": "+pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs[pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs.length-1]);
			$("#tab_alternativ_taxi").attr("title", pageVars['texte']['string_taxi'] + ": " + cost + " " + pageVars['texte']['moneda'] + ", " + transformDistantaToText(id[0], pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][2]) + ", " + transformSecundeToText(id[1], 'simbol'));
		};
	} else {
		$("div#content_tab_detalii_consum > table > tbody > tr.point:eq(0) > td").empty().html("A: "+pageVars[tipRuta].orase[0].rute.textCoordVarsInputs[0]);
		$("div#content_tab_detalii_consum > table > tbody > tr.point:eq(1) > td").empty().html(pageVars.generale.litere[pageVars[tipRuta].orase[0].rute.textCoordVarsInputs.length-1].toUpperCase()+": "+pageVars[tipRuta].orase[0].rute.textCoordVarsInputs[pageVars[tipRuta].orase[0].rute.textCoordVarsInputs.length-1]);
		if (tip == 0) {
			var distanta = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][id]['info']['distanta'];
			var durata = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][id]['info']['durata'];
		} else {
			var distanta = id[0];
			var durata = id[1];
		};
		var cost = (tip == 0) ? calculateCost(distanta) : calculeazaPretTaxi(distanta, tip);
		$("#td_viteza").html("");
		$("#td_viteza").append(createPlusMinusViteza());
		$("#td_viteza").append(calculateViteza(distanta, durata));
		$("#td_timp").html("");
		$("#td_timp").append(createPlusMinusTimp());
		$("#td_timp").append(transformSecundeToText(durata, 'string'));
		$("#td_consum").html("");
		$("#td_consum").append(createPlusMinusConsum());
		$("#td_consum").append(returnNumberWithDecimals(calculateVolumCarburant()) + ' ' + pageVars['generale']['unitati_masura_volum'][pageVars['generale']['default_um']][1] + '/100 ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1]);
		$("#td_consum_total").html(calculateConsumTotal(distanta));
		$("#td_cost").html(cost + ' ' + pageVars['texte']['moneda']);
		$("#td_dis").html("");
		$("#td_dis").append(calculateDIS(cost, durata, distanta));
		$("#km").html(transformDistantaToText(distanta, pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][2]));
		$("#timp").html(transformSecundeToText(durata, 'simbol'));
		$("#td_consum").parent().hide();
		$("#tr_combi").hide();
		if (tipRuta == 'auto' || tip > 0) {
			$("#td_consum").parent().show();
			$("#tr_combi").show();
		};
		if (tip > 0) {
			$("#tab_alternativ_taxi").attr("title", pageVars['texte']['string_taxi'] + ": " + cost + " " + pageVars['texte']['moneda'] + ", " + transformDistantaToText(distanta, pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][2]) + ", " + transformSecundeToText(durata, 'simbol'));
		};
		adjustHeightDetaliiConsum();
	};
};

function searchToResult() {
	var distanta = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['distanta'];
	showOptionsOnReturn = 0;
	divTop = 'oras-oras';
	if ($("#div_avansat").length > 0) {
		showOptionsOnReturn = 1;
	};
	$("#cautare_ruta_inner").remove();
	$("#div_avansat").remove();
	$("#content").remove();
	$('#main').append(createDivContent('rezultate'), createDivTabs(stabilesteTaburi()));
	if (pageVars.generale.tip_ruta == 'auto' && distanta >= 50000 && distanta < 900000 && pageVars.autohop.active == 1) {
		$("#content").append(createTabDetaliiAutohop());
	};
	setScrollRezultate();
	$("div.tabs_mobile, #sageata_top").show();
	$("div#sageata_top > img").attr({src:pathToImg+'arrow-up.png'});
	$("div.tab_mobile").remove();
};

function mouseOverRowLinii(obj, turRetur, index) {
	$(obj).children("td").eq(0).css("color", "green");
	$(obj).children("td").eq(1).css("color", "green");
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['markers'][index], function(k, marker) {
		marker.setIcon(getFrame('iframe_harta').markerRed);
	});
};

function mouseOutRowLinii(obj, turRetur, index) {
	$(obj).children("td").eq(0).css("color", "");
	$(obj).children("td").eq(1).css("color", "");
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['markers'][index], function(k, marker) {
		marker.setIcon(getFrame('iframe_harta').markerRedDot);
	});
};

function hideAutobuzeLinie() {
	if (pageVars['autobuz']['orase'][idOrasSelected]['linii']['results'].length > 0) {
		if (pageVars['autobuz']['orase'][idOrasSelected]['linii']['results'][0]['tur'] && pageVars['autobuz']['orase'][idOrasSelected]['linii']['results'][0]['tur']['markers'].length > 0) {
			$.each(pageVars['autobuz']['orase'][idOrasSelected]['linii']['results'][0]['tur']['markers'], function(key, markers) {
				$.each(markers, function(k, marker) {
					marker.remove();
				});
			});
			$.each(pageVars['autobuz']['orase'][idOrasSelected]['linii']['results'][0]['tur']['polys'], function(key, poly) {
				poly.remove();
			});
		};
		if (pageVars['autobuz']['orase'][idOrasSelected]['linii']['results'][0]['retur'] && pageVars['autobuz']['orase'][idOrasSelected]['linii']['results'][0]['retur']['markers'].length > 0) {
			$.each(pageVars['autobuz']['orase'][idOrasSelected]['linii']['results'][0]['retur']['markers'], function(key, markers) {
				$.each(markers, function(k, marker) {
					marker.remove();
				});
			});
			$.each(pageVars['autobuz']['orase'][idOrasSelected]['linii']['results'][0]['retur']['polys'], function(key, poly) {
				poly.remove();
			});
		};
	};
};

function showAutobuzeLinie(turRetur) {
	$.each(turRetur, function(key, tr) {
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][tr] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][tr]['markers'].length > 0) {
			$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][tr]['markers'], function(key, markers) {
				$.each(markers, function(k, marker) {
					marker.addTo(getFrame('iframe_harta').map);
				});
			});
			$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][tr]['polys'], function(key, poly) {
				poly.addTo(getFrame('iframe_harta').map);
			});
		};
	});
};

function mouseOverTabAutobuzLinie(obj, nr) {
	$(obj).parent().children("a").attr("class", "ruta_alternativa");
	$(obj).attr("class", "ruta_alternativa_selected");
	hideAutobuzeLinie();
	showAutobuzeLinie((nr == 0) ? ['tur', 'retur'] : ((nr == 1) ? ['tur'] : ['retur']));
};

function mouseOutTabAutobuzLinie(obj, nr) {
	$(obj).parent().children("a").attr("class", "ruta_alternativa");
	$(obj).parent().children("a").eq(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']).attr("class", "ruta_alternativa_selected");
	hideAutobuzeLinie();
	showAutobuzeLinie((pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] == 0) ? ['tur', 'retur'] : ((pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] == 1) ? ['tur'] : ['retur']));
};

function searchToResultAutobuzeLinie() {
	showOptionsOnReturn = 0;
	divTop = 'oras-oras';
	if ($("#div_avansat").length > 0) {
		showOptionsOnReturn = 1;
	};
	$("#cautare_ruta_inner").remove();
	$("#div_avansat").remove();
	$("#content").remove();
	$('#main').append(createDivContent('rezultate-autobuze-linie'), createDivTabs(stabilesteTaburi()));
	$("#content_tab_linie").append(createTaburiTurRetur(3));
	setTabSelected(0);
	
	$("div.tabs_mobile_linie, #sageata_top").show();
	$("div#sageata_top > img").attr({src:pathToImg+'arrow-up.png'});
};

function clickRowLinii(obj, turRetur, index) {
	var coordsForBounds = [];
	var center = null;
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][index - 1]) {
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][index - 1]['gps'], function(key, coord) {
			coordsForBounds.push(coord);
		});
	};
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][index]['gps'], function(key, coord) {
		coordsForBounds.push(coord);
		center = coord;
	});
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][index + 1]) {
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][index + 1]['gps'], function(key, coord) {
			coordsForBounds.push(coord);
		});
	};
	var bounds = calculateBoundsFromCoords(coordsForBounds);
	getFrame('iframe_harta').setBounds(getFrame('iframe_harta').getBounds(bounds[0], bounds[1]));
	getFrame('iframe_harta').setCenter(center[0], center[1]);
};

function hideAllAutobuzeLiniiStatie() {
	$.each(pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['linii'], function(idLinie, linie) {
		pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['linii'][idLinie]['polys_inainte'].remove();
		pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['linii'][idLinie]['polys_dupa'].remove();
		$.each(pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['linii'][idLinie]['statii_inainte'], function(key, idStatie) {
			$.each(pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['statii'][idStatie]['markers'], function(k, marker) {
				marker.remove();
			});
		});
		$.each(pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['linii'][idLinie]['statii_dupa'], function(key, idStatie) {
			$.each(pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['statii'][idStatie]['markers'], function(k, marker) {
				marker.remove();
			});
		});
	});
	$.each(pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['statii_apropiere'], function(idStatie, statie) {
		pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['statii_apropiere'][idStatie]['puncte_gps'].remove();
		$.each(statie['markers'], function(key, marker) {
			marker.setIcon(getFrame('iframe_harta').markerRedDot);
		});
	});
	$(".content_traseu tr.tr_orange").css("background-color", "");
	$.each($(".content_traseu tr.tr_orange"), function(key, obj) {
		$(obj).children("td:eq(1)").css("color", "#E01B4C");
	});
};

function hideAutobuzeLiniiStatie() {
	if (pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'].length > 0) {
		$.each(pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['markers'], function(idStatie, markers) {
			$.each(markers, function(key, marker) {
				marker.remove();
			});
		});
		hideAllAutobuzeLiniiStatie();
		$.each(pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['statii_apropiere'], function(idStatie, statie) {
			$.each(statie['markers'], function(key, marker) {
				marker.remove();
			});
		});
		pageVars['autobuz']['orase'][idOrasSelected]['statii']['results'][0]['markers'] = {};
	};
	autobuzStatieIsShown = null;
};

function prelucreazaOrarLinieAutobuz(ora, data) {
	var maxOrePerDiv = 6;
	var red = 0;
	var oz = getOraTipZi();
	$("#td_orar").html("");
	$("#td_head_interval_orar").html(((parseInt(ora) < 10) ? "0" + parseInt(ora) : parseInt(ora)) + ":00 - " + ((parseInt(ora) + 1 < 10) ? "0" + (parseInt(ora) + 1) : (parseInt(ora) + 1)) + ":00");
	if (data.length > 0) {
		var nrDivuri = Math.ceil(data.length / maxOrePerDiv);
		for (var i = 0; i < nrDivuri; i++) {
			var div = createEl("div", {
				'style': 'float:left; margin-left:15px;'
			});
			for (var j = i * maxOrePerDiv; j < (i + 1) * maxOrePerDiv; j++) {
				if (data[j] || data[j] == 0) {
					$(div).append(createEl("span", {}, ((ora < 10) ? "0" + ora : ora) + ':' + ((data[j] < 10) ? "0" + data[j] : data[j])));
					$(div).append(createEl("br"));
				};
				if ((data[j] > new Date().getMinutes() && red == 0 && parseInt(ora) == new Date().getHours() && $("#select_tip_zi_orar").val() == oz[1])) {
					$(div).children("span").last().css("color", "#E01B4C");
					red = 1;
				};
			};
			$("#td_orar").append(div);
		};
	};
};

function changeOraOrarLinieAutobuz(turRetur, ora) {
	$("#td_orar").html("");
	$("#td_orar").append(createEl("div", {
		'class': 'loading-orar'
	}, createEl("img", {
		'src': pathToImg + 'loading-cerc.gif'
	})));
	$("#td_orar div").append(createText(pageVars['texte']['asteptati'] + "..."));
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'orar_linii_autobuz',
			'il': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['id_linie'],
			'is': $("#select_statii_orar").val(),
			'itz': $("#select_tip_zi_orar").val(),
			'o': ora
		},
		success: function(d) {
			prelucreazaOrarLinieAutobuz(ora, dataOrar);
		}
	});
};

function changeTipZiOrarLinieAutobuz(turRetur, indexStatie, idStatie, idTipZi, ora) {
	var okOra = 0;
	if (!ora) {
		var oz = getOraTipZi();
		if ($("#select_ore_orar option").length > 0) {
			var ora = $("#select_ore_orar").val();
		} else {
			var ora = oz[0];
		};
	};
	$("#select_ore_orar").empty();
	$("#td_orar").html("");
	$("#td_orar").append(createEl("div", {
		'class': 'loading-orar'
	}, createEl("img", {
		'src': pathToImg + 'loading-cerc.gif'
	})));
	$("#td_orar div").append(createText(pageVars['texte']['asteptati'] + "..."));
	$("#select_ore_orar").attr("onchange", "changeOraOrarLinieAutobuz('" + turRetur + "',this.value);");
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][indexStatie]['orar'][idTipZi][1], function(key, nrOra) {
		$("#select_ore_orar").append(createEl("option", {
			'value': nrOra,
			'selected': (nrOra == ora) ? true : false
		}, pageVars['texte']['ora'] + ((nrOra < 10) ? "0" + nrOra : nrOra)));
		if (nrOra == ora) {
			okOra = 1;
		};
	});
	if (okOra == 0) {
		ora = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][indexStatie]['orar'][idTipZi][1][0];
	};
	changeOraOrarLinieAutobuz(turRetur, ora);
};

function changeStatieOrarLinieAutobuz(turRetur, indexStatie, idStatie) {
	$("#td_orar").html("");
	$("#td_orar").append(createEl("div", {
		'class': 'loading-orar'
	}, createEl("img", {
		'src': pathToImg + 'loading-cerc.gif'
	})));
	$("#td_orar div").append(createText(pageVars['texte']['asteptati'] + "..."));
	var oz = getOraTipZi();
	if ($("#select_tip_zi_orar option").length > 0) {
		var tipZi = $("#select_tip_zi_orar").val();
	} else {
		tipZi = oz[1];
	};
	if ($("#select_ore_orar option").length > 0) {
		var ora = $("#select_ore_orar").val();
	} else {
		ora = oz[0];
	};
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][indexStatie]['orar'] != null) {
		$("#select_tip_zi_orar").empty();
		$("#select_ore_orar").empty();
		$("#select_tip_zi_orar").attr("onchange", "changeTipZiOrarLinieAutobuz('" + turRetur + "'," + indexStatie + "," + idStatie + ",this.value);");
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][indexStatie]['orar'], function(idTipZi, dataTipZi) {
			$("#select_tip_zi_orar").append(createEl("option", {
				'value': idTipZi,
				'selected': (idTipZi == tipZi) ? true : false
			}, dataTipZi[0]));
		});
		changeTipZiOrarLinieAutobuz(turRetur, indexStatie, idStatie, $("#select_tip_zi_orar").val(), ora);
	} else {
		$.ajax({
			url: '/inc/ajax.php',
			dataType: 'script',
			type: 'post',
			data: {
				'for': 'ore_linii_autobuz',
				'il': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['id_linie'],
				'is': idStatie
			},
			success: function(d) {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][indexStatie]['orar'] = dataOre;
				changeStatieOrarLinieAutobuz(turRetur, indexStatie, idStatie);
			}
		});
	};
};

function populateStatiiAutobuzLiniiOrar(turRetur) {
	$("#select_statii_orar").empty();
	$("#td_orar").html("");
	$("#td_orar").append(createEl("div", {
		'class': 'loading-orar'
	}, createEl("img", {
		'src': pathToImg + 'loading-cerc.gif'
	})));
	$("#td_orar div").append(createText(pageVars['texte']['asteptati'] + "..."));
	$("#select_statii_orar").attr("onchange", "changeStatieOrarLinieAutobuz('" + turRetur + "',this.selectedIndex,this.value);");
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'], function(key, statie) {
		$("#select_statii_orar").append(createEl("option", {
			'value': statie['id']
		}, statie['nume']));
	});
	changeStatieOrarLinieAutobuz(turRetur, 0, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0][turRetur]['statii'][0]['id']);
};

function clickTabAutobuzLinie(nr) {
	attachDivTop();
	obj = $(".rute_alternative a").eq(nr);
	$(obj).parent().children("a").attr("class", "ruta_alternativa");
	$(obj).attr("class", "ruta_alternativa_selected");
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] = nr;
	var turRetur;
	if (nr == 0) {
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']) {
			turRetur = ['tur', 'retur'];
		} else if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur']) {
			turRetur = ['tur'];
		} else if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']) {
			turRetur = ['retur'];
		};
		getFrame('iframe_harta').setBounds(getFrame('iframe_harta').getBounds(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['bounds'][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['bounds'][1]));
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur']['statii'][0]['orar'] == null && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']['statii'][0]['orar'] == null) {
			$("#tab_orar, #content_tab_orar").remove();
		};
	} else if (nr == 1) {
		turRetur = ['tur'];
		getFrame('iframe_harta').setBounds(getFrame('iframe_harta').getBounds(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur']['bounds'][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur']['bounds'][1]));
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur']['statii'][0]['orar'] == null) {
			$("#tab_orar, #content_tab_orar").remove();
		};
	} else {
		turRetur = ['retur'];
		getFrame('iframe_harta').setBounds(getFrame('iframe_harta').getBounds(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']['bounds'][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']['bounds'][1]));
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']['statii'][0]['orar'] == null) {
			$("#tab_orar, #content_tab_orar").remove();
		};
	};
	
	$(".content_traseu").remove();
	$("#traseu, #table_instructiuni_linie").append(createTableAutobuzeLinie(turRetur));
	$("#table_instructiuni_linie > div.content_traseu > div").removeProp("onclick");
	
	setScrollRezultateNoImg();
	hideAutobuzeLinie();
	showAutobuzeLinie(turRetur);
	$("#" + turRetur.join('-')).attr("checked", true);
	$("#tur_retur_orar_" + turRetur[0]).attr("checked", true);
	if ($("#tab_orar").length == 1) {
		populateStatiiAutobuzLiniiOrar(turRetur[0]);
	};
	setHash(((idOrasSelected > 0) ? pageVars[tipRuta]['orase'][idOrasSelected]['url'] + '/' : "") + pageVars[tipRuta]['orase'][idOrasSelected]['url_sectiune'] + '/' + data['url'].join((history.pushState) ? '/' : '~'));
};

function prelucreazaStatiiExtrase(dataStatii) {
	for (var i = 0; i < dataStatii.length; i++) {
		getFrame('iframe_harta').setMarkerStatie(dataStatii[i], i);
	};
	inchideAlert();
};

function clearMarkersStatiiIncarcate() {
	$.each(pageVars['tip_rute'], function(k, tR) {
		$.each(pageVars[tR]['orase'], function(iO, arr) {
			if (arr['statii_incarcate'] && arr['statii_incarcate'].length > 0) {
				for (var i = 0; i < arr['statii_incarcate'].length; i++) {
					arr['statii_incarcate'][i].remove();
				};
			};
		});
	});
};

function getStatiiOras() {
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'extrage_statii_oras',
			'io': idOrasSelected
		},
		success: function(d) {
			prelucreazaStatiiExtrase(dataStatii);
		},
		beforeSend: function() {
			ascundeAvansat();
		}
	});
};

function prelucreazaLinieAutobuz(data, exista) {
	var marker;
	var poly;
	var path = [];
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] = 0;
	clearMarkersStatiiIncarcate();
	if (exista == 0) {
		if (data['tur']) {
			$.each(data['tur']['statii'], function(key, statie) {
				var markers = [];
				$.each(statie['gps'], function(k, point) {
					marker = getFrame('iframe_harta').getMarkerRosu([point[0], point[1]], statie['nume'] + '\n' + data['nume_tip_mijloc_articulat'] + ' ' + data['nume'] + '\n' + pageVars['texte']['legaturi'] + ': ' + ((statie['legaturi'] != "") ? statie['legaturi'] : "-"));
					markers.push(marker);
				});
				data['tur']['markers'].push(markers);
			});
			for (var i = 0; i < data['tur']['puncte_gps'].length; i++) {
				path.push(getFrame('iframe_harta').getPoint(data['tur']['puncte_gps'][i][0], data['tur']['puncte_gps'][i][1]));
			};
			poly = getFrame('iframe_harta').getPolyLinieAutobuz(path, pageVars[tipRuta]['orase'][idOrasSelected]['culori'][pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']]);
			data['tur']['polys'].push(poly);
			path = [];
		};
		if (data['retur']) {
			$.each(data['retur']['statii'], function(key, statie) {
				var markers = [];
				$.each(statie['gps'], function(k, point) {
					marker = getFrame('iframe_harta').getMarkerRosu([point[0], point[1]], statie['nume'] + '\n' + data['nume_tip_mijloc_articulat'] + ' ' + data['nume'] + '\n' + pageVars['texte']['legaturi'] + ': ' + ((statie['legaturi'] != "") ? statie['legaturi'] : "-"));
					markers.push(marker);
				});
				data['retur']['markers'].push(markers);
			});
			for (var i = 0; i < data['retur']['puncte_gps'].length; i++) {
				path.push(getFrame('iframe_harta').getPoint(data['retur']['puncte_gps'][i][0], data['retur']['puncte_gps'][i][1]));
			};
			poly = getFrame('iframe_harta').getPolyLinieAutobuz(path, pageVars[tipRuta]['orase'][idOrasSelected]['culori'][nextColor()]);
			data['retur']['polys'].push(poly);
			path = [];
		};
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].unshift(dataLinie);
	};
	searchToResultAutobuzeLinie();
	clickTabAutobuzLinie(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']);
	if (data['tur']) {
		$("#detalii_linie_distanta_tur").html(calculateDistanta(data['tur']['distanta']));
		$("#detalii_linie_timp_tur").html(transformSecundeToText(data['tur']['timp'], 'string'));
		$("#detalii_linie_cost_tur").html(returnNumberWithDecimals(data['tur']['cost']) + " " + pageVars['texte']['moneda']);
		$("#detalii_linie_dis_tur").html(calculateDIS(data['tur']['cost'], data['tur']['timp'], data['tur']['distanta']));
		if (!data['retur']) {
			$("div.rute_alternative").remove();
			$("#detalii_linie tr:last").remove();
			for (var i = 0; i < $("#detalii_linie tr").length; i++) {
				$("#detalii_linie tr:eq(" + i + ") td:eq(2)").remove();
			};
			$("#detalii_linie tr:first td:last").css("width", "170px");
			$("#content_tab_linie").height($("#content_tab_linie").height() + 26);
			$("#traseu").height($("#traseu").height() + 26);
			setScrollRezultateNoImg();
		};
	};
	if (data['retur']) {
		$("#detalii_linie_distanta_retur").html(calculateDistanta(data['retur']['distanta']));
		$("#detalii_linie_timp_retur").html(transformSecundeToText(data['retur']['timp'], 'string'));
		$("#detalii_linie_cost_retur").html(returnNumberWithDecimals(data['retur']['cost']) + " " + pageVars['texte']['moneda']);
		$("#detalii_linie_dis_retur").html(calculateDIS(data['retur']['cost'], data['retur']['timp'], data['retur']['distanta']));
		if (!data['tur']) {
			$("div.rute_alternative").remove();
			$("#detalii_linie tr:last").remove();
			for (var i = 0; i < $("#detalii_linie tr").length; i++) {
				$("#detalii_linie tr:eq(" + i + ") td:eq(1)").remove();
			};
			$("#detalii_linie tr:first td:last").css("width", "170px");
			$("#content_tab_linie").height($("#content_tab_linie").height() + 26);
			$("#traseu").height($("#traseu").height() + 26);
			setScrollRezultateNoImg();
		};
	};
};

function getLinie(data, e) {
	refreshVarsPageVars();
	clearStradaObiectiv();
	hideAutobuzeLinie();
	var resultGasit = null;
	var alteResults = [];
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'], function(key, result) {
		if (result['nume'] == pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][0] && (result['url_tip_mijloc_articulat'] + '-' + result['url']) == pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][0]) {
			resultGasit = result;
		} else {
			alteResults.push(result);
		};
	});
	if (resultGasit != null) {
		alteResults.unshift(resultGasit);
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] = alteResults;
		prelucreazaLinieAutobuz(resultGasit, 1);
	} else {
		$.ajax({
			url: '/inc/ajax.php',
			dataType: 'script',
			type: 'post',
			data: {
				'for': 'linie_transport_in_comun',
				'u': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][0],
				't': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][0],
				'io': idOrasSelected
			},
			success: function(d) {
				prelucreazaLinieAutobuz(dataLinie, 0);
			},
			beforeSend: function() {}
		});
	};
};

function clearRuteAutobuz() {
	for (var i = 0; i < pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length; i++) {
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][i]['polys'], function(buses, polys) {
			for (var j = 0; j < polys.length; j++) {
				polys[j].remove();
			};
		});
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][i]['markers'], function(buses, markers) {
			for (var j = 0; j < markers.length; j++) {
				markers[j].remove();
			};
		});
	};
};

function resetRuteAutobuz() {
	clearRuteAutobuz();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] = [];
	pageVars['generale']['rutaAlternativa'].setLatLngs([]);
	pageVars['generale']['rutaAlternativa'].remove();
};

function getPuncteLinie(data, keyRuta, idLinie, idPlecare, idSosire) {
	var points = [],
		mark = [],
		distanta = 0,
		nrStatii = 0,
		idPrevStation = idPlecare;
	if (idLinie > 0) {
		nrStatii = data['rute'][keyRuta][idPlecare][idLinie].length + 1;
		$.each(data['rute'][keyRuta][idPlecare][idLinie], function(key, idStatieIntermediara) {
			if (data['statii'][idStatieIntermediara]['gps'].length > 1) {
				mark.push([data['statii'][idStatieIntermediara]['gps_sosea'], data['statii'][idStatieIntermediara]['nume'] + '\n' + data['statii'][idStatieIntermediara]['legaturi'], getFrame('iframe_harta').markerRedDotBig]);
			} else {
				mark.push([data['statii'][idStatieIntermediara]['gps'][0], data['statii'][idStatieIntermediara]['nume'] + '\n' + data['statii'][idStatieIntermediara]['legaturi'], getFrame('iframe_harta').markerRedDotBig]);
			};
			points.push(data['statii'][idPrevStation]['gps_sosea']);
			$.each(data['puncte_statii'][idPrevStation][idStatieIntermediara]['puncte'], function(k, point) {
				points.push(point);
			});
			distanta += data['puncte_statii'][idPrevStation][idStatieIntermediara]['distanta'];
			idPrevStation = idStatieIntermediara;
		});
		points.push(data['statii'][idPrevStation]['gps_sosea']);
		$.each(data['puncte_statii'][idPrevStation][idSosire]['puncte'], function(k, point) {
			points.push(point);
		});
		points.push(data['statii'][idSosire]['gps_sosea']);
		distanta += data['puncte_statii'][idPrevStation][idSosire]['distanta'];
	} else {
		if (dataRute['puncte_statii'][idPrevStation][idSosire]['puncte'][0] && data['puncte_statii'][idPrevStation][idSosire]['puncte'][0].length > 0) {
			if (data['statii'][idPrevStation]['gps'].length > 1) {
				if (data['statii'][idSosire]['gps'].length > 1) {
					var pointPlecare = data['statii'][idPrevStation]['gps_sosea'];
					var pointSosire = data['statii'][idSosire]['gps_sosea'];
				} else {
					var pointPlecare = data['statii'][idPrevStation]['gps_sosea'];
					var pointSosire = data['statii'][idSosire]['gps'][0];
				};
			} else {
				if (data['statii'][idSosire]['gps'].length > 1) {
					var pointPlecare = data['statii'][idPrevStation]['gps'][0];
					var pointSosire = data['statii'][idSosire]['gps_sosea'];
				} else {
					var pointPlecare = data['statii'][idPrevStation]['gps'][0];
					var pointSosire = data['statii'][idSosire]['gps'][0];
				};
			};
			points.push(pointPlecare);
			$.each(data['puncte_statii'][idPrevStation][idSosire]['puncte'], function(k, point) {
				points.push(point);
			});
			points.push(pointSosire);
			distanta = data['puncte_statii'][idPrevStation][idSosire]['distanta'];
		} else {
			if (data['statii'][idPrevStation]['gps'].length > 1) {
				if (data['statii'][idSosire]['gps'].length > 1) {
					points.push(data['statii'][idPrevStation]['gps_sosea'], data['statii'][idSosire]['gps_sosea']);
					if (data['puncte_statii'][idPrevStation][idSosire]['distanta'] > 0) {
						distanta += data['puncte_statii'][idPrevStation][idSosire]['distanta'];
					} else {
						distanta += calculateDistanceFromLatLong(data['statii'][idPrevStation]['gps_sosea'], data['statii'][idSosire]['gps_sosea']);
					};
				} else {
					var minim = null,
						iMinim = null,
						d = 0;
					for (var i = 0; i < data['statii'][idPrevStation]['gps'].length; i++) {
						d = calculateDistanceFromLatLong(data['statii'][idPrevStation]['gps'][i], data['statii'][idSosire]['gps'][0]);
						if (!minim) {
							minim = d;
							iMinim = i;
						} else {
							if (d < minim) {
								minim = d;
								iMinim = i;
							};
						};
					};
					points.push(data['statii'][idPrevStation]['gps_sosea'], data['statii'][idPrevStation]['gps'][iMinim], data['statii'][idSosire]['gps'][0]);
					if (data['puncte_statii'][idPrevStation][idSosire]['distanta'] > 0) {
						distanta += data['puncte_statii'][idPrevStation][idSosire]['distanta'];
					} else {
						distanta += calculateDistanceFromLatLong(data['statii'][idPrevStation]['gps_sosea'], data['statii'][idPrevStation]['gps'][iMinim]);
						distanta += calculateDistanceFromLatLong(data['statii'][idPrevStation]['gps'][iMinim], data['statii'][idSosire]['gps'][0]);
					};
				};
			} else {
				if (data['statii'][idSosire]['gps'].length > 1) {
					var minim = null,
						iMinim = null,
						d = 0;
					for (var i = 0; i < data['statii'][idSosire]['gps'].length; i++) {
						d = calculateDistanceFromLatLong(data['statii'][idSosire]['gps'][i], data['statii'][idPrevStation]['gps'][0]);
						if (!minim) {
							minim = d;
							iMinim = i;
						} else {
							if (d < minim) {
								minim = d;
								iMinim = i;
							};
						};
					};
					points.push(data['statii'][idPrevStation]['gps'][0], data['statii'][idSosire]['gps'][iMinim], data['statii'][idSosire]['gps_sosea']);
					if (data['puncte_statii'][idPrevStation][idSosire]['distanta'] > 0) {
						distanta += data['puncte_statii'][idPrevStation][idSosire]['distanta'];
					} else {
						distanta += calculateDistanceFromLatLong(data['statii'][idPrevStation]['gps'][0], data['statii'][idSosire]['gps'][iMinim]);
						distanta += calculateDistanceFromLatLong(data['statii'][idSosire]['gps'][iMinim], data['statii'][idSosire]['gps_sosea']);
					};
				} else {
					points.push(data['statii'][idPrevStation]['gps'][0], data['statii'][idSosire]['gps'][0]);
					if (data['puncte_statii'][idPrevStation][idSosire]['distanta'] > 0) {
						distanta += data['puncte_statii'][idPrevStation][idSosire]['distanta'];
					} else {
						distanta += calculateDistanceFromLatLong(data['statii'][idPrevStation]['gps'][0], data['statii'][idSosire]['gps'][0]);
					};
				};
			};
		};
	};
	return [idLinie, points, distanta, mark, nrStatii];
};

function searchToResultAutobuzeRute() {
	showOptionsOnReturn = 0;
	divTop = 'oras-oras';
	if ($("#div_avansat").length > 0) {
		showOptionsOnReturn = 1;
	};
	$("#cautare_ruta_inner").remove();
	$("#div_avansat").remove();
	$("#content").remove();
	$('#main').append(createDivContent('rezultate-autobuze-ruta'), createDivTabs(stabilesteTaburi()));
	$("div.tabs_mobile, #sageata_top").show();
	$("div#sageata_top > img").attr({src:pathToImg+'arrow-up.png'});
	$("div.tab_mobile").remove();
};

function writeDetaliiRutaAutobuz() {
	$("#div_plecare").html(shorterString(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['statii'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['order'][0]]['nume'], pageVars['generale']['limit_caractere_ruta']));
	$("#div_sosire").html(shorterString(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['statii'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['order'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['order'].length - 1]]['nume'], pageVars['generale']['limit_caractere_ruta']));
	$("#div_plecare").attr("title", pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['statii'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['order'][0]]['nume'] + pageVars['texte']['click_derulare_ruta']);
	$("#div_sosire").attr("title", pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['statii'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['order'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['order'].length - 1]]['nume'] + pageVars['texte']['click_derulare_ruta']);
	$("#traseu").html(createContentTraseuAutobuz());
	setScrollRezultateNoImg();
};

function updateInfoBox(indexRuta) {
	var busesSelected = null;
	if (indexRuta != pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']) {
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][indexRuta]['buses'], function(b, object) {
			if (!busesSelected) {
				busesSelected = b;
				return false;
			};
		});
	} else {
		busesSelected = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['buses'];
	};
	if (tipRuta == "autobuz") {
		$("div#content_tab_detalii_ruta > table > tbody > tr.point:eq(0) > td").empty().html("A: "+pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs[0]);
		$("div#content_tab_detalii_ruta > table > tbody > tr.point:eq(1) > td").empty().html(pageVars.generale.litere[pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs.length-1].toUpperCase()+": "+pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs[pageVars[tipRuta].orase[pageVars[tipRuta].id_oras_selected].rute.textCoordVarsInputs.length-1]);
	} else {
		$("div#content_tab_detalii_consum > table > tbody > tr.point:eq(0) > td").empty().html("A: "+pageVars[tipRuta].orase[0].rute.textCoordVarsInputs[0]);
		$("div#content_tab_detalii_consum > table > tbody > tr.point:eq(1) > td").empty().html(pageVars.generale.litere[pageVars[tipRuta].orase[0].rute.textCoordVarsInputs.length-1].toUpperCase()+": "+pageVars[tipRuta].orase[0].rute.textCoordVarsInputs[pageVars[tipRuta].orase[0].rute.textCoordVarsInputs.length-1]);
	};
	var obj = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][indexRuta]['buses'][busesSelected];
	$("#td_distanta").html(calculateDistanta(obj[0]));
	$("#td_timp").html(transformSecundeToText(obj[3], 'simbol'));
	$("#td_viteza").html(calculateViteza(obj[0], obj[3]));
	$("#td_mijloace_statii").html(obj[5] + ' ' + ((obj[5] == 1) ? pageVars['texte']['mijloc'] : pageVars['texte']['mijloace']) + ', ' + obj[6] + ' ' + ((obj[6] == 1) ? pageVars['texte']['statie'] : pageVars['texte']['statii']));
	$("#td_pe_jos").html(calculateDistanta(obj[1], 1));
	$("#td_cost").html(returnNumberWithDecimals(Math.round(obj[4] * 10) / 10) + ' ' + pageVars['texte']['moneda']);
	$("#td_dis").html(calculateDIS(obj[4], obj[3], obj[0]));
	$("#plecare").html(shorterString(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['statii'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][indexRuta]['order'][0]]['nume'], pageVars['generale']['limit_caractere_ruta']));
	$("#sosire").html(shorterString(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['statii'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][indexRuta]['order'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax']['rute'][indexRuta]['order'].length - 1]]['nume'], pageVars['generale']['limit_caractere_ruta']));
	$("#km").html(calculateDistanta(obj[0]));
	$("#timp").html(transformSecundeToText(obj[3], 'simbol'));
};

function getOraRuteAutobuz() {
	var ora = null;
	var oraForReturn = null;
	var oraSelectata = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'];
	var plSos;
	var oraTipZi = getOraTipZi();
	var b = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['buses'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['buses']];
	if (b[7] && b[7] !== null) {
		if (oraSelectata[0] != null && oraSelectata[1] != null && oraSelectata[2] == 1) {
			plSos = oraSelectata[1];
			ora = oraSelectata[0];
		} else {
			plSos = 'plecare';
			ora = oraTipZi[0];
		};
		if (plSos == 'plecare') {
			$.each(b[7][oraTipZi[1]], function(k, oraObj) {
				if (ora <= oraObj[0]) {
					oraForReturn = oraObj;
					return false;
				};
			});
			if (oraForReturn) {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][0] = oraForReturn[0];
			};
		} else {
			$.each(b[7][oraTipZi[1]], function(k, oraObj) {
				if (oraObj[oraObj.length - 1] >= ora) {
					oraForReturn = oraObj;
					return false;
				};
			});
			if (oraForReturn) {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][0] = oraForReturn[oraForReturn.length - 1];
			};
		};
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][1] = plSos;
	};
	return oraForReturn;
};

function clickTabAutobuzRuta(nr, busesSelected) {
	clearRuteAutobuz();
	$(".rute_alternative a").attr("class", "ruta_alternativa");
	$(".rute_alternative a").eq(nr).attr("class", "ruta_alternativa_selected");
	if (!busesSelected) {
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr]['buses'], function(key, array) {
			busesSelected = key;
			return false;
		});
	};
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] = nr;
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr]['markers'][busesSelected], function(kk, marker) {
		marker.addTo(getFrame('iframe_harta').map);
	});
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr]['polys'][busesSelected], function(kk, poly) {
		poly.setStyle({
			color: pageVars[tipRuta]['orase'][idOrasSelected]['culori'][pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']]
		});
		poly.addTo(getFrame('iframe_harta').map);
	});
	getFrame('iframe_harta').setBounds(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr]['bounds'][busesSelected]);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] = nr;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['buses'] = busesSelected;
	writeDetaliiRutaAutobuz();
	updateInfoBox(nr);
	attachDivTop();
	setOra(getOraRuteAutobuz());
};

function prelucreazaRuteAutobuz(data) {
	refreshVarsPageVars();
	clearMarkersStatiiIncarcate();
	resetRuteAutobuz();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['dataFromAjax'] = data;
	var titlePolys = {};
	var titleTabsRute = {};
	var rutaSelected = -1;
	var busesSelected = "";
	$.each(data['rute'], function(keyRuta, ruta) {
		prevStation = 0;
		arrLinii = [];
		linii = [];
		if (rutaSelected == -1) {
			rutaSelected = keyRuta;
		};
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].push({});
		busCombinations = {};
		$.each(ruta['order'], function(keyStatie, idStatie) {
			if (linii.length > 0) {
				titlePolys[prevStation + '-' + idStatie] = [];
				$.each(linii, function(key, idLinie) {
					pageVars['generale']['pointsLinii'][prevStation + '-' + idLinie + '-' + idStatie] = getPuncteLinie(data, keyRuta, idLinie, prevStation, idStatie);
					titlePolys[prevStation + '-' + idStatie].push(data['linii'][idLinie]['n']);
				});
			};
			linii = [];
			if ($.isEmptyObject(ruta[idStatie]) == false) {
				$.each(ruta[idStatie], function(idLinie, arrayStatii) {
					linii.push(idLinie);
				});
				arrLinii.push(linii);
			};
			if (prevStation > 0 && $.isEmptyObject(ruta[prevStation])) {
				pageVars['generale']['pointsLinii'][prevStation + '-' + idStatie] = getPuncteLinie(data, keyRuta, 0, prevStation, idStatie);
				titlePolys[prevStation + '-' + idStatie] = [];
			};
			prevStation = idStatie;
		});
		xp = crossProduct(arrLinii);
		while (xp.next()) {
			xp.dos(busCombinations);
		};
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'] = {};
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['keysOrar'] = {};
		$.each(busCombinations, function(key, value) {
			idsLinii = key.split("-");
			titleTabsRute[key] = [];
			$.each(idsLinii, function(k, idLinie) {
				titleTabsRute[key].push(data['linii'][idLinie]['n']);
			});
			titleTabsRute[key] = titleTabsRute[key].join('+');
			prevStation = 0;
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key] = [];
			var keyOrar = [];
			if ($.isEmptyObject(ruta[ruta['order'][0]]) === false) {
				keyOrar.push(ruta['order'][0]);
			};
			$.each(ruta['order'], function(keyStatie, idStatie) {
				keyOrar.push(idStatie);
				if (keyStatie == 0) {
					if (data['statii'][idStatie]['gps'].length > 1) {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key].push([data['statii'][idStatie]['gps_sosea'], data['statii'][idStatie]['nume'] + '\n' + data['statii'][idStatie]['legaturi'], getFrame('iframe_harta').markerGreenNewA]);
						$.each(data['statii'][idStatie]['gps'], function(kk, vv) {
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key].push([data['statii'][idStatie]['gps'][kk], data['statii'][idStatie]['nume'] + '\n' + data['statii'][idStatie]['legaturi'], getFrame('iframe_harta').markerRedDotBig]);
						});
					} else {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key].push([data['statii'][idStatie]['gps'][0], data['statii'][idStatie]['nume'] + '\n' + data['statii'][idStatie]['legaturi'], getFrame('iframe_harta').markerGreenNewA]);
					};
				} else if (keyStatie == ruta['order'].length - 1) {
					if (data['statii'][idStatie]['gps'].length > 1) {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key].push([data['statii'][idStatie]['gps_sosea'], data['statii'][idStatie]['nume'] + '\n' + data['statii'][idStatie]['legaturi'], getFrame('iframe_harta').markerGreenNewB]);
						$.each(data['statii'][idStatie]['gps'], function(kk, vv) {
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key].push([data['statii'][idStatie]['gps'][kk], data['statii'][idStatie]['nume'] + '\n' + data['statii'][idStatie]['legaturi'], getFrame('iframe_harta').markerRedDotBig]);
						});
					} else {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key].push([data['statii'][idStatie]['gps'][0], data['statii'][idStatie]['nume'] + '\n' + data['statii'][idStatie]['legaturi'], getFrame('iframe_harta').markerGreenNewB]);
					};
				} else {
					if (data['statii'][idStatie]['gps'].length > 1) {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key].push([data['statii'][idStatie]['gps_sosea'], data['statii'][idStatie]['nume'] + '\n' + data['statii'][idStatie]['legaturi'], getFrame('iframe_harta').markerBlueDot]);
					} else {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key].push([data['statii'][idStatie]['gps'][0], data['statii'][idStatie]['nume'] + '\n' + data['statii'][idStatie]['legaturi'], getFrame('iframe_harta').markerBlueDot]);
					};
				};
				if (prevStation > 0 && $.isEmptyObject(ruta[prevStation])) {
					busCombinations[key].push([pageVars['generale']['pointsLinii'][prevStation + '-' + idStatie][0], pageVars['generale']['pointsLinii'][prevStation + '-' + idStatie][1], pageVars['generale']['pointsLinii'][prevStation + '-' + idStatie][2], (titlePolys[prevStation + '-' + idStatie].length == 0) ? "Merge" + String.fromCharCode(355) + "i pe jos " + String.fromCharCode(238) + "ntre sta" + String.fromCharCode(355) + "iile " + data['statii'][prevStation]['nume'] + " " + String.fromCharCode(351) + "i " + data['statii'][idStatie]['nume'] : "", 0]);
				};
				if ($.isEmptyObject(ruta[idStatie]) == false) {
					if (prevStation > 0 && $.isEmptyObject(ruta[prevStation]) === false) {
						keyOrar.push(idStatie);
					};
					$.each(ruta[idStatie], function(idLinie, arrayLinii) {
						if ($.inArray(idLinie, idsLinii) > -1) {
							keyOrar.push(idLinie);
							busCombinations[key].push([pageVars['generale']['pointsLinii'][idStatie + '-' + idLinie + '-' + ruta['order'][keyStatie + 1]][0], pageVars['generale']['pointsLinii'][idStatie + '-' + idLinie + '-' + ruta['order'][keyStatie + 1]][1], pageVars['generale']['pointsLinii'][idStatie + '-' + idLinie + '-' + ruta['order'][keyStatie + 1]][2], (titlePolys[idStatie + '-' + ruta['order'][keyStatie + 1]].length > 0) ? "Linii:\n" + titlePolys[idStatie + '-' + ruta['order'][keyStatie + 1]].join() + "\n" + String.fromCharCode(238) + "ntre sta" + String.fromCharCode(355) + "iile\n" + data['statii'][idStatie]['nume'] + " " + String.fromCharCode(351) + "i " + data['statii'][ruta['order'][keyStatie + 1]]['nume'] : "", pageVars['generale']['pointsLinii'][idStatie + '-' + idLinie + '-' + ruta['order'][keyStatie + 1]][4]]);
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key] = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key].concat(pageVars['generale']['pointsLinii'][idStatie + '-' + idLinie + '-' + ruta['order'][keyStatie + 1]][3]);
						};
					});
				};
				prevStation = idStatie;
			});
			if ($.isEmptyObject(ruta[ruta['order'][ruta['order'].length - 2]]) === false) {
				keyOrar.push(ruta['order'][ruta['order'].length - 1]);
			};
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['keysOrar'][key] = keyOrar;
		});
		prevStation = 0;
		arrLinii = [];
		linii = [];
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['buses'] = {};
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['polys'] = {};
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['bounds'] = {};
		$.each(busCombinations, function(key, value) {
			distantaTotala = 0, distantaPeJos = 0, timpTotal = 0, nrMijloace = 0, nrStatii = 0, vitezaMedie = 0, costTotal = 0, prevIdLinie = 0, minLat = null, minLng = null, maxLat = null, maxLng = null;
			if (busesSelected == "") {
				busesSelected = key;
			};
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['polys'][key] = [];
			$.each(value, function(k, v) {
				var vvv = [];
				$.each(v[1], function(kk, point) {
					if (!minLat) {
						minLat = point[0];
					} else {
						minLat = Math.min(minLat, point[0]);
					};
					if (!minLng) {
						minLng = point[1];
					} else {
						minLng = Math.min(minLng, point[1]);
					};
					if (!maxLat) {
						maxLat = point[0];
					} else {
						maxLat = Math.max(maxLat, point[0]);
					};
					if (!maxLng) {
						maxLng = point[1];
					} else {
						maxLng = Math.max(maxLng, point[1]);
					};
					vvv.push(getFrame('iframe_harta').getPoint(point[0], point[1]));
				});
				v[1] = vvv;
				distantaTotala += v[2];
				distantaPeJos += (v[0] == 0) ? v[2] : 0;
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['polys'][key].push(getFrame('iframe_harta').setPolyRutaAutobuz(v, true));
				if (v[0] > 0) {
					timpTotal += v[2] / data['linii'][v[0]]['v'];
					timpTotal += data['linii'][v[0]]['a'];
					nrMijloace++;
					nrStatii += v[4];
					timpTotal += (v[4] - 1) * data['linii'][v[0]]['o'];
					if (prevIdLinie == 0) {
						costTotal += data['linii'][v[0]]['c'];
					} else {
						if (data['linii'][prevIdLinie]['i'] == 4 && data['linii'][v[0]]['i'] == 4) {} else {
							costTotal += data['linii'][v[0]]['c'];
						};
					};
					prevIdLinie = v[0];
				};
			});
			timpTotal += distantaPeJos / pageVars['generale']['viteza_pe_jos_m_s'];
			vitezaMedie = distantaTotala / timpTotal;
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['buses'][key] = [distantaTotala, distantaPeJos, vitezaMedie, timpTotal, costTotal, nrMijloace, nrStatii, null];
			$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key], function(kk, marker) {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['markers'][key][kk] = getFrame('iframe_harta').setMarkerRutaAutobuz(marker, true);
			});
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][keyRuta]['bounds'][key] = getFrame('iframe_harta').getBounds([minLat, minLng], [maxLat, maxLng]);
			titleTabsRute[key] += ', ' + transformSecundeToText(timpTotal, 'simbol');
		});
	});
	searchToResultAutobuzeRute();
	$("#content_tab_ruta").append(createTaburiAutobuzeRuta(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length));
	
	//$("div.tabs_mobile").append(createTabRuteAlternativeMobile($(routes).length));
	//$("#tab_mobile_retur").html(pageVars.texte.string_retur_caps).attr({onclick:"clickTabRetur(this);"});
	
	$.each($(".rute_alternative a"), function(k, obj) {
		var bb = null;
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][k]['buses'], function(kk, array) {
			bb = kk;
			return false;
		});
		$(obj).attr("title", titleTabsRute[bb]);
	});
	pageVars['generale']['rutaAlternativa'].addTo(getFrame('iframe_harta').map);
	clickTabAutobuzRuta(rutaSelected, busesSelected);
	minLat = null;
	minLng = null;
	maxLat = null;
	maxLng = null;
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0].toString().indexOf('|') == -1) {
		var deLa = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0];
		if (!minLat || minLat > parseFloat(deLa[0])) {
			minLat = parseFloat(deLa[0]);
		};
		if (!maxLat || maxLat < parseFloat(deLa[0])) {
			maxLat = parseFloat(deLa[0]);
		};
		if (!minLng || minLng > parseFloat(deLa[1])) {
			minLng = parseFloat(deLa[1]);
		};
		if (!maxLng || maxLng < parseFloat(deLa[1])) {
			maxLng = parseFloat(deLa[1]);
		};
	} else {
		var deLa = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0].toString().split(',');
		var lat = deLa[0].split('|');
		$.each(lat, function(k, l) {
			if (!minLat || minLat > parseFloat(l)) {
				minLat = parseFloat(l);
			};
			if (!maxLat || maxLat < parseFloat(l)) {
				maxLat = parseFloat(l);
			};
		});
		var lng = deLa[1].split('|');
		$.each(lng, function(k, l) {
			if (!minLng || minLng > parseFloat(l)) {
				minLng = parseFloat(l);
			};
			if (!maxLng || maxLng < parseFloat(l)) {
				maxLng = parseFloat(l);
			};
		});
	};
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1].toString().indexOf('|') == -1) {
		var panaLa = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1];
		if (!minLat || minLat > parseFloat(panaLa[0])) {
			minLat = parseFloat(panaLa[0]);
		};
		if (!maxLat || maxLat < parseFloat(panaLa[0])) {
			maxLat = parseFloat(panaLa[0]);
		};
		if (!minLng || minLng > parseFloat(panaLa[1])) {
			minLng = parseFloat(panaLa[1]);
		};
		if (!maxLng || maxLng < parseFloat(panaLa[1])) {
			maxLng = parseFloat(panaLa[1]);
		};
	} else {
		var panaLa = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1].toString().split(',');
		var lat = panaLa[0].split('|');
		$.each(lat, function(k, l) {
			if (!minLat || minLat > parseFloat(l)) {
				minLat = parseFloat(l);
			};
			if (!maxLat || maxLat < parseFloat(l)) {
				maxLat = parseFloat(l);
			};
		});
		var lng = panaLa[1].split('|');
		$.each(lng, function(k, l) {
			if (!minLng || minLng > parseFloat(l)) {
				minLng = parseFloat(l);
			};
			if (!maxLng || maxLng < parseFloat(l)) {
				maxLng = parseFloat(l);
			};
		});
	};
	getTaxi([[minLat, minLng],[maxLat, maxLng]]);
	$(".rute_alternative").append(createTabReturRuta());
	$("#tab_mobile_retur").html(pageVars.texte.string_retur_caps).attr({onclick:"clickTabRetur(this);"});
};

function getRutaAutobuz(data, e) {
	refreshVarsPageVars();
	clearStradaObiectiv();
	mijloace = [];
	for (i = 0; i < pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ui'].length; i++) {
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ui'][i], function(key, value) {
			if (value[0] === true) {
				mijloace.push(key);
			};
		});
	};
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'rute_transport_in_comun',
			'i1': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][0],
			'i2': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][1],
			'g1': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0].join(),
			'g2': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][1].join(),
			'm': mijloace.join(),
			'io': idOrasSelected
		},
		success: function(d) {
			prelucreazaRuteAutobuz(dataRute);
			setHash(((idOrasSelected > 0) ? pageVars[tipRuta]['orase'][idOrasSelected]['url'] + '/' : "") + pageVars[tipRuta]['orase'][idOrasSelected]['url_sectiune'] + '/' + data['url'].join((history.pushState) ? '/' : '~'), e);
		},
		beforeSend: function() {}
	});
};

function getDistanta(data, e) {
	refreshVarsPageVars();
	clearStradaObiectiv();
	divTop = 'oras-oras';
	var poly;
	var marker;
	var path = [];
	var distanta = 0;
	var minLat = null;
	var maxLat = null;
	var minLng = null;
	var maxLng = null;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] = [{}];
	$.each(pageVars['generale']['markersLiniiDrepte'], function(key, value) {
		if (value) {
			value.remove();
		};
		if (pageVars['generale']['liniiDrepte'][key]) {
			pageVars['generale']['liniiDrepte'][key].remove();
		};
	});
	pageVars['generale']['liniiDrepte'] = [];
	pageVars['generale']['markersLiniiDrepte'] = [];
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'], function(key, value) {
		marker = getFrame('iframe_harta').returnMarkerLinieDreapta(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][1], key, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key]);
		pageVars['generale']['markersLiniiDrepte'].push(marker);
		if (minLat == null) {
			minLat = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][0];
		} else {
			minLat = Math.min(minLat, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][0]);
		};
		if (minLng == null) {
			minLng = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][1];
		} else {
			minLng = Math.min(minLng, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][1]);
		};
		if (maxLat == null) {
			maxLat = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][0];
		} else {
			maxLat = Math.max(maxLat, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][0]);
		};
		if (maxLng == null) {
			maxLng = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][1];
		} else {
			maxLng = Math.max(maxLng, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][1]);
		};
		if (key > 0) {
			poly = getFrame('iframe_harta').returnPolyLinieDreapta();
			var marker1 = getFrame('iframe_harta').getPoint(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key - 1][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key - 1][1]);
			var marker2 = getFrame('iframe_harta').getPoint(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][key][1]);
			path.push(marker1);
			path.push(marker2);
			poly.setLatLngs([path]);
			poly.indecsi = [key - 1, key];
			pageVars['generale']['liniiDrepte'].push(poly);
			distanta += marker1.distanceTo(marker2);
			path = [];
		};
	});
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results']['distanta'] = distanta;
	attachDivTop();
	getFrame('iframe_harta').setBounds(getFrame('iframe_harta').getBounds([minLat, minLng], [maxLat, maxLng]));
	marker = null;
	poly = null;
	minLat = null;
	minLng = null;
	maxLat = null;
	maxLng = null;
	setHash(((idOrasSelected > 0) ? pageVars[tipRuta]['orase'][idOrasSelected]['url'] + '/' : "") + pageVars[tipRuta]['orase'][idOrasSelected]['url_sectiune'] + '/' + data['url'].join((history.pushState) ? '/' : '~'), e);
};

function showMarker(pos) {
	pageVars['generale']['marker'].setLatLng(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['cotituri'][pos - 1][3]);
	pageVars['generale']['marker'].addTo(getFrame('iframe_harta').map);
};

function showMarkerPoint(pos) {
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['cotituri'][pos]) {
		pageVars['generale']['markerPoint'].setLatLng(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['cotituri'][pos][3]);
		pageVars['generale']['markerPoint'].addTo(getFrame('iframe_harta').map);
	};
};

function setPolyInside(p) {
	pageVars['generale']['lineInside'].setLatLngs(p);
	pageVars['generale']['lineInside'].addTo(getFrame('iframe_harta').map);
};

function searchToResultAutobuzeStatie() {
	showOptionsOnReturn = 0;
	divTop = 'oras-oras';
	if ($("#div_avansat").length > 0) {
		showOptionsOnReturn = 1;
	};
	$("#cautare_ruta_inner").remove();
	$("#div_avansat").remove();
	$("#content").remove();
	$('#main').append(createDivContent('rezultate-autobuze-statie'), createDivTabs(stabilesteTaburi()));
	attachDivTop();
	setTabSelected(0);
	$("div.tabs_mobile_statie, #sageata_top").show();
	$("div#sageata_top > img").attr({src:pathToImg+'arrow-up.png'});
	//$("div.tab_mobile").remove();
};

function changeOraOrarStatieAutobuz(ora) {
	$("#td_orar").html("");
	$("#td_orar").append(createEl("div", {
		'class': 'loading-orar'
	}, createEl("img", {
		'src': pathToImg + 'loading-cerc.gif'
	})));
	$("#td_orar div").append(createText(pageVars['texte']['asteptati'] + "..."));
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'orar_linii_autobuz',
			'is': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['id'],
			'il': $("#select_linii_orar").val(),
			'itz': $("#select_tip_zi_orar").val(),
			'o': ora
		},
		success: function(d) {
			prelucreazaOrarLinieAutobuz(ora, dataOrar);
		}
	});
};

function changeTipZiOrarStatieAutobuz(idLinie, tipZi, ora) {
	var okOra = 0;
	if (!ora) {
		var oz = getOraTipZi();
		if ($("#select_ore_orar option").length > 0) {
			var ora = $("#select_ore_orar").val();
		} else {
			var ora = oz[0];
		};
	};
	$("#select_ore_orar").empty();
	$("#td_orar").html("");
	$("#td_orar").append(createEl("div", {
		'class': 'loading-orar'
	}, createEl("img", {
		'src': pathToImg + 'loading-cerc.gif'
	})));
	$("#td_orar div").append(createText(pageVars['texte']['asteptati'] + "..."));
	$("#select_ore_orar").attr("onchange", "changeOraOrarStatieAutobuz(this.value);");
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['orar'][tipZi][1], function(key, nrOra) {
		$("#select_ore_orar").append(createEl("option", {
			'value': nrOra,
			'selected': (nrOra == ora) ? true : false
		}, pageVars['texte']['ora'] + ((nrOra < 10) ? "0" + nrOra : nrOra)));
		if (nrOra == ora) {
			okOra = 1;
		};
	});
	if (okOra == 0) {
		ora = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['orar'][tipZi][1][0];
	};
	changeOraOrarStatieAutobuz(ora);
};

function changeLinieOrarStatieAutobuz(idLinie) {
	$("#td_orar").html("");
	$("#td_orar").append(createEl("div", {
		'class': 'loading-orar'
	}, createEl("img", {
		'src': pathToImg + 'loading-cerc.gif'
	})));
	$("#td_orar div").append(createText(pageVars['texte']['asteptati'] + "..."));
	var oz = getOraTipZi();
	if ($("#select_tip_zi_orar option").length > 0) {
		var tipZi = $("#select_tip_zi_orar").val();
	} else {
		tipZi = oz[1];
	};
	if ($("#select_ore_orar option").length > 0) {
		var ora = $("#select_ore_orar").val();
	} else {
		ora = oz[0];
	};
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['orar'] != null) {
		$("#select_tip_zi_orar").empty();
		$("#select_ore_orar").empty();
		$("#select_tip_zi_orar").attr("onchange", "changeTipZiOrarStatieAutobuz(" + idLinie + ",this.value);");
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['orar'], function(idTipZi, dataTipZi) {
			$("#select_tip_zi_orar").append(createEl("option", {
				'value': idTipZi,
				'selected': (idTipZi == tipZi) ? true : false
			}, dataTipZi[0]));
		});
		changeTipZiOrarStatieAutobuz(idLinie, $("#select_tip_zi_orar").val(), ora);
	} else {
		$.ajax({
			url: '/inc/ajax.php',
			dataType: 'script',
			type: 'post',
			data: {
				'for': 'ore_linii_autobuz',
				'il': idLinie,
				'is': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['id']
			},
			success: function(d) {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['orar'] = dataOre;
				changeLinieOrarStatieAutobuz(idLinie);
			}
		});
	};
};

function prelucreazaStatieAutobuz(data) {
	clearMarkersStatiiIncarcate();
	if ($.isEmptyObject(data) == true) {
		showInfoAlert(pageVars['texte']['no_station']);
		$(".litera").attr("title", "");
		$(".litera").attr("src", pathToImg + "litere/s.png");
		$("#buton_vezi_directii").removeAttr("disabled");
		$("#buton_vezi_directii").val(pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['text_buton']]);
		$(".input-ruta").removeAttr("disabled");
		$(".input-ruta").val("");
		$(".div-input-ruta span").css("display", "block");
		return;
	};
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].unshift(data);
	autobuzStatieIsShown = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['id'];
	var center = getFrame("iframe_harta").getPoint(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['gps'][0][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['gps'][0][1]);
	getFrame("iframe_harta").map.setView(center,16);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['markers'] = {};
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['markers'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['id']] = [];
	$.each(data['gps'], function(key, value) {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['markers'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['id']].push(
			getFrame("iframe_harta").setMarker(
								[value[0],value[1]],
								getFrame('iframe_harta').markerGreen,
								pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['nume']
							).addTo(getFrame('iframe_harta').map)
		);
	});
	if (data['ex'] == 0) {
		$.each(data['statii'], function(idStatie, statie) {
			var markers = [];
			$.each(statie['gps'], function(key, coords) {
				var marker = getFrame("iframe_harta").setMarker([coords[0], coords[1]], getFrame('iframe_harta').markerRedDotSmall, statie['nume'] + '\n' + pageVars['texte']['legaturi'] + ': ' + statie['legaturi']);
				markers.push(marker);
			});
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii'][idStatie]['markers'] = markers;
		});
		$.each(data['linii'], function(key, linie) {
			var pathInainte = [];
			var minLat = null;
			var minLng = null;
			var maxLat = null;
			var maxLng = null;
			$.each(linie['polys_inainte'], function(k, coords) {
				pathInainte.push(getFrame("iframe_harta").getPoint(coords[0], coords[1]));
				if (!minLat || minLat > coords[0]) {
					minLat = coords[0];
				};
				if (!maxLat || maxLat < coords[0]) {
					maxLat = coords[0];
				};
				if (!minLng || minLng > coords[1]) {
					minLng = coords[1];
				};
				if (!maxLng || maxLng < coords[1]) {
					maxLng = coords[1];
				};
			});
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][key]['polys_inainte'] = getFrame("iframe_harta").getPolyLinieAutobuz(pathInainte, pageVars[tipRuta]['orase'][idOrasSelected]['culori'][pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']]);
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][key]['polys_inainte'].remove();
			var pathDupa = [];
			$.each(linie['polys_dupa'], function(k, coords) {
				pathDupa.push(getFrame("iframe_harta").getPoint(coords[0], coords[1]));
				if (!minLat || minLat > coords[0]) {
					minLat = coords[0];
				};
				if (!maxLat || maxLat < coords[0]) {
					maxLat = coords[0];
				};
				if (!minLng || minLng > coords[1]) {
					minLng = coords[1];
				};
				if (!maxLng || maxLng < coords[1]) {
					maxLng = coords[1];
				};
			});
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][key]['polys_dupa'] = getFrame("iframe_harta").getPolyLinieAutobuz(pathDupa, pageVars[tipRuta]['orase'][idOrasSelected]['culori'][nextColor()]);
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][key]['polys_dupa'].remove();
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][key]['bounds'] = [
				[minLat, minLng],
				[maxLat, maxLng]
			];
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][key]['ex'] = 1;
		});
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['ex'] = 1;
	};
	$.each(data['statii_apropiere'], function(idStatie, statie) {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['markers'] = [];
		if (statie['ex'] == 0) {
			var path = [];
			var minLat = null;
			var minLng = null;
			var maxLat = null;
			var maxLng = null;
			$.each(statie['puncte_gps'], function(key, coords) {
				path.push(getFrame("iframe_harta").getPoint(coords[0],coords[1]));
				if (path.length>1) {
					pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['distanta'] += path[key].distanceTo(path[key-1]);
				};
				if (!minLat || minLat > coords[0]) {
					minLat = coords[0];
				};
				if (!maxLat || maxLat < coords[0]) {
					maxLat = coords[0];
				};
				if (!minLng || minLng > coords[1]) {
					minLng = coords[1];
				};
				if (!maxLng || maxLng < coords[1]) {
					maxLng = coords[1];
				};
			});
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['puncte_gps'] = getFrame("iframe_harta").setPolyRutaAutobuz([0, path], true);
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['bounds'] = [
				[minLat, minLng],
				[maxLat, maxLng]
			];
			if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['distanta'] == 0) {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['distanta'] = 200;//getFrame('iframe_harta').google.maps.geometry.spherical.computeLength(path);
			};
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['ex'] = 1;
		};
		$.each(statie['gps'], function(key, coords) {
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['markers'].push(getFrame("iframe_harta").setMarker([coords[0], coords[1]], getFrame('iframe_harta').markerRedDot, statie['nume'] + '\n' + pageVars['texte']['legaturi'] + ': ' + statie['legaturi'] + '\n' + calculateDistanta(statie['distanta'], 1) + ' ' + pageVars['texte']['distanta']).addTo(getFrame('iframe_harta').map));
		});
	});
	searchToResultAutobuzeStatie();
	//$("#traseu").html(createTableAutobuzeStatie());
	
	$(".content_traseu").remove();
	$("#traseu, #table_instructiuni_statie").append(createTableAutobuzeStatie());
	$("#table_instructiuni_statie > div.content_traseu > div").removeProp("onclick");
	
	if ($.isEmptyObject(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['nr_mijloace_zilnic']) == true) {
		$("#tab_orar").remove();
		$("#content_tab_orar").remove();
		$("#content_tab_statie").height($("#content_tab_statie").height() + 65);
		$("#traseu").height($("#traseu").height() + 65);
		$("#detalii_statie tr:first > td:first").html(pageVars['texte']['linii_si_statii']);
	} else {
		$.each(data['ordine_linii'], function(key, idLinie) {
			var capatLinie = '';
			if (data['linii'][idLinie]['statii_dupa'].length > 0) {
				capatLinie = ' --> ' + data['statii'][data['linii'][idLinie]['statii_dupa'][data['linii'][idLinie]['statii_dupa'].length - 1]]['nume'];
			} else if (data['linii'][idLinie]['statii_inainte'].length > 0) {
				capatLinie = ' <-- ' + data['nume'];
			};
			$("#select_linii_orar").append(createEl("option", {
				'value': idLinie
			}, data['linii'][idLinie]['nume'] + capatLinie));
		});
		changeLinieOrarStatieAutobuz(data['ordine_linii'][0]);
	};
	setScrollRezultateNoImg();
	arataAutobuzeStatieLinie = 0;
	arataAutobuzeStatieTraseuMic = 0;
};

function getStatie(data, e) {
	refreshVarsPageVars();
	clearStradaObiectiv();
	var exista = 0;
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		hideAutobuzeLiniiStatie();
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'], function(key, result) {
			if (result['id'] == pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][0]) {
				prelucreazaStatieAutobuz(result);
				exista = 1;
			};
		});
	};
	if (exista == 0) {
		$.ajax({
			url: '/inc/ajax.php',
			dataType: 'script',
			type: 'post',
			data: {
				'for': 'statie_transport_in_comun',
				'i': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][0],
				'c': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0].join(),
				'io': idOrasSelected
			},
			success: function(d) {
				prelucreazaStatieAutobuz(dataStatie);
			},
			beforeSend: function() {}
		});
	};
	setHash(((idOrasSelected > 0) ? pageVars[tipRuta]['orase'][idOrasSelected]['url'] + '/' : "") + pageVars[tipRuta]['orase'][idOrasSelected]['url_sectiune'] + '/statia-' + data['url'].join((history.pushState) ? '/' : '~'), e);
};

function mouseOverRowLiniiStatie(obj, numeLinie) {
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'], function(idLinie, linie) {
		if (numeLinie == linie['nume']) {
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['polys_inainte'].addTo(getFrame("iframe_harta").map);
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['polys_dupa'].addTo(getFrame("iframe_harta").map);
			$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['statii_inainte'], function(key, idStatie) {
				$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii'][idStatie]['markers'], function(k, marker) {
					marker.addTo(getFrame("iframe_harta").map);
				});
			});
			$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['statii_dupa'], function(key, idStatie) {
				$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii'][idStatie]['markers'], function(k, marker) {
					marker.addTo(getFrame("iframe_harta").map);
				});
			});
		};
	});
	if (obj) {
		$(obj).css("color", "green");
	};
};

function mouseOutRowLiniiStatie(obj, numeLinie) {
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'], function(idLinie, linie) {
		if (linie['nume'] != arataAutobuzeStatieLinie) {
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['polys_inainte'].remove();
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['polys_dupa'].remove();
			$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['statii_inainte'], function(key, idStatie) {
				$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii'][idStatie]['markers'], function(k, marker) {
					marker.remove();
				});
			});
			$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][idLinie]['statii_dupa'], function(key, idStatie) {
				$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii'][idStatie]['markers'], function(k, marker) {
					marker.remove();
				});
			});
			if (arataAutobuzeStatieLinie) {
				$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'], function(id, l) {
					if (arataAutobuzeStatieLinie == l['nume']) {
						$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][id]['statii_inainte'], function(key, idS) {
							$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii'][idS]['markers'], function(k, m) {
								m.addTo(getFrame("iframe_harta").map);
							});
						});
						$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'][id]['statii_dupa'], function(key, idS) {
							$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii'][idS]['markers'], function(k, m) {
								m.addTo(getFrame("iframe_harta").map);
							});
						});
					};
				});
			};
		};
	});
	if (obj) {
		$(obj).css("color", "black");
	};
};

function clickRowLiniiStatie(obj, numeLinie) {
	hideAllAutobuzeLiniiStatie();
	var idLinieSelected = 0;
	if (arataAutobuzeStatieLinie != numeLinie) {
		var minLat = null;
		var minLng = null;
		var maxLat = null;
		var maxLng = null;
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['linii'], function(idLinie, linie) {
			if (numeLinie == linie['nume']) {
				if (!minLat || minLat > linie['bounds'][0][0]) {
					minLat = linie['bounds'][0][0];
				};
				if (!minLng || minLng > linie['bounds'][0][1]) {
					minLng = linie['bounds'][0][1];
				};
				if (!maxLat || maxLat < linie['bounds'][1][0]) {
					maxLat = linie['bounds'][1][0];
				};
				if (!maxLng || maxLng < linie['bounds'][1][1]) {
					maxLng = linie['bounds'][1][1];
				};
				idLinieSelected = idLinie;
			};
		});
		getFrame("iframe_harta").setBounds(getFrame("iframe_harta").getBounds([minLat, minLng], [maxLat, maxLng]));
		arataAutobuzeStatieLinie = numeLinie;
		$("#select_linii_orar").val(idLinieSelected);
		changeLinieOrarStatieAutobuz(idLinieSelected);
		mouseOverRowLiniiStatie(null, arataAutobuzeStatieLinie);
		$(obj).css("background-color", "orange");
		$(obj).children("td:eq(1)").css("color", "black");
	} else {
		arataAutobuzeStatieLinie = 0;
	};
	arataAutobuzeStatieTraseuMic = 0;
};

function mouseOverRowLiniiStatieApropiata(obj, idStatie) {
	if (obj) {
		$(obj).css("color", "green");
	};
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['puncte_gps'].addTo(getFrame('iframe_harta').map);
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['markers'], function(key, marker) {
		marker.setIcon(getFrame('iframe_harta').markerBlueDot);
	});
};

function mouseOutRowLiniiStatieApropiata(obj, idStatie) {
	if (obj) {
		$(obj).css("color", "black");
	};
	$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'], function(idStatie, statie) {
		if (arataAutobuzeStatieTraseuMic != idStatie) {
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['puncte_gps'].remove();
			$.each(statie['markers'], function(key, marker) {
				marker.setIcon(getFrame('iframe_harta').markerRedDot);
			});
		};
	});
};

function clickRowLiniiStatieApropiata(obj, idStatie) {
	hideAllAutobuzeLiniiStatie();
	if (arataAutobuzeStatieTraseuMic != idStatie) {
		getFrame("iframe_harta").setBounds(getFrame("iframe_harta").getBounds(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['bounds'][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['statii_apropiere'][idStatie]['bounds'][1]));
		arataAutobuzeStatieTraseuMic = idStatie;
		mouseOverRowLiniiStatieApropiata(null, arataAutobuzeStatieTraseuMic);
		$(obj).css("background-color", "orange");
	} else {
		arataAutobuzeStatieTraseuMic = 0;
	};
	arataAutobuzeStatieLinie = 0;
};

function showRuteAutobuz() {
	for (var i = 0; i < pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length; i++) {
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][i]['polys'], function(buses, polys) {
			for (var j = 0; j < polys.length; j++) {
				polys[j].addTo(getFrame('iframe_harta').map);
			};
		});
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][i]['markers'], function(buses, markers) {
			for (var j = 0; j < markers.length; j++) {
				markers[j].addTo(getFrame('iframe_harta').map);
			};
		});
	};
};

function cleanMap(tip, tipCautare) {
	if (tipRuta == 'auto' || tipRuta == 'pe-jos' || tipRuta == 'bicicleta') {
		if (pageVars['generale']['directionsDisplay'][tipRuta] && pageVars[tipRuta]['orase'][pageVars[tipRuta]['id_oras_selected']]['rute']['results'].length > 0) {
			pageVars['generale']['directionsDisplay'][tipRuta].remove();
		};
	} else if (tipRuta == 'autobuz') {
		if (tip && tipCautare) {
			if (tipRuta != tip || (tipRuta == tip && pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare'][moduriCautareSelected] != tipCautare)) {
				if (pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare'][moduriCautareSelected] == 'rute') {
					resetRuteAutobuz();
				} else if (pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare'][moduriCautareSelected] == 'linii') {
					hideAutobuzeLinie();
				} else if (pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare'][moduriCautareSelected] == 'statii') {
					hideAutobuzeLiniiStatie();
				};
			};
		} else {
			if (pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare'][moduriCautareSelected] == 'rute') {
				resetRuteAutobuz();
			} else if (pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare'][moduriCautareSelected] == 'linii') {
				hideAutobuzeLinie();
			} else if (pageVars[tipRuta]['orase'][idOrasSelected]['moduri_cautare'][moduriCautareSelected] == 'statii') {
				hideAutobuzeLiniiStatie();
			};
		};
	} else if (tipRuta == 'linie-dreapta' && tip != 'linie-dreapta') {
		if (pageVars['linie-dreapta']['orase'][pageVars['linie-dreapta']['id_oras_selected']]['rute']['results'].length > 0) {
			$.each(pageVars['generale']['markersLiniiDrepte'], function(key, value) {
				if (value) {
					value.remove();
				};
				if (pageVars['generale']['liniiDrepte'][key]) {
					pageVars['generale']['liniiDrepte'][key].remove();
				};
			});
		};
	};
};

function setZoomCenter(zoom, center) {
	getFrame('iframe_harta').map.setView(center,zoom);
};

function restoreMapObiectiv() {
	getFrame('iframe_harta').map.fitBounds(boundsOras);
	getFrame('iframe_harta').map.setView(centerOras,getFrame('iframe_harta').map.getZoom()+2);
};

function cautaObiectiv(obiectiv) {
	pageVars['generale']['geocoder'].geocode('address',obiectiv,function(results, status) {
		if (status == "OK") {
			prepareBeforeObiectiv();
			if (boundsOras.contains(getFrame('iframe_harta').L.latLng(results[0].lat,results[0].lon)) == false) {
				cautaObiectiv(obiectiv + ',' + oras);
				return;
			};
			if (centerOras.equals(getFrame('iframe_harta').L.latLng(results[0].lat,results[0].lon))) {
				showInfoAlert(pageVars['texte']['error_strada_obiectiv']['ZERO_RESULTS']);
				$("#input_strada_obiectiv").focus();
				$("#input_strada_obiectiv").select();
				restoreMapObiectiv();
				return;
			};
			getFrame('iframe_harta').map.fitBounds(getFrame('iframe_harta').L.latLngBounds(getFrame('iframe_harta').L.latLng(results[0].boundingbox[0], results[0].boundingbox[2]),getFrame('iframe_harta').L.latLng(results[0].boundingbox[1], results[0].boundingbox[3])));
			pageVars['generale']['oras']['markerStradaObiectiv'].setLatLng(getFrame('iframe_harta').L.latLng(results[0].lat, results[0].lon));
			pageVars['generale']['oras']['markerStradaObiectiv'].title = results[0].display_name;
			pageVars['generale']['oras']['markerStradaObiectiv'].addTo(getFrame('iframe_harta').map);
			pageVars['generale']['oras']['markerStradaObiectiv'].on({
				click: function () {showInfoWindowStradaObiectiv(results,pageVars['generale']['oras']['markerStradaObiectiv']);}
			});
			getFrame('iframe_harta').map.setView(getFrame('iframe_harta').L.latLng(results[0].lat, results[0].lon),getFrame('iframe_harta').map.getZoom());
			showInfoWindowStradaObiectiv(results,pageVars['generale']['oras']['markerStradaObiectiv']);
		};
		$("#input_strada_obiectiv").focus();
		$("#input_strada_obiectiv").select();
	});
};

function showInfoWindowStradaObiectiv(results,marker) {
	marker.bindPopup(pageVars['generale']['oras']['infoWindowStradaObiectiv']).openPopup();
	pageVars['generale']['oras']['infoWindowStradaObiectiv']
		.setContent(createContentInfoWindowStradaObiectiv(results[0].display_name.replace(', ' + oras, '').replace(', ' + pageVars['generale']['nume_tara'], ''), results[0].display_name))
		.openOn(getFrame('iframe_harta').map);
};

function clickUnitatiMasura(obj) {
	$.each(pageVars['generale']['unitati_masura_distante'], function(key, value) {
		if ($(obj).val() == value[2]) {
			pageVars['generale']['default_um'] = key;
			$.cookie('unitati_masura', key, {
				expires: 30,
				path: '/'
			});
		};
	});
	$("#consum_selector_optiuni").html(returnNumberWithDecimals(calculateVolumCarburant()) + ' ' + pageVars['generale']['unitati_masura_volum'][pageVars['generale']['default_um']][1] + '/100 ' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][1]);
	pageVars['generale']['select_on_map_active'] = -1;
	if (tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		$("#km").html(calculateDistanta(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results']['distanta']));
	} else if (tipRuta == 'auto' || tipRuta == 'pe-jos' || tipRuta == 'bicicleta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] > -1) {
		$("#km").html(calculateDistanta(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['distanta']));
	};
	resolveImgsLeftInputs();
	var rutaTrasata = 'NU';
	if (pageVars[tipRuta]['google'] && pageVars['generale']['directionsDisplay'][tipRuta] && pageVars['generale']['directionsDisplay'][tipRuta].polylineOptions) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'autobuz' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
};

function clickSelectOrasCautareAutobuz() {
	refreshVarsPageVars();
	if ($("#div-container").is(":visible")) {
		return;
	};
	removeDivsInfo();
	var content = '';
	var oraseSelect = [];
	var aranjamente = [
		[1, 1],
		[2, 1],
		[3, 1],
		[4, 1],
		[5, 1],
		[6, 1],
		[7, 1],
		[4, 2],
		[5, 2],
		[5, 2],
		[6, 2],
		[4, 3],
		[5, 3],
		[5, 3],
		[5, 3],
		[4, 4],
		[5, 4],
		[5, 4],
		[5, 4],
		[5, 4],
		[7, 3],
		[6, 4],
		[6, 4],
		[6, 4],
		[5, 5],
		[6, 5],
		[6, 5],
		[6, 5],
		[6, 5],
		[6, 5],
		[7, 5],
		[7, 5],
		[7, 5],
		[7, 5],
		[7, 5],
		[8, 5],
		[8, 5],
		[8, 5],
		[8, 5],
		[8, 5],
		[9, 5],
		[9, 5],
		[9, 5],
		[9, 5],
		[9, 5],
		[10, 5],
		[10, 5],
		[10, 5],
		[10, 5],
		[10, 5]
	];
	$.each(pageVars[tipRuta]['orase'], function(idOras, arrayOras) {
		oraseSelect.push(new Array(idOras, arrayOras['nume']));
	});
	nrOrase = 0;
	for (i = 0; i < aranjamente[pageVars[tipRuta]['ordine_orase'].length - 1][1]; i++) {
		content += '<div style="float: left;' + ((i > 0) ? ' margin-left: 20px;' : '') + '">';
		for (j = 0; j < aranjamente[pageVars[tipRuta]['ordine_orase'].length - 1][0]; j++) {
			if (pageVars[tipRuta]['ordine_orase'][nrOrase] && pageVars[tipRuta]['orase'][pageVars[tipRuta]['ordine_orase'][nrOrase]]) {
				content += '<span onclick="clickOrasCautareAutobuz(' + pageVars[tipRuta]['ordine_orase'][nrOrase] + ');" style="' + ((pageVars[tipRuta]['ordine_orase'][nrOrase] == idOrasSelected) ? 'color: red;' : '') + '">' + pageVars[tipRuta]['orase'][pageVars[tipRuta]['ordine_orase'][nrOrase]]['nume'] + '</span><br />';
				nrOrase += 1;
			} else {
				break;
			};
		};
		content += '</div>';
	};
	pos = $("#cautare_ruta_inner").offset();
	$("#main").append(createDivArrow('sus', content, [pos.top + $("#cautare_ruta_inner").height() + Math.round(pageVars['generale']['dimensiuni_container']['sus']['arrow'][0] / 3), pos.left - 180]));
	if ($.inArray(['div-container', 'remove', true], pageVars['generale']['id_div_for_hidden']) == -1) {
		pageVars['generale']['id_div_for_hidden'].push(['div-container', 'remove', true]);
	};
	pageVars['generale']['select_on_map_active'] = -1;
	resolveImgsLeftInputs();
};

function prelucreazaGeo(objFor, textPageVars, type) {
	var numePointGeocoded = '';
	refreshVarsPageVars();
	indexObjFor = (pageVars['generale']['select_on_map_active'] >= 0) ? pageVars['generale']['select_on_map_active'] : $.inArray(objFor, $(".input-ruta"));
	if ($.isEmptyObject(pageVars['generale']['geocoding'][textPageVars])) {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][indexObjFor] = 0;
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][indexObjFor] = [0, 0];
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexObjFor] = '';
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][indexObjFor] = '';
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['markersVarsInputs'][indexObjFor] = '';
		if (type == 'input') {
			$(objFor).trigger('focus');
		};
		resolveImgsLeftInputs();
	} else {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][indexObjFor] = 0;
		if (typeof textPageVars == "object") {
			
			numePointGeocoded = pageVars['generale']['geocoding'][textPageVars].namedetails.name || pageVars['generale']['geocoding'][textPageVars].namedetails.ref || '';
			
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][indexObjFor] = [textPageVars.lat,textPageVars.lng];
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexObjFor] = numePointGeocoded;
		} else if (typeof textPageVars == "string") {
			
			numePointGeocoded = pageVars['generale']['geocoding'][textPageVars][0].namedetails.name || pageVars['generale']['geocoding'][textPageVars][0].namedetails.ref || '';
			
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][indexObjFor] = [parseFloat(pageVars['generale']['geocoding'][textPageVars][0].lat), parseFloat(pageVars['generale']['geocoding'][textPageVars][0].lon)];
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexObjFor] = numePointGeocoded;
		};
		
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][indexObjFor] = '';
		if (pageVars['generale']['select_on_map_active'] >= 0) {
			if (typeof textPageVars == "object") {
				$(objFor).val(pageVars['generale']['geocoding'][textPageVars].display_name.replace(", " + pageVars['generale']['nume_tara'], ''));
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObjFor] = pageVars['generale']['geocoding'][textPageVars].display_name.replace(", " + pageVars['generale']['nume_tara'], '');
				pageVars['generale']['geocoding'][pageVars['generale']['geocoding'][textPageVars].display_name.replace(", " + pageVars['generale']['nume_tara'], '')] = pageVars['generale']['geocoding'][textPageVars];
			} else if (typeof textPageVars == "string") {
				$(objFor).val(pageVars['generale']['geocoding'][textPageVars][0].display_name.replace(", " + pageVars['generale']['nume_tara'], ''));
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObjFor] = pageVars['generale']['geocoding'][textPageVars][0].display_name.replace(", " + pageVars['generale']['nume_tara'], '');
				pageVars['generale']['geocoding'][pageVars['generale']['geocoding'][textPageVars][0].display_name.replace(", " + pageVars['generale']['nume_tara'], '')] = pageVars['generale']['geocoding'][textPageVars];
			};
			
			$(objFor).parent().children("span").hide();
			$(objFor).css({
				'color': ''
			});
			pageVars['generale']['select_on_map_active'] = -1;
			if (tipRuta == 'linie-dreapta') {
				resolveImgsLeftInputs();
			};
			clickVeziDirectii(objFor);
		};
	};
};

function getIconName(instr, i) {
	switch (instr.type) {
		case 'Head':
			if (i === 0) {
				return 'depart';
			};
			break;
		case 'WaypointReached':
			return 'via';
		case 'Roundabout':
			return 'enter-roundabout';
		case 'DestinationReached':
			return 'arrive';
	};
	switch (instr.modifier) {
		case 'Straight':
			return 'continue';
		case 'SlightRight':
			return 'bear-right';
		case 'Right':
			return 'turn-right';
		case 'SharpRight':
			return 'sharp-right';
		case 'TurnAround':
		case 'Uturn':
			return 'u-turn';
		case 'SharpLeft':
			return 'sharp-left';
		case 'Left':
			return 'turn-left';
		case 'SlightLeft':
			return 'bear-left';
	};
};

function prelucreazaRuta(ruta, idRuta) {
	var instructiune = controlOptions.formatter.formatInstruction(ruta.instructions[0]);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].push([]);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta] = {
		'polys': [],
		'info': {},
		'markers': [],
		'bounds': null,
		'cotituri': [],
		'minMax': [
			[null, null],
			[null, null]
		]
	};
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['copyright'] = pageVars['texte']['copyright'];
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['bounds'] = getFrame('iframe_harta').L.latLngBounds(ruta.coordinates);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['distanta'] = ruta.summary.totalDistance;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['durata'] = ruta.summary.totalTime;
	
	$.each(ruta.instructions,function(k,v){
		var stepPath = [];
		if (k<ruta.instructions.length-1) {
			for (var i=v.index; i<ruta.instructions[k+1].index; i++) {
				stepPath.push(ruta.coordinates[i]);
				
				if (tipRuta == 'auto') {
					if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][0] == null || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][0] > ruta.coordinates[i].lat) {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][0] = ruta.coordinates[i].lat;
					};
					if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][1] == null || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][1] > ruta.coordinates[i].lng) {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][1] = ruta.coordinates[i].lng;
					};
					if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][0] == null || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][0] < ruta.coordinates[i].lat) {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][0] = ruta.coordinates[i].lat;
					};
					if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][1] == null || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][1] < ruta.coordinates[i].lng) {
						pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][1] = ruta.coordinates[i].lng;
					};
				};
			};
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['cotituri'].push(
				['cot', calculateDistanta(v.distance), controlOptions.formatter.formatInstruction(v), ruta.coordinates[v.index], ruta.coordinates[ruta.instructions[k+1].index], stepPath, getIconName(v,k)]
			);
		};
		if (k==ruta.instructions.length-1) {
			// ati ajuns la destinatie
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['cotituri'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['cotituri'].length-1][2] += ",<br />"+pageVars['texte']['ati_ajuns'];
		};
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['polys'] = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['polys'].concat(stepPath);
	});
	if (tipRuta == 'bicicleta') {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['durata'] = Math.round(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['distanta'] / pageVars['generale']['viteza_bicicleta_m_s']);
	};
	if (tipRuta == 'pe-jos') {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['durata'] = Math.round(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['distanta'] / pageVars['generale']['viteza_pieton_m_s']);
	};
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][0] == null || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][1] == null || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][0] == null || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][1] == null) {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][0] = Math.min(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][0]);
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][0][1] = Math.min(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][1], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][1]);
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][0] = Math.max(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][0], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][0]);
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['minMax'][1][1] = Math.max(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0][1], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length - 1][1]);
	};
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['viteza'] = calculateViteza(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['distanta'], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['durata']);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['consum'] = calculateConsumTotal(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['distanta']);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['cost'] = calculateCost(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['distanta']) + ' ' + pageVars['texte']['moneda'];
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['distanta_text'] = calculateDistanta(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['distanta']);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['durata_text'] = transformSecundeToText(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['info']['durata'], 'simbol');
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['polys'] = getFrame('iframe_harta').setPolyServer(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][idRuta]['polys'], true);
};

function geocode(latLng, type) {
	pageVars['generale']['geocoding'][latLng] = 'pending';
	pageVars['generale']['geocoder'].geocode(type,latLng,function(res, status) {
		if (status == "OK") {
			pageVars['generale']['geocoding'][latLng] = res;
		} else {
			pageVars['generale']['geocoding'][latLng] = {};
		};
	});
};

function prelucreazaWayPoint(indexVars, latLng) {
	geocode(latLng, 'latLng');
	(function g() {
		window.setTimeout(function() {
			if ($.isEmptyObject(pageVars['generale']['geocoding'][latLng])) {
				$(".input-ruta").eq(indexVars).val(latLng.lat+latLng.lng);
			} else if (pageVars['generale']['geocoding'][latLng] != 'pending') {
				var text = pageVars['generale']['geocoding'][latLng].display_name.replace(", " + pageVars['generale']['nume_tara'], '');
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexVars] = text;
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexVars] = text;
				$(".input-ruta").eq(indexVars).val(text);
				
				// aici vedem daca e primul sau ultimul index, sa-i facem update pe-acolo
				if (indexVars==0) {
					// e primul input
					$("#plecare, #div_plecare").html(shorterString(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexVars], pageVars['generale']['limit_caractere_ruta']));
					$("#plecare").attr("title", pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexVars]);
					$("#div_plecare").attr("title",pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexVars]+": "+pageVars['texte']['click_derulare_ruta']);
					if (pageVars.blablacar.map == 1 && tipRuta == 'auto') {bannerBla.remove();bannerBla.update(prepareVarsBlaBlaMap());$("body").append(bannerBla.create());bannerBla.start();};
				} else if (indexVars == nrWaypoints-1) {
					// e ultimul input
					$("#sosire, #div_sosire").html(shorterString(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexVars], pageVars['generale']['limit_caractere_ruta']));
					$("#sosire").attr("title", pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexVars]);
					$("#div_sosire").attr("title",pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexVars]+": "+pageVars['texte']['click_derulare_ruta']);
					if (pageVars.blablacar.map == 1 && tipRuta == 'auto') {bannerBla.remove();bannerBla.update(prepareVarsBlaBlaMap());$("body").append(bannerBla.create());bannerBla.start();};
				};
				
				if (tipRuta == 'linie-dreapta') {
					$("#plecare").html(shorterString(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][0], pageVars['generale']['limit_caractere_ruta']));
					$("#sosire").html(shorterString(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'].length - 1], pageVars['generale']['limit_caractere_ruta']));
					$("#plecare").attr("title", pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][0]);
					$("#sosire").attr("title", pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'].length - 1]);
					resolveImgsLeftInputs();
				};
			} else if ($.isEmptyObject(pageVars['generale']['geocoding'][latLng])) {
				$(".input-ruta").eq(indexVars).val(latLng.lat+latLng.lng);
			} else {
				g();
			};
		}, 50);
	})();
};

function newVars(nr){
	var varsInputs = [];
	var idsVarsInputs = [];
	var coordVarsInputs = [];
	var textCoordVarsInputs = [];
	var urlsVarsInputs = [];
	var ok;
	nrWaypoints=rute[nr-1].inputWaypoints.length;
	for (var j=0; j<rute[nr-1].inputWaypoints.length; j++) {
		ok=0;
		for (var i=0; i<pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length; i++) {
			point = getFrame('iframe_harta').getPoint(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][i]);
			egal = rute[nr-1].inputWaypoints[j].latLng.equals(
					point,
					1.0E-3
				);
			
			if (egal) {
				varsInputs[j] = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][i];
				idsVarsInputs[j] = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][i];
				coordVarsInputs[j] = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][i];
				textCoordVarsInputs[j] = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][i];
				urlsVarsInputs[j] = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][i];
				
				ok=1;
			};
		};
		if (ok==0) {
			varsInputs[j] = rute[nr-1].inputWaypoints[j].latLng.lat+","+rute[nr-1].inputWaypoints[j].latLng.lng;
			idsVarsInputs[j] = 0;
			coordVarsInputs[j] = [rute[nr-1].inputWaypoints[j].latLng.lat, rute[nr-1].inputWaypoints[j].latLng.lng];
			textCoordVarsInputs[j] = rute[nr-1].inputWaypoints[j].latLng.lat+", "+rute[nr-1].inputWaypoints[j].latLng.lng;
			urlsVarsInputs[j] = rute[nr-1].inputWaypoints[j].latLng.lat+","+rute[nr-1].inputWaypoints[j].latLng.lng;
			prelucreazaWayPoint(j,rute[nr-1].inputWaypoints[j].latLng);
		};
	};
	
	$("#div_plecare").html(shorterString(varsInputs[0], pageVars['generale']['limit_caractere_ruta']));
	$("#div_plecare").attr("title", varsInputs[0] + pageVars['texte']['click_derulare_ruta']);
	
	$("#div_sosire").html(shorterString(varsInputs[varsInputs.length-1], pageVars['generale']['limit_caractere_ruta']));
	$("#div_sosire").attr("title", varsInputs[varsInputs.length-1] + pageVars['texte']['click_derulare_ruta']);
	
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'] = varsInputs;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'] = idsVarsInputs;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'] = coordVarsInputs;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'] = textCoordVarsInputs;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'] = urlsVarsInputs;
	
	if (pageVars.blablacar.map == 1 && tipRuta == 'auto') {bannerBla.remove();bannerBla.update(prepareVarsBlaBlaMap());$("body").append(bannerBla.create());bannerBla.start();};
	
	data['url'] = [];
	for (var i = 0; i < idsVarsInputs.length; i++) {
		if (idsVarsInputs[i] == 0) {
			data['url'].push(cutCoords(coordVarsInputs[i][0]) + ',' + cutCoords(coordVarsInputs[i][1]));
		} else {
			data['url'].push(urlsVarsInputs[i]);
		};
	};
};

function clickTabRutaServer(obj, nr, nrRuteGasite) {
	if ($(obj).hasClass("tab_mobile")) {
		// e pe mobil
		$(obj).parent().children("div.tab_mobile").removeClass("ruta_mobile_selected");
		$(obj).addClass("ruta_mobile_selected");
	} else {
		// e pe desktop
		$(obj).parent().children("a").attr("class", "ruta_alternativa");
		if (nrRuteGasite > 1) {
			$(obj).attr("class", "ruta_alternativa_selected");
		};
	};
	newVars(nr);
	
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] = nr - 1;
	
	control.fire('routeselected', {route: rute[nr-1], alternatives: rute.slice()});
	
	pageVars['generale']['rutaAlternativa'].setLatLngs(new Array());
	pageVars['generale']['infoWindow'].closePopup();
	hideMarkerVisible();
	hideMarker();
	hideMarkerPoint();
	hidePolyInside();
	$(".content_traseu").remove();
	$("#traseu, #table_instructiuni").append(createContentTraseu());
	$("#table_instructiuni > div.content_traseu > div").removeProp("onclick");
	$(".content_traseu").append(createEl("div", {
		'class': 'div_copyright'
	}, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['copyright']));
	var distanta = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['distanta'];
	if (tipRuta == 'auto' && distanta >= 50000 && distanta < 900000 && pageVars.blablacar.active == 1) {
		//$(".content_traseu").prepend(createTabDetaliiBlaBlaCar());
		//updateBlaBlaCar(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['info']['distanta']);
	};
	attachDivTop();
	updateConsum(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'], 0);
	setHash(((idOrasSelected > 0) ? pageVars[tipRuta]['orase'][idOrasSelected]['url'] + '/' : "") + pageVars[tipRuta]['orase'][idOrasSelected]['url_sectiune'] + '/' + data['url'].join((history.pushState) ? '/' : '~'));
	getTaxi(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr - 1]['minMax']);
	pageVars['generale']['rutaGoogleInProcess'] = 0;
	setScrollRezultate();
	setScrollRezultateNoImg();
};

function processRuta(routes,waypoints,type,target,drag) {
	rute = routes;
	$.each(routes, function(key, ruta) {
		prelucreazaRuta(ruta, key);
	});
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] = 0;
	searchToResult();
	pageVars['generale']['rutaAlternativa'].addTo(getFrame('iframe_harta').map);
	$("#content_tab_ruta").append(createTabRuteAlternative($(routes).length));
	$(".rute_alternative").append(createTabReturRuta());
	$("div.tabs_mobile").append(createTabRuteAlternativeMobile($(routes).length));
	$("#tab_mobile_retur").html(pageVars.texte.string_retur_caps).attr({onclick:"clickTabRetur(this);"});
	if (drag == 0) {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0] = [routes[0].coordinates[0].lat, routes[0].coordinates[0].lng];
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length-1] = [routes[0].coordinates[routes[0].coordinates.length-1].lat, routes[0].coordinates[routes[0].coordinates.length-1].lng];
	};
	clickTabRutaServer($(".rute_alternative > a").eq(0), pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] + 1, routes.length);
	
	/* if (tipRuta == 'auto' && typeof ajaxStatistici[pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][0]+'-'+pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length-1]] == 'undefined') {
		
		if (pageVars.blablacar.map == 1) {
			bannerBla.remove();
			bannerBla.update(prepareVarsBlaBlaMap());
			$("body").append(bannerBla.create());
			bannerBla.start();
		};
		$.ajax({
			url: '/inc/ajax.php',
			dataType: 'script',
			type: 'post',
			data: {
				'for': 'statistici_auto',
				'loc_1': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][0],
				'loc_2': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length-1],
				'gps_1': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][0].join(),
				'gps_2': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].length-1].join(),
				'durata': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['info']['durata'],
				'distanta': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['info']['distanta'],
				'cost': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['info']['cost']
			},
			success: function (d) {}
		});
		ajaxStatistici[pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][0]+'-'+pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length-1]] = 1;
		
	}; */
	getFrame('iframe_harta').drag=1;
};

function prepareVarsBlaBlaMap(){
	var waypoints=new Array();
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length>2) {
		for (var i=1; i<pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length-1; i++) {
			waypoints.push(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][i]);
		};
	};
	var valoriBannerBla = {
		"orase": [
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][0],
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length-1]
		],
		"suma": parseInt(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['info']['cost'].replace(" RON","")),
		"waypoints":waypoints
	};
	return valoriBannerBla;
};

function clickTabRetur(obj) {
	$(obj).removeAttr("onclick");
	$(obj).html(pageVars['texte']['asteptati'] + "..");
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['markersVarsInputs'].reverse();
	if (tipRuta == 'auto' || tipRuta == 'pe-jos' || tipRuta == 'bicicleta') {
		getRutaServer(getStatusInputs(false), tipRuta, false);
	} else if (tipRuta == 'autobuz') {
		getRutaAutobuz(getStatusInputs(false), false);
	};
};

function modifyOrarRutaAutobuz(plusMinus, plecareSosire) {
	var ora = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][0];
	var plSos = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][1];
	var oraTipZi = getOraTipZi();
	var orar = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['buses'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['buses']][7][oraTipZi[1]];
	var keyOraExistenta;
	$.each(orar, function(k, arrayOrar) {
		if (plSos == 'plecare') {
			if (arrayOrar[0] == ora) {
				keyOraExistenta = k;
				return false;
			};
		} else {
			if (arrayOrar[arrayOrar.length - 1] == ora) {
				keyOraExistenta = k;
				return false;
			};
		};
	});
	if (plusMinus == 'plus') {
		if (orar[keyOraExistenta + 1]) {
			var z = (plecareSosire == 'plecare') ? 0 : orar[keyOraExistenta + 1].length - 1;
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][0] = orar[keyOraExistenta + 1][z];
		} else {
			if (plecareSosire == 'plecare' && plSos == 'sosire') {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][0] = orar[keyOraExistenta][0];
			} else if (plecareSosire == 'sosire' && plSos == 'plecare') {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][0] = orar[keyOraExistenta][orar[keyOraExistenta].length - 1];
			};
		};
	} else {
		if (orar[keyOraExistenta - 1]) {
			var z = (plecareSosire == 'plecare') ? 0 : orar[keyOraExistenta - 1].length - 1;
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][0] = orar[keyOraExistenta - 1][z];
		} else {
			if (plecareSosire == 'plecare' && plSos == 'sosire') {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][0] = orar[keyOraExistenta][0];
			} else if (plecareSosire == 'sosire' && plSos == 'plecare') {
				pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][0] = orar[keyOraExistenta][orar[keyOraExistenta].length - 1];
			};
		};
	};
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][1] = plecareSosire;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['ora_selectata_user'][2] = 1;
	setOra(getOraRuteAutobuz());
};

function clickCotRutaAutobuz(obj, stringIds) {
	var minLat = null;
	var minLng = null;
	var maxLat = null;
	var maxLng = null;
	$.each(pageVars['generale']['pointsLinii'][stringIds][1], function(key, value) {
		if (!minLat || minLat > value[0]) {
			minLat = value[0];
		};
		if (!minLng || minLng > value[1]) {
			minLng = value[1];
		};
		if (!maxLat || maxLat < value[0]) {
			maxLat = value[0];
		};
		if (!maxLng || maxLng < value[1]) {
			maxLng = value[1];
		};
	});
	getFrame('iframe_harta').setBounds(getFrame('iframe_harta').getBounds([minLat, minLng], [maxLat, maxLng]));
};

function mouseOverTabAutobuzRuta(obj, nr) {
	$(obj).parent().children("a").attr("class", "ruta_alternativa");
	$(obj).attr("class", "ruta_alternativa_selected");
	var busesSelected = null;
	if (nr != pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']) {
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr]['buses'], function(b, object) {
			if (!busesSelected) {
				busesSelected = b;
				return false;
			};
		});
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr]['polys'][busesSelected], function(key, poly) {
			poly.addTo(getFrame('iframe_harta').map);
			poly.setStyle({
				color: pageVars[tipRuta]['orase'][idOrasSelected]['culori'][nextColor()]
			});
		});
	};
	updateInfoBox(nr);
};

function mouseOutTabAutobuzRuta(obj, nr) {
	$(obj).parent().children("a").attr("class", "ruta_alternativa");
	$(obj).parent().children("a:nth-child(" + (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected'] + 1) + ")").attr("class", "ruta_alternativa_selected");
	var busesSelected = null;
	if (nr != pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']) {
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr]['buses'], function(b, object) {
			if (!busesSelected) {
				busesSelected = b;
				return false;
			};
		});
		$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][nr]['polys'][busesSelected], function(key, poly) {
			poly.remove();
		});
	};
	updateInfoBox(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']);
};

function showMapLocatie(valInput, obj) {
	return;
	refreshVarsPageVars();
	hideMapLocatie();
	pos = $(obj).offset();
	$("#main").append(createDivArrow('stanga', createDivMapSugestii(), [pos['top'], pos['left'] + $(obj).outerWidth() - 180]));
	if ($.inArray(['div-container', 'remove', true], pageVars['generale']['id_div_for_hidden']) == -1) {
		pageVars['generale']['id_div_for_hidden'].push(['div-container', 'remove', true]);
	};
	coords = pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][valInput][pageVars['generale']['id_sugestie_selected'] - 1][4];
	if (coords[0].toString().indexOf("|") > -1) {
		lats = coords[0].toString().split("|");
		lngs = coords[1].toString().split("|");
		strMarkers = '';
		for (i = 0; i < lats.length; i++) {
			strMarkers += '|' + lats[i] + ',' + lngs[i];
		};
		srcMap = 'https://maps.googleapis.com/maps/api/staticmap?markers=color:red|' + strMarkers + '&zoom=16&size=300x250&lang=' + pageVars['generale']['region_language'] + '&region=' + pageVars['generale']['region_tara'] + '&sensor=false';
	} else {
		srcMap = 'https://maps.googleapis.com/maps/api/staticmap?center=' + coords + '&markers=color:red|' + coords + '&zoom=16&size=300x250&lang=' + pageVars['generale']['region_language'] + '&region=' + pageVars['generale']['region_tara'] + '&sensor=false';
	};
	$("#div-map-sugestii").html(createEl("img", {
		'src': srcMap,
		'style': 'width: 300px; height: 250px;'
	}));
	$("#div-container").css("left", "+=" + (pageVars['generale']['dimensiuni_container']['stanga']['arrow'][0] + parseInt($("#img-container").css("left"))));
	$("#div-container").css("top", "-=" + (parseInt($("#img-container").css("top")) - Math.round(pageVars['generale']['dimensiuni_container']['stanga']['arrow'][1] / 2) + Math.round($(obj).outerHeight() / 2)));
	posSuggest = $("#div-suggest").position();
	posDivHarta = $("#div-container").position();
	bottomMaxDivMap = (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['selectable'] * $(obj).outerHeight() + posSuggest.top) - Math.round($(obj).outerHeight() / 2) + Math.round(pageVars['generale']['dimensiuni_container']['stanga']['arrow'][1] / 2) + parseInt($("#img-container").css("top"));
	if (posDivHarta.top + $("#div-container").outerHeight() > bottomMaxDivMap && (posDivHarta.top + $("#div-container").outerHeight()) >= pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['selectable'] * $(obj).outerHeight() + posSuggest.top) {
		diffPos = posDivHarta.top + $("#div-container").outerHeight() - bottomMaxDivMap;
		$("#div-container").css("top", "-=" + diffPos);
		$("#img-container").css("top", "+=" + diffPos);
	};
};

function insertSuggestIntoPageVars(indexObjFor, text, url, id, coords) {
	refreshVarsPageVars();
	objInput = $(".input-ruta:eq(" + indexObjFor + ")");
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObjFor] = text;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][indexObjFor] = id;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][indexObjFor] = coords;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexObjFor] = text;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][indexObjFor] = url;
	$(objInput).val(text);
	resolveSelectArrowInputs();
	$("#div-suggest").remove();
};

function clickSuggest(indexObjFor, indexSuggest, obj, val) {
	refreshVarsPageVars();
	pageVars['generale']['id_sugestie_selected'] = 0;
	hideMapLocatie();
	objInput = $(".input-ruta:eq(" + indexObjFor + ")");
	valInput = $(objInput).val();
	if (pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][valInput] && pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][valInput].length == 1) {
		indexSuggest = 0;
	};
	if (valInput && indexSuggest > -1) {
		id = pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][valInput][indexSuggest][0];
		nume = pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][valInput][indexSuggest][1];
		url = pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][valInput][indexSuggest][3];
		coords = pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][valInput][indexSuggest][4];
		insertSuggestIntoPageVars(indexObjFor, nume, url, id, coords);
	};
};

function keyDownSuggestSageata(obj, dir) {
	refreshVarsPageVars();
	if ($("#div-suggest").is(":visible") == false) {
		return;
	};
	$("#div-suggest > div").attr("class", "");
	nrDivs = $("#div-suggest > div").length;
	(dir == 'jos') ? pageVars['generale']['id_sugestie_selected'] += 1: pageVars['generale']['id_sugestie_selected'] -= 1;
	if (pageVars['generale']['id_sugestie_selected'] < 1) {
		pageVars['generale']['id_sugestie_selected'] = nrDivs;
	} else if (pageVars['generale']['id_sugestie_selected'] > nrDivs) {
		pageVars['generale']['id_sugestie_selected'] = 1;
	};
	$("#div-suggest > div:nth-child(" + pageVars['generale']['id_sugestie_selected'] + ")").attr("class", "hover");
	if (pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][$(obj).val()][pageVars['generale']['id_sugestie_selected'] - 1][0] > 0) {
		showMapLocatie($(obj).val(), $("#div-suggest > div:nth-child(" + pageVars['generale']['id_sugestie_selected'] + ")"));
	};
};

function overSuggest(obj, idSuggest, val) {
	nrObj = $.inArray(obj, $("#div-suggest > div")) + 1;
	if (pageVars['generale']['id_sugestie_selected'] == nrObj) {
		return;
	};
	$("#div-suggest > div").attr("class", "");
	$(obj).attr("class", "hover");
	pageVars['generale']['id_sugestie_selected'] = nrObj;
	if (idSuggest > 0) {
		showMapLocatie(val, obj);
	};
};

function outSuggest(obj, idSuggest, val) {
	$(obj).attr("class", "");
	pageVars['generale']['id_sugestie_selected'] = 0;
	if (idSuggest > 0) {
		hideMapLocatie();
	};
};

function getSugestii(val, obj, execute) {
	refreshVarsPageVars();
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'suggest',
			'text': makeURL(val),
			'async': false,
			'limit': pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['selectable'],
			'tip_ruta': tipRuta,
			'id_oras': idOrasSelected,
			'tip_cautare': moduriCautare,
			'tip_mijloace': getOptiuniSelectate().join()
		},
		success: function(data) {
			data = eval(data);
			pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val] = data;
			if (execute == 1) {
				prelucreazaSugestii(obj, val, data);
			} else if (execute == 2) {
				if (data.length > 0) {
					prelucreazaSugestii(obj, val, data);
					clickVeziDirectii();
				} else {
					blurInputRuta(obj, $(obj).val());
				};
			};
		},
		beforeSend: function() {}
	});
};

function resolveSelectArrowInputs() {
	refreshVarsPageVars();
	nrVars = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length;
	for (i = 0; i < nrVars; i++) {
		input = $("#table_cautare > tbody:first .input-ruta:eq(" + i + ")");
		val = input.val();
		if (val != '' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['selectable'] > 0) {
			if (pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val] && pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val].length > 0) {
				if ((pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][i] > 0 && moduriCautare != "linii") || (moduriCautare == "linii" && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][i] != "")) {
					eliminaSelectSuggest(input);
				} else {
					adaugaSelectSuggest(input);
				};
			} else {
				getSugestii(val, input, 0);
				eliminaSelectSuggest(input);
			};
		} else {
			eliminaSelectSuggest(input);
		};
	};
};

function blurInputRuta(obj, textInside) {
	refreshVarsPageVars();
	val = $(obj).val();
	defaultValInputs(obj, textInside);
	resolveImgsLeftInputs();
	indexObj = $.inArray(obj, $("#table_cautare > tbody:first > tr > td:nth-child(2) > div > input"));
	hideMapLocatie();
	pageVars['generale']['id_sugestie_selected'] = 0;
	pageVars['generale']['focusSuggest'] = false;
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['selectable'] == 0 && val != "") {
		sugestiiVal = pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val];
		if (sugestiiVal && sugestiiVal.length > 0) {
			$(obj).val(sugestiiVal[0][1]);
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj] = sugestiiVal[0][1];
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][indexObj] = sugestiiVal[0][0];
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][indexObj] = sugestiiVal[0][3];
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexObj] = sugestiiVal[0][1];
			pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][indexObj] = sugestiiVal[0][2];
			pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][sugestiiVal[0][1]] = sugestiiVal;
		} else {
			getSugestii(val, obj, 1);
		};
	};
	if (val != "") {
		if (!pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val] || pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val] == "") {
			if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][indexObj][0] == 0 || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][indexObj][1] == 0) {
				if (pageVars['generale']['geocoding'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj]] && pageVars['generale']['geocoding'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj]] != 'pending' && $.isEmptyObject(pageVars['generale']['geocoding'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj]]) == false) {
					prelucreazaGeo(obj, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj], 'input');
				} else {
					if (moduriCautare != "linii") {
						if (pageVars['generale']['geocoding'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj]] && pageVars['generale']['geocoding'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj]] == 'pending') {
							window.setTimeout(function() {
								blurInputRuta(obj, textInside);
							}, 500);
						} else if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj] != "") {
							pageVars['generale']['geocoding'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj]] = 'pending';
							geocode(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj], 'address',function (response,status) {
								//
							});
							(function l() {
								window.setTimeout(function() {
									if (pageVars['generale']['geocoding'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj]] != 'pending') {
										prelucreazaGeo(obj, pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj], 'input');
										clickVeziDirectii();
									} else if (pageVars['generale']['geocoding'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj]] != {}) {
										l();
									};
								}, 500);
							})();
						} else {
							pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj] = val;
							pageVars['generale']['geocoding'][val] = 'pending';
							geocode(val, 'address',function (response,status) {
								//
							});
							(function l() {
								window.setTimeout(function() {
									if (pageVars['generale']['geocoding'][val] != 'pending') {
										prelucreazaGeo(obj, val, 'input');
										clickVeziDirectii();
									} else if (pageVars['generale']['geocoding'][val] != {}) {
										l();
									};
								}, 50);
							})();
						};
					};
				};
			};
		};
	} else {
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][indexObj] = '';
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'][indexObj] = 0;
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][indexObj] = [0, 0];
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'][indexObj] = '';
		pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][indexObj] = '';
	};
	resolveSelectArrowInputs();
};

function focusInputRuta(obj, textInside) {
	refreshVarsPageVars();
	pageVars['generale']['select_on_map_active'] = -1;
	val = $(obj).val();
	resolveImgsLeftInputs();
	$("#div-suggest").remove();
	hideMapLocatie();
	defaultValInputs(obj, textInside);
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['select_on_map'] != 0) {
		img = $(obj).parent().parent().prev().children().first();
		img.attr("src", pathToImg + "mylocation-icon.png");
		img.attr("title", pageVars['texte']['selectati_locatia_click_harta']);
	};
	if ((val != '' && moduriCautare != "linii" && (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][$.inArray(obj, $(".input-ruta"))][0] == 0 || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][$.inArray(obj, $(".input-ruta"))][1] == 0)) || (val != '' && moduriCautare == "linii" && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][$.inArray(obj, $(".input-ruta"))] == "")) {
		if (pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val]) {
			prelucreazaSugestii(obj, val, pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val]);
		} else {
			getSugestii(val, obj, 1);
		};
	};
	pageVars['generale']['id_sugestie_selected'] = 0;
};

function clickInputRuta(obj, textInside) {
	refreshVarsPageVars();
	pageVars['generale']['select_on_map_active'] = -1;
	val = $(obj).val();
	$("#div-suggest").remove();
	if ((val != '' && moduriCautare != "linii" && (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][$.inArray(obj, $(".input-ruta"))][0] == 0 || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'][$.inArray(obj, $(".input-ruta"))][1] == 0)) || (val != '' && moduriCautare == "linii" && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'][$.inArray(obj, $(".input-ruta"))] == "")) {
		if (pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val]) {
			prelucreazaSugestii(obj, val, pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val]);
		} else {
			getSugestii(val, obj, 1);
		};
	};
	$(obj).css({
		'color': ''
	});
	pageVars['generale']['id_sugestie_selected'] = 0;
	pageVars['generale']['focusSuggest'] = obj;
};

function keyUpInputRuta(obj, textInside, e) {
	refreshVarsPageVars();
	if (tipRuta != 'autobuz') {
		if (returnKeyCode(e) != 13) {
			emptyVarsRuta(obj);
			return;
		} else {
			//getSugestii($(obj).val(), obj, 2);
		};
	};
	if ($.inArray(returnKeyCode(e), new Array(9, 13, 16, 17, 18, 19, 20, 27, 33, 34, 35, 36, 37, 38, 39, 40, 44, 45, 91, 113, 115, 119, 120, 121, 122, 123, 144)) > -1) {
		return;
	};
	val = $(obj).val();
	defaultValInputs(obj, textInside);
	if (val == '') {
		$("#div-suggest").remove();
		resolveSelectArrowInputs();
	} else {
		if (!pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val]) {
			getSugestii(val, obj, 1);
		} else {
			prelucreazaSugestii(obj, val, pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare][val]);
		};
	};
	emptyVarsRuta(obj);
	pageVars['generale']['id_sugestie_selected'] = 0;
	hideMapLocatie();
};

function resolveCenterMap() {
	if (pageVars['generale']['map_loaded'] == 0) {
		return;
	};
	refreshVarsPageVars();
	if (tipRuta == "autobuz") {
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['zoom'] != pageVars['map_options']['zoom'] || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['center'] != pageVars['map_options']['center']) {
			pageVars['generale']['zoom_center_no_change'] = 1;
			setZoomCenter(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['zoom'], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['center']);
			pageVars['generale']['zoom_center_no_change'] = 0;
		} else {
			deranj = 0;
			for (var idOras in pageVars[tipRuta]['orase']) {
				if (pageVars[tipRuta]['orase'].hasOwnProperty(idOras)) {
					if (pageVars[tipRuta]['orase'][idOras][moduriCautare]['zoom'] != pageVars['map_options']['zoom'] || pageVars[tipRuta]['orase'][idOras][moduriCautare]['center'] != pageVars['map_options']['center']) {
						pageVars['generale']['zoom_center_no_change'] = 1;
						getFrame('iframe_harta').setCenter(pageVars[tipRuta]['orase'][idOrasSelected]['centerLat'], pageVars[tipRuta]['orase'][idOrasSelected]['centerLng']);
						getFrame('iframe_harta').setZoom(pageVars[tipRuta]['orase'][idOrasSelected]['zoom']);
						pageVars['generale']['zoom_center_no_change'] = 0;
						deranj = 1;
						break;
					};
				};
			};
		};
	} else {
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['zoom'] != pageVars['map_options']['zoom'] || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['center'] != pageVars['map_options']['center']) {
			pageVars['generale']['zoom_center_no_change'] = 1;
			setZoomCenter(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['zoom'], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['center']);
			pageVars['generale']['zoom_center_no_change'] = 0;
		};
	};
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		if (tipRuta == 'auto' || tipRuta == 'bicicleta' || tipRuta == 'pe-jos') {
			if (pageVars[tipRuta]['orase'][idOrasSelected]['rute']['results'].length > 0) {
				pageVars['generale']['directionsDisplay'][tipRuta].addTo(getFrame('iframe_harta').map);
			};
		} else if (tipRuta == 'autobuz') {
			if (moduriCautare == 'rute') {
				if (pageVars[tipRuta]['orase'][idOrasSelected]['rute']['results'].length > 0) {
					showRuteAutobuz();
				};
			} else if (moduriCautare == 'statii') {} else if (moduriCautare == 'linii') {};
		} else if (tipRuta == 'linie-dreapta') {
			if (pageVars[tipRuta]['orase'][idOrasSelected]['rute']['results'].length > 0) {
				$.each(pageVars['generale']['markersLiniiDrepte'], function(key, value) {
					if (value) {
						value.addTo(getFrame('iframe_harta').map);
					};
					if (pageVars['generale']['liniiDrepte'][key]) {
						pageVars['generale']['liniiDrepte'][key].addTo(getFrame('iframe_harta').map);
					};
				});
			};
		};
	};
};

function clickLiteraInput(obj, lit) {
	refreshVarsPageVars();
	pageVars['generale']['select_on_map_active'] = -1;
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['select_on_map'] == 0) {
		return false;
	};
	if ($(obj).attr("src") == pathToImg + "mylocation-icon-selected.png") {
		$(obj).attr("src", pathToImg + "litere/" + lit.toLowerCase() + ".png");
		$(obj).attr("title", "");
		$(obj).parent().next("td").children("div").children("input").css({
			'color': ''
		});
		resolveImgsLeftInputs();
	} else {
		resolveImgsLeftInputs();
		$(obj).attr("src", pathToImg + "mylocation-icon-selected.png");
		$(obj).attr("title", pageVars['texte']['click_pe_harta']);
		pageVars['generale']['select_on_map_active'] = $.inArray(obj, $(".litera"));
		if (tipRuta == "autobuz") {
			if (pageVars[tipRuta]['zoom_center_changed'] == 0) {
				getFrame('iframe_harta').map.setView(getFrame('iframe_harta').getPoint(pageVars[tipRuta]['orase'][idOrasSelected]['centerLat'], pageVars[tipRuta]['orase'][idOrasSelected]['centerLng']),pageVars[tipRuta]['orase'][idOrasSelected]['zoom']);
			};
			if (moduriCautare == 'rute') {
				resetRuteAutobuz();
			};
			if (moduriCautare == 'statii') {
				hideAutobuzeLiniiStatie();
			};
			if (pageVars[tipRuta]['orase'][idOrasSelected]['statii_incarcate']) {
				if ((pageVars[tipRuta]['orase'][idOrasSelected]['statii_incarcate'].length && pageVars[tipRuta]['orase'][idOrasSelected]['statii_incarcate'].length == 0) || $.isEmptyObject(pageVars[tipRuta]['orase'][idOrasSelected]['statii_incarcate'])) {
					showInfoAlert(pageVars['texte']['se_incarca_statiile']);
					getStatiiOras();
				} else {
					getFrame('iframe_harta').showMarkersStatii();
				};
			};
		} else {
			pageVars['generale']['zoom_center_no_change'] = 1;
			setZoomCenter(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['zoom'], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['center']);
			pageVars['generale']['zoom_center_no_change'] = 0;
		};
		$(obj).parent().next("td").children("div").children("input").css({
			'color': '#DEDEDE'
		});
	};
};

function setInputsRuta() {
	refreshVarsPageVars();
	$("#table_cautare > tbody:first .input-ruta").attr("onblur", "");
	$("#table_cautare > tbody:first .input-ruta").parent().parent().parent().remove();
	nrVars = pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length;
	for (i = 0; i < nrVars; i++) {
		if (nrVars == 1 && i == 0) {
			$("#table_cautare > tbody:first > tr:last").before(createInputRuta(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['nume'].substring(0, 1).toLowerCase()));
		} else {
			$("#table_cautare > tbody:first > tr:last").before(createInputRuta(pageVars['generale']['litere'][i]));
		};
	};
	inputs = $("#table_cautare > tbody:first .input-ruta");
	$("#content_tab_ruta").height($("#table_cautare > tbody:first > tr:first > td:first").height() + 20 + $("#table_cautare > tbody:first > tr:last").height() + ($("#table_cautare > tbody:first > tr:last").height() + 2) * inputs.length);
	$.each(inputs, function(key, value) {
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key]) {
			if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key] == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']] || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key] == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']] || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key] == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']]) {
				$(inputs[key]).parent().children('span').html(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key]);
				$(inputs[key]).attr("onclick", "clickInputRuta(this,'" + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key] + "');");
				$(inputs[key]).attr("onfocus", "focusInputRuta(this,'" + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key] + "');");
				$(inputs[key]).attr("onblur", "blurInputRuta(this,'" + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key] + "');");
				$(inputs[key]).attr("onkeyup", "keyUpInputRuta(this,'" + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key] + "',event);");
			} else {
				$(inputs[key]).val(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][key]);
			};
		} else {
			$(inputs[key]).parent().children('span').html(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1]);
			if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1] == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['de_la']] || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1] == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['pana_la']] || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1] == pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['prin_localitatea']]) {
				$(inputs[key]).attr("onclick", "clickInputRuta(this,'" + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1] + "');");
				$(inputs[key]).attr("onfocus", "focusInputRuta(this,'" + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1] + "');");
				$(inputs[key]).attr("onblur", "blurInputRuta(this,'" + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1] + "');");
				$(inputs[key]).attr("onkeyup", "keyUpInputRuta(this,'" + pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].length - 1] + "',event);");
			};
		};
	});
	resolveSwitchRemove();
	resolveInputsVals();
	adjustShaddowAvansat();
	resolveInputsSelect();
	resolveSelectArrowInputs();
	if (inputs.length == pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['nr_maxim_orase']) {
		hideAddDestinatie();
	} else {
		showAddDestinatie();
	};
};

function clickRutaLinieStatie(tip, tipCautare) {
	cleanMap(tip, tipCautare);
	$("#optiuni_" + tip + " > div").hide();
	nrSpan = $.inArray(tipCautare, pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['moduri_cautare']);
	pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['moduri_cautare_selected'] = nrSpan;
	$("#optiuni_" + tip + " > div#div_" + tip + "_" + tipCautare).show();
	if (pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['moduri_cautare'].length > 2 && $("#div_avansat").length > 0) {
		position = $("#optiuni_" + tip + " > span.submeniu_optiuni span:nth-child(" + (nrSpan + 1) + ")").position();
		$("#optiuni_" + tip + " > span.submeniu_optiuni > img:first").css("left", (position.left - $("#optiuni_" + tip + " > span.submeniu_optiuni > img:first").width()) + "px");
		$("#optiuni_" + tip + " > span.submeniu_optiuni > img:last").css("left", (position.left + $("#optiuni_" + tip + " > span.submeniu_optiuni span:nth-child(" + (nrSpan + 1) + ")").width() + 24) + "px");
	};
	$("#b_string_cautare").html(pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['nume_afisat_cautare']);
	$("#buton_vezi_directii").val(pageVars['texte'][pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['text_buton']]);
	$("#buton_vezi_directii").attr("title", pageVars['texte'][pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['title_buton']]);
	$("#a_content_tab_ruta").html(pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['nume']);
	setInputsRuta();
	pageVars['generale']['select_on_map_active'] = -1;
	resolveImgsLeftInputs();
	setPageTitle();
	$("span#orase.autobuze > span").empty();
};

function resolveColorPath() {
	refreshVarsPageVars();
	setCuloare($(".culoare." + pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']));
};

function setCuloare(obj) {
	refreshVarsPageVars();
	$("#culori_traseu span.before_culoare").html("");
	$(obj).parent().prev().children("span").html(">>");
	if ($(obj).attr("class")) {
		pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected'] = $(obj).attr("class").replace("culoare ", "");
	};
	var rutaTrasata = 'NU';
	if (control && control._line && (tipRuta == 'auto' || tipRuta == 'pe-jos' || tipRuta == 'bicicleta')) {
		control._line.setStyle({color: pageVars[tipRuta]['orase'][idOrasSelected]['culori'][pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']]});
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'autobuz' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		if (moduriCautare == 'linii') {
			if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur']['polys'].length > 0) {
				$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur']['polys'], function(key, poly) {
					poly.setStyle({
						color: pageVars[tipRuta]['orase'][idOrasSelected]['culori'][pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']]
					});
				});
			};
			if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']['polys'].length > 0) {
				$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']['polys'], function(key, poly) {
					poly.setStyle({
						color: pageVars[tipRuta]['orase'][idOrasSelected]['culori'][nextColor()]
					});
				});
			};
		} else if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['polys']) {
			$.each(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['polys'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['buses']], function(kk, poly) {
				poly.setStyle({
					color: pageVars[tipRuta]['orase'][idOrasSelected]['culori'][pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']]
				});
				poly.addTo(getFrame('iframe_harta').map);
			});
		};
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		$.each(pageVars['generale']['markersLiniiDrepte'], function(key, value) {
			if (value) {
				value.addTo(getFrame('iframe_harta').map);
			};
			if (pageVars['generale']['liniiDrepte'][key]) {
				pageVars['generale']['liniiDrepte'][key].addTo(getFrame('iframe_harta').map).setStyle({color: pageVars[tipRuta]['orase'][idOrasSelected]['culori'][pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']]});
			};
		});
		rutaTrasata = 'DA';
	};
	pageVars['generale']['rutaAlternativa'].setStyle({
		color: pageVars[tipRuta]['orase'][idOrasSelected]['culori'][pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']]
	});
	pageVars['generale']['select_on_map_active'] = -1;
	resolveImgsLeftInputs();
};

function schimbaTipTraseu() {
	refreshVarsPageVars();
	rutaPreselectataHash = location.hash.substr(2, location.hash.indexOf('/') - 2);
	if (rutaPreselectataHash && !history.pushState) {
		$.each(pageVars['tip_rute'], function(key, value) {
			if (pageVars[value]['orase'][pageVars[value]['id_oras_selected']]['url_sectiune'] == rutaPreselectataHash) {
				pageVars['generale']['tip_ruta'] = value;
				$("#b_string_cautare").html(pageVars[value]['orase'][pageVars[value]['id_oras_selected']][pageVars[value]['orase'][pageVars[value]['id_oras_selected']]['moduri_cautare'][pageVars[value]['orase'][pageVars[value]['id_oras_selected']]['moduri_cautare_selected']]]['optiuni']['nume_afisat_cautare']);
				$("#buton_vezi_directii").val(pageVars['texte'][pageVars[value]['orase'][pageVars[value]['id_oras_selected']][moduriCautare]['optiuni']['text_buton']]);
				$("#buton_vezi_directii").attr("title", pageVars['texte'][pageVars[value]['orase'][pageVars[value]['id_oras_selected']][moduriCautare]['optiuni']['title_buton']]);
				$("#td_choose_color").html(createCuloriTraseu());
			};
		});
	} else {
		$("#b_string_cautare").html(pageVars[pageVars['generale']['tip_ruta']]['orase'][pageVars[pageVars['generale']['tip_ruta']]['id_oras_selected']][pageVars[pageVars['generale']['tip_ruta']]['orase'][pageVars[pageVars['generale']['tip_ruta']]['id_oras_selected']]['moduri_cautare'][pageVars[pageVars['generale']['tip_ruta']]['orase'][pageVars[pageVars['generale']['tip_ruta']]['id_oras_selected']]['moduri_cautare_selected']]]['optiuni']['nume_afisat_cautare']);
		$("#buton_vezi_directii").val(pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['text_buton']]);
		$("#buton_vezi_directii").attr("title", pageVars['texte'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['title_buton']]);
	};
	resolveInputsSelect();
	resolveColorPath();
};

function clickTipTraseu(obj, tip) {
	pageVars['generale']['select_on_map_active'] = -1;
	clearStradaObiectiv();
	if (tip != 'autobuz') {
		clearMarkersStatiiIncarcate();
	};
	$("#div_avansat > table > tbody > tr:nth-child(2) > td > div").hide();
	$.each(pageVars['tip_rute'], function(key, value) {
		$("#tipuri_rute_" + value).attr("src", pathToImg + value + '-off.png');
	});
	$("#tipuri_rute_" + tip).attr("src", pathToImg + tip + '-on.png');
	$("#optiuni_" + tip).show();
	clickRutaLinieStatie(tip, pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['moduri_cautare'][pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['moduri_cautare_selected']]);
	pageVars['generale']['tip_ruta'] = tip;
	$("#buton_vezi_directii").val(pageVars['texte'][pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['moduri_cautare'][pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['moduri_cautare_selected']]]['optiuni']['text_buton']]);
	$("#buton_vezi_directii").attr("title", pageVars['texte'][pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['moduri_cautare'][pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['moduri_cautare_selected']]]['optiuni']['title_buton']]);
	if (tip == 'auto') {
		if ($("#optiuni-consum-auto").length == 0) {
			$("#div_unitati_masura_distante").parent().append(createConsumAuto());
		};
	} else {
		$("#optiuni-consum-auto").remove();
	};
	setHash(((pageVars[tip]['id_oras_selected'] > 0) ? pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['url'] + '/' : '') + pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']]['url_sectiune'] + '/', true);
	schimbaTipTraseu();
	setInputsRuta();
	$("#culori_traseu").remove();
	$("#td_choose_color").append(createCuloriTraseu());
	resolveColorPath();
	pageVars['generale']['select_on_map_active'] = -1;
	resolveImgsLeftInputs();
	$.cookie('tip_traseu', tip, {
		expires: 30,
		path: '/'
	});
	$.cookie('id_oras_selected', idOrasSelected, {
		expires: 30,
		path: '/'
	});
	setPageTitle();
	if (tip == 'autobuz') {
		if ($.cookie('show_tc_orase') == null) {
			clickSelectOrasCautareAutobuz();
		};
		$.cookie('show_tc_orase', 1, {
			expires: 30,
			path: '/'
		});
	};
	if (pageVars.uber.map == 1) {
		bannerUber.remove();
		if (tip == 'autobuz') {
			//$("body").append(bannerUber.create());
		};
	};
	$("#top #share").show().css({
		right: calculateShareMaxWidth()
	});
	/* if (pageVars.blablacar.map == 1) {
		bannerBla.remove();
		bannerBla.update();
		if (tip == 'auto') {
			$("body").append(bannerBla.create());
			bannerBla.start();
			$("#top #orase, #top #default").remove();
			$("#top_blablacar").remove();
			//$("#top #share").hide().before(createTopBlablacar());
			$("#top #share").hide();
		} else {
			$("#top_blablacar").remove();
			$("#top #share").hide();
		};
	}; */
	$("span#orase.autobuze > span").empty();
	$("span#orase").empty();
};

function clearCots() {
	if (tipRuta == 'auto' || tipRuta == 'pe-jos' || tipRuta == 'bicicleta') {
		$.each($("#traseu > div.content_traseu:eq(0)").children("div.cot, div.cot_over"), function(key, value) {
			cotOut(value);
			$(value).attr("class", "cot");
			$(value).attr("onmouseout", "cotOut(this);")
		});
	};
};

function cotOver(obj) {
	$(obj).attr('class', 'cot_over');
	showMarker($(obj).children(".nr").html());
	showMarkerPoint($(obj).children(".nr").html());
	setPolyInside(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['ruta_selected']]['cotituri'][$(obj).children(".nr").html() - 1][5]);
};

function cotOut(obj) {
	$(obj).attr('class', 'cot');
	hideMarker();
	hideMarkerPoint();
	hidePolyInside();
};

function transmitePageVars() {
	refreshVarsPageVars();
	$.each(pageVars['tip_rute'], function(key, value) {
		$.each(pageVars[value]['orase'][pageVars[value]['id_oras_selected']]['moduri_cautare'], function(key2, tipCautare) {
			$.each(pageVars[value]['orase'][pageVars[value]['id_oras_selected']][tipCautare]['optiuni']['ui'], function(k, optiune) {
				$.each(optiune, function(nume, array) {
					$("#" + value + "_" + tipCautare + "_" + nume).attr("checked", (array[0] == true) ? true : false);
				});
			});
		});
	});
	$('[name="unitati_masura"][value="' + pageVars['generale']['unitati_masura_distante'][pageVars['generale']['default_um']][2] + '"]').attr("checked", true);
	clickTipTraseu($("#tipuri_rute_" + tipRuta), tipRuta);
	setCuloare($("#culori_traseu span.culoare." + pageVars[tipRuta]['orase'][idOrasSelected]['nume_culoare_selected']));
};

function arataAvansat() {
	$("#main").append(createDivAvansat());
	$("#optiuni").css("width", "56px");
	$("#optiuni").css("right", "-10px");
	$("#div_avansat").append(createImgCloseAvansat());
	adjustShaddowAvansat();
};

function ascundeAvansat() {
	$("#optiuni").css("width", "46px");
	$("#optiuni").css("right", "0px");
	$("#div_avansat").remove();
	$("#img_inchide_avansat").remove();
	adjustShaddowAvansat();
	$("#cautare_ruta_inner").show();
};

function clickOptiuni() {
	if (isMobile===true) {
		if ($("#div_avansat").length > 0) {
			ascundeAvansat();
		} else {
			arataAvansat();
			$("#cautare_ruta_inner").hide();
		};
	} else {
		var avansat = 'Inchidere';
		if ($("#div_avansat").length > 0) {
			ascundeAvansat();
		} else {
			arataAvansat();
			avansat = 'Deschidere';
		};
	};
	transmitePageVars();
	var rutaTrasata = 'NU';
	if (pageVars[tipRuta]['google'] && pageVars['generale']['directionsDisplay'][tipRuta] && pageVars['generale']['directionsDisplay'][tipRuta].polylineOptions) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'autobuz' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
};

function resultToSearch() {
	clearCots();
	divTop = 'index';
	$("#content").remove();
	$("#main").append(createDivCautareRutaInner());
	setWidthAOptiuni(pageVars['generale']['width_optiuni']);
	transmitePageVars();
	setInputsRuta();
	(showOptionsOnReturn == 1) ? clickOptiuni(): "";
	$("div.tabs_mobile, #sageata_top, div.tabs_mobile_linie, div.tabs_mobile_statie").hide();
};

function changeLocalitati() {
	if (tipRuta == 'autobuz' && moduriCautare == 'linii') {
		var turRetur;
		if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']) {
			turRetur = ['tur', 'retur'];
		} else if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['tur']) {
			turRetur = ['tur'];
		} else if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'][0]['retur']) {
			turRetur = ['retur'];
		};
		showAutobuzeLinie(turRetur);
	};
	pageVars['generale']['cotClicked'] = 0;
	resultToSearch();
	$("#main").append(createDivTabs(stabilesteTaburi()));
	$("#content_tab_viteza_consum").remove();
	$("#content_tab_elevatia").remove();
	pageVars['generale']['infoWindow'].closePopup();
	hideMarkerVisible();
	hideMarker();
	hideMarkerPoint();
	hidePolyInside();
	schimbaTipTraseu();
	$("#a_content_tab_ruta").html(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['optiuni']['nume']);
	if (pageVars['generale']['oras']['nume'] != '') {
		$("#a_content_tab_ruta").attr("class", "current");
	};
};

function keyDownStradaObiectiv(obj, e) {
	if (returnKeyCode(e) == 13) {
		clickCautaObiectiv(obj);
	};
};

function clickCautaObiectiv(obj) {
	cleanMap();
	$("#content").remove();
	if (tipRuta !== 'linie-dreapta') {} else {
		$("#cautare_ruta_inner").hide();
	};
	$('#main').append(createDivTabs(stabilesteTaburi()));
	$("#cautare_ruta_inner").hide();
	ascundeAvansat();
	clickRutaLinieStatie(tipRuta, moduriCautare);
	pageVars['generale']['oras']['string_cautare_strada'] = $(obj).val();
	if (pageVars['generale']['oras']['string_cautare_strada'] != '') {
		cautaObiectiv(pageVars['generale']['oras']['string_cautare_strada']);
	};
	clickTab($("#a_content_tab_strada_obiectiv"), 1);
};

function clickOptiuniTipRuta(tip, tipCautare, optiune, obj) {
	$.each(pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['ui'], function(key, alteOptiuni) {
		$.each(alteOptiuni, function(opt, array) {
			if (obj.type == 'checkbox') {
				if (opt == optiune) {
					pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['ui'][key][opt][0] = ($(obj).attr("checked") == "checked") ? true : false;
					if (optiune == 'geodesic' && tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
						clickVeziDirectii();
					};
				};
			} else if (obj.type == 'radio') {
				if (pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['ui'][key][opt][2] == obj.name.toString().replace(tip + "_" + tipCautare + "_", "")) {
					if (opt == optiune) {
						pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['ui'][key][opt][0] = true;
						if (key == 1 && tip == "auto" && tipCautare == "rute") {
							$.cookie('combustibil', optiune, {
								expires: 30,
								path: '/'
							});
						};
					} else {
						pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['ui'][key][opt][0] = false;
					};
				};
			};
		});
	});
	pageVars['generale']['select_on_map_active'] = -1;
	resolveImgsLeftInputs();
	pageVars['generale']['sugestii'][tipRuta][idOrasSelected][moduriCautare] = {};
	getFrame('iframe_harta').showMarkersStatii(1);
	if ($(obj).attr("checked") === undefined && pageVars[tip]['orase'][pageVars[tip]['id_oras_selected']][tipCautare]['optiuni']['selectable'] > 0) {
		removeInputValsIfId(tip, tipCautare, optiune);
	};
};

function adaugaDestinatie() {
	refreshVarsPageVars();
	pageVars['generale']['select_on_map_active'] = -1;
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].push('');
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'].push(0);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].push([0, 0]);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'].push('');
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'].push('');
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['markersVarsInputs'].push('');
	setInputsRuta();
	$("#table_cautare div.div-input-ruta:last > input").focus();
	setHashDefault();
	var rutaTrasata = 'NU';
	if (pageVars[tipRuta]['google'] && pageVars['generale']['directionsDisplay'][tipRuta] && pageVars['generale']['directionsDisplay'][tipRuta].polylineOptions) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'autobuz' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
};

function stergeDestinatia(obj) {
	positionInput = $(obj).parent().parent().parent().children().index($(obj).parent().parent());
	$(obj).parent().parent().remove();
	refreshVarsPageVars();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].splice(positionInput - 1, 1);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'].splice(positionInput - 1, 1);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].splice(positionInput - 1, 1);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'].splice(positionInput - 1, 1);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'].splice(positionInput - 1, 1);
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['markersVarsInputs'].splice(positionInput - 1, 1);
	setInputsRuta();
	if (tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		clickVeziDirectii();
	};
	setHashDefault();
	var rutaTrasata = 'NU';
	if (pageVars[tipRuta]['google'] && pageVars['generale']['directionsDisplay'][tipRuta] && pageVars['generale']['directionsDisplay'][tipRuta].polylineOptions) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'autobuz' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'] && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
	if (tipRuta == 'linie-dreapta' && pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['results'].length > 0) {
		rutaTrasata = 'DA';
	};
};

function switchLocalitati() {
	refreshVarsPageVars();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['varsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['idsVarsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['coordVarsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['textCoordVarsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['urlsVarsInputs'].reverse();
	pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['markersVarsInputs'].reverse();
	setInputsRuta();
	resolveSelectArrowInputs();
	resolveImgsLeftInputs();
};

function clickOrasCautareAutobuz(idOras) {
	pageVars['generale']['select_on_map_active'] = -1;
	cleanMap();
	clearMarkersStatiiIncarcate();
	removeDivsInfo();
	oldOras = pageVars[pageVars['generale']['tip_ruta']]['id_oras_selected'];
	pageVars[pageVars['generale']['tip_ruta']]['id_oras_selected'] = idOras;
	refreshVarsPageVars();
	td = $("#optiuni_" + tipRuta).parent();
	$("#optiuni_" + tipRuta).remove();
	if ($.inArray(moduriCautare, pageVars[tipRuta]['orase'][oldOras]['moduri_cautare']) != -1) {
		pageVars[tipRuta]['orase'][idOras]['moduri_cautare_selected'] = pageVars[tipRuta]['orase'][oldOras]['moduri_cautare_selected'];
	};
	$(td).append(createOptiuni(tipRuta));
	transmitePageVars();
	setInputsRuta();
	$("#select-oras-cautare").remove();
	$("#buton_vezi_directii").parent().append(createSelectOras());
	if (pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['zoom'] != pageVars['map_options']['zoom'] || pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['center'] != pageVars['map_options']['center']) {
		pageVars['generale']['zoom_center_no_change'] = 1;
		setZoomCenter(pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['zoom'], pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare]['center']);
		pageVars['generale']['zoom_center_no_change'] = 0;
	} else {
		pageVars['generale']['zoom_center_no_change'] = 1;
		getFrame('iframe_harta').setCenter(pageVars[tipRuta]['orase'][idOrasSelected]['centerLat'], pageVars[tipRuta]['orase'][idOrasSelected]['centerLng']);
		getFrame('iframe_harta').setZoom(pageVars[tipRuta]['orase'][idOrasSelected]['zoom']);
		pageVars['generale']['zoom_center_no_change'] = 0;
	};
};

function processGeo(oras) {
	pageVars['generale']['geocoder'].geocode('address',oras,function(res, status) {
		if (status == "OK") {
			boundsOras = getFrame('iframe_harta').L.latLngBounds(getFrame('iframe_harta').L.latLng(res[0].boundingbox[0], res[0].boundingbox[2]),getFrame('iframe_harta').L.latLng(res[0].boundingbox[1], res[0].boundingbox[3]));
			getFrame('iframe_harta').map.fitBounds(boundsOras);
			centerOras = getFrame('iframe_harta').L.latLng(res[0].lat, res[0].lon);
			getFrame('iframe_harta').map.setView(centerOras,getFrame('iframe_harta').map.getZoom()+2);
			getRandomLocations(getFrame('iframe_harta').map.getBounds(), 2);
		} else {};
	});
};

function getRandomLocations(bounds, nr) {
	var NE = bounds.getNorthEast();
	var SW = bounds.getSouthWest();
	var latN = NE.lat;
	var lngE = NE.lng;
	var latS = SW.lat;
	var lngW = SW.lng;
	var randLatPointA = Math.random();
	var randLngPointA = Math.random();
	var randLatPointB = Math.random();
	var randLngPointB = Math.random();
	var latPointA = (Math.max(latN, latS) - Math.min(latN, latS)) * randLatPointA + Math.min(latN, latS);
	var lngPointA = (Math.max(lngW, lngE) - Math.min(lngW, lngE)) * randLngPointA + Math.min(lngW, lngE);
	var latPointB = (Math.max(latN, latS) - Math.min(latN, latS)) * randLatPointB + Math.min(latN, latS);
	var lngPointB = (Math.max(lngW, lngE) - Math.min(lngW, lngE)) * randLngPointB + Math.min(lngW, lngE);
	pageVars['generale']['geocoder'].geocode('latLng', getFrame('iframe_harta').getPoint(latPointA,lngPointA), function(res, status) {
		if (status == "OK") {
			namePointA = res.display_name;
			$("#text-exemplu-a").html(prelucreazaAdresa(namePointA));
		} else {};
	});
	pageVars['generale']['geocoder'].geocode('latLng', getFrame('iframe_harta').getPoint(latPointB,lngPointB), function(res, status) {
		if (status == "OK") {
			namePointB = res.display_name;
			$("#text-exemplu-b").html(prelucreazaAdresa(namePointB));
		} else {};
	});
};

function prelucreazaAdresa(adresa) {
	adresa = adresa.split(",");
	adresa[adresa.length - 2] = adresa[adresa.length - 2].split(" ");
	adresa[adresa.length - 2] = adresa[adresa.length - 2][adresa[adresa.length - 2].length - 1];
	return adresa[0].concat(", ", adresa[adresa.length - 2]);
};

function preparePageVars() {
	var hash = window.location.hash;
	$.each(pageVars['tip_rute'], function(key1, value1) {
		pageVars['generale']['sugestii'][value1] = [];
		$.each(pageVars[value1]['orase'], function(idOras, value2) {
			pageVars['generale']['sugestii'][value1][idOras] = {};
			$.each(value2['moduri_cautare'], function(key3, value3) {
				for (var i = 0; i < pageVars[value1]['orase'][idOras][value3]['optiuni']['nr_minim_orase']; i++) {
					pageVars[value1]['orase'][idOras][value3]['varsInputs'].push('');
					pageVars[value1]['orase'][idOras][value3]['idsVarsInputs'].push(0);
					pageVars[value1]['orase'][idOras][value3]['coordVarsInputs'].push([0, 0]);
					pageVars[value1]['orase'][idOras][value3]['textCoordVarsInputs'].push('');
					pageVars[value1]['orase'][idOras][value3]['urlsVarsInputs'].push('');
					pageVars[value1]['orase'][idOras][value3]['markersVarsInputs'].push('');
				};
				pageVars['generale']['sugestii'][value1][idOras][value3] = {};
			});
		});
	});
	if ($.cookie('unitati_masura') != null) {
		pageVars['generale']['default_um'] = $.cookie('unitati_masura');
	};
	if ($.cookie('consum') != null) {
		pageVars['generale']['litri_la_suta'] = parseFloat($.cookie('consum'));
	};
	if ($.cookie('combustibil') != null) {
		$.each(pageVars['auto']['orase'][0]['rute']['optiuni']['ui'][1], function(key, array) {
			pageVars['auto']['orase'][0]['rute']['optiuni']['ui'][1][key][0] = (key == $.cookie('combustibil')) ? true : false;
		});
	};
	var c, l, t, v, pathName;
	pathName = $.trim(location.pathname.replace(/\//g, ' ')).split(" ");
	c = 'index';
	if (page == 'autobuze') {
		l = pathName[0];
		t = 'autobuz';
		v = pathName[1];
	} else if (page == 'autobuze-linie' || page == 'autobuze-statie') {
		l = pathName[0];
		t = 'autobuz';
		v = pathName[1] + '/' + pathName[2];
	} else if (page == 'autobuze-ruta') {
		l = pathName[0];
		t = 'autobuz';
		v = pathName[1] + '/' + pathName[2] + '~' + pathName[3];
	} else if (page == 'pe-jos' || page == 'bicicleta' || page == 'linie-dreapta') {
		pathName.shift();
		l = (page == 'pe-jos') ? 'pe-jos' : ((page == 'bicicleta') ? 'bicicleta' : ((page == 'linie-dreapta') ? 'linie-dreapta' : ''));
		t = (page == 'pe-jos') ? 'pe-jos' : ((page == 'bicicleta') ? 'bicicleta' : ((page == 'linie-dreapta') ? 'linie-dreapta' : ''));
		v = pathName.join('~');
	} else if (page == 'oras-oras') {
		l = 'rute-auto';
		t = 'auto';
		v = pathName.join('~');
	} else {
		var arrayHash = window.location.hash.substr(2).split('/');
		if (arrayHash != '' || page != 'index') {
			c = page;
			l = (page == 'oras') ? _u : ((page == 'oras-oras') ? _u : arrayHash[0]);
			t = (arrayHash[0] == 'rute-auto') ? 'auto' : ((arrayHash[0] == 'bicicleta') ? 'bicicleta' : ((arrayHash[0] == 'pe-jos') ? 'pe-jos' : ((arrayHash[0] == 'linie-dreapta' || arrayHash[0] == 'strazi') ? arrayHash[0] : ((arrayHash[0].length > 0) ? 'autobuz' : ''))));
			v = hash.replace('#!' + arrayHash[0], '').replace('/', ' ').replace(/^\s+|\s+$/g, '');
		};
	};
	$.ajax({
		url: '/inc/ajax.php',
		dataType: 'script',
		type: 'post',
		data: {
			'for': 'get_data_from_url',
			'c': c,
			'l': l,
			't': t,
			'v': v
		},
		success: function() {
			$.each(d, function(k, obj) {
				$.each(obj, function(key, value) {
					pageVars[tipRuta]['orase'][idOrasSelected][moduriCautare][key][k] = value;
				});
			});
			pageVars['generale']['click_vezi_directii'] = 1;
			setInputsRuta();
			if (pageVars['generale']['oras']['nume'] != '') {
				$("#main").append(createContentTabStradaObiectiv());
				if (pageVars['generale']['tip_ruta'] == 'autobuz') {
					$("#a_content_tab_ruta").trigger('click');
				} else if (pageVars['generale']['tip_ruta'] == 'auto') {
					$("#a_content_tab_strada_obiectiv").trigger('click');
				};
			};
			if (pageVars['generale']['map_loaded'] == 1) {
				clickVeziDirectii();
				processGeo(oras + ', ' + pageVars['generale']['nume_tara']);
			};
		},
		beforeSend: function() {}
	});
	if ($.cookie('tip_traseu') != null) {
		pageVars['generale']['tip_ruta'] = $.cookie('tip_traseu');
		if ($.cookie('id_oras_selected') != null) {
			pageVars[pageVars['generale']['tip_ruta']]['id_oras_selected'] = $.cookie('id_oras_selected');
		};
	};
};

function ascundeTableInstructiuni(){
	$("#table_instructiuni").hide();
	$("#content_tab_detalii_consum, .tabs_mobile").show();
	if (tipRuta=="autobuz") {
		$("#content_tab_detalii_ruta").show();
	};
};

function ascundeTableInstructiuniLinie(){
	$("#table_instructiuni_linie").hide();
	$("#content_tab_detalii_linie, .tabs_mobile_linie").show();
};

function ascundeTableInstructiuniStatie(){
	$("#table_instructiuni_statie").hide();
	$("#content_tab_detalii_statie, .tabs_mobile_statie").show();
};

function clickTabDetalii(){
	$("#content_tab_detalii_consum, .tabs_mobile").hide();
	$("#table_instructiuni").show();
	if (tipRuta=="autobuz") {
		$("#content_tab_detalii_ruta").hide();
	};
};

function clickTabDetaliiLinie(){
	$("#content_tab_detalii_linie, .tabs_mobile_linie").hide();
	$("#table_instructiuni_linie").show();
};

function clickTabDetaliiStatie(){
	$("#content_tab_detalii_statie, .tabs_mobile_statie").hide();
	$("#table_instructiuni_statie").show();
};

function toogleDetails(){
	var imgName = $("div#sageata_top > img").attr("src").split("/");
	
	imgName = imgName[imgName.length-1];
	if (imgName=="arrow-down.png") {
		// arata
		$("div#sageata_top > img").attr({src:pathToImg+'arrow-up.png'});
		switch (tipRuta) {
			case "auto":
				$("#content_tab_detalii_consum, div.tabs_mobile, #content_tab_detalii_linie").show();
				break;
			case "autobuz":
				switch (moduriCautare) {
					case "linii":
						$("div.tabs_mobile_linie, #content_tab_detalii_linie").show();
						break;
					case "rute":
						$("#content_tab_detalii_ruta, div.tabs_mobile").show();
						break;
					case "statii":
						$("div.tabs_mobile_statie, #content_tab_detalii_statie").show();
						break;
				};
				break;
			case "pe-jos":
				$("#content_tab_detalii_consum, div.tabs_mobile, #content_tab_detalii_linie").show();
				break;
			case "linie-dreapta":
				
				break;
			case "bicicleta":
				$("#content_tab_detalii_consum, div.tabs_mobile, #content_tab_detalii_linie").show();
				break;
		};
	} else {
		// ascunde
		$("div#sageata_top > img").attr({src:pathToImg+'arrow-down.png'});
		switch (tipRuta) {
			case "auto":
				$("#content_tab_detalii_consum, div.tabs_mobile, #table_instructiuni").hide();
				break;
			case "autobuz":
				switch (moduriCautare) {
					case "linii":
						$("div.tabs_mobile_linie, #content_tab_detalii_linie, #table_instructiuni_linie").hide();
						break;
					case "rute":
						$("#content_tab_detalii_ruta, div.tabs_mobile, #table_instructiuni").hide();
						break;
					case "statii":
						$("div.tabs_mobile_statie, #content_tab_detalii_statie, #table_instructiuni_statie").hide();
						break;
				};
				break;
			case "pe-jos":
				$("#content_tab_detalii_consum, div.tabs_mobile, #table_instructiuni").hide();
				break;
			case "linie-dreapta":
				
				break;
			case "bicicleta":
				$("#content_tab_detalii_consum, div.tabs_mobile, #table_instructiuni").hide();
				break;
		};
	};
};sl      \f\f@1iY\<   '    :https://distanta.ro/temp/js/logic.js?9 necko:classified 1 strongly-framed 1 security-info FnhllAKWRHGAlo+ESXykKAAAAAAAAAAAwAAAAAAAAEaphjojH6pBabDSgSnsfLHeAAQAAgAAAAAAAAAAAAAAAAAAAAAB4vFIJp5wRkeyPxAQ9RJGKPqbqVvKO0mKuIl8ec8o/uhmCjImkVxP+7sgiYWmMt8FvcOXmlQiTNWFiWlrbpbqgwAAAAAAAAY2MIIGMjCCBRqgAwIBAgIQXQurbpxyEGFYj01EOsC30zANBgkqhkiG9w0BAQsFADByMQswCQYDVQQGEwJVUzELMAkGA1UECBMCVFgxEDAOBgNVBAcTB0hvdXN0b24xFTATBgNVBAoTDGNQYW5lbCwgSW5jLjEtMCsGA1UEAxMkY1BhbmVsLCBJbmMuIENlcnRpZmljYXRpb24gQXV0aG9yaXR5MB4XDTE5MDMxOTAwMDAwMFoXDTE5MDYxNzIzNTk1OVowFjEUMBIGA1UEAxMLZGlzdGFudGEucm8wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCrBC0IWlvIKBkQZjsag+Iytwo49jS3pnYz7M/h9mYR2JJQGFJgVV1qxCad8aIvg7YWyX//kWl7HudFX9qi1NlrpJUbccx7AkEWHGCgu7JDRSKY51R14mtV5etZVbY7tK3qYFnUUifvAFnjIanTzUrkr/EN0WVWJXO69dMmnHa4fLB9D1c6u/xMTbXSdI7wOLQe7JJLoo4yHtY5S/iPfTw/n3/Cl0E3Mi2N0pwuv297p69JvxeAfl9sgs9P9+1wUWxmfSlvY30lkhL8AkRcQl/p3JW1rOuA5Sd7FJvQ9w5oa4RnM71pEVhsPBoJMcTIcdGL5QcPKn6PZsjGt6gIRUDjAgMBAAGjggMeMIIDGjAfBgNVHSMEGDAWgBR+A1plQWunfgrhuJ0I6h2OHWrHZTAdBgNVHQ4EFgQUSlm/tHXS6cl8+THeE+RCkW++uTMwDgYDVR0PAQH/BAQDAgWgMAwGA1UdEwEB/wQCMAAwHQYDVR0lBBYwFAYIKwYBBQUHAwEGCCsGAQUFBwMCME8GA1UdIARIMEYwOgYLKwYBBAGyMQECAjQwKzApBggrBgEFBQcCARYdaHR0cHM6Ly9zZWN1cmUuY29tb2RvLmNvbS9DUFMwCAYGZ4EMAQIBMEwGA1UdHwRFMEMwQaA/oD2GO2h0dHA6Ly9jcmwuY29tb2RvY2EuY29tL2NQYW5lbEluY0NlcnRpZmljYXRpb25BdXRob3JpdHkuY3JsMH0GCCsGAQUFBwEBBHEwbzBHBggrBgEFBQcwAoY7aHR0cDovL2NydC5jb21vZG9jYS5jb20vY1BhbmVsSW5jQ2VydGlmaWNhdGlvbkF1dGhvcml0eS5jcnQwJAYIKwYBBQUHMAGGGGh0dHA6Ly9vY3NwLmNvbW9kb2NhLmNvbTB3BgNVHREEcDBuggtkaXN0YW50YS5yb4ISY3BhbmVsLmRpc3RhbnRhLnJvghBtYWlsLmRpc3RhbnRhLnJvghN3ZWJkaXNrLmRpc3RhbnRhLnJvghN3ZWJtYWlsLmRpc3RhbnRhLnJvgg93d3cuZGlzdGFudGEucm8wggECBgorBgEEAdZ5AgQCBIHzBIHwAO4AdQC72d+8H4pxtZOUI5eqkntHOFeVCqtS6BqQlmQ2jh7RhQAAAWmUF6nTAAAEAwBGMEQCIBEWU4YfaHkUADrFRvwSSntiWxMDahLpiPIYosAtm3K8AiADzW1aEgJbY+K5apnJrI2HAGNM2Z+hFPdr+UJWw72DeAB1AHR+2oMxrTMQkSGcziVPQnDCv/1eQiAIxjc1eeYQe8xWAAABaZQXqhUAAAQDAEYwRAIgRj0YEojZJlanmMMsLLKMslPpPWy8EYVAX51O5yNMM+8CIGZ6s0r9ILCkVm3I0b1bb5fXVIlg9kE9SSCtJ2TrENarMA0GCSqGSIb3DQEBCwUAA4IBAQBOBAa2Y682qjYEFTL2JRS6AHMvnJLo6synX2KT7LinNj3mt3u70VrmDXOubdxHCzQ4QoygMTU3IWwO6DyOPHZaogUnZ1ktU03/LevhkMtUy12Tr6uZroYHoPzHn/pr144J/ZlFm3Xjl6UpyEn42oi5SbzqCzgCc08i/Jp7M/2Lhoon8sFQse/PCC2A8msw5Qm0aDBFhXPBJp8TlqU/Vk19ZNBNSjyNWEtKMTCI6fjZ1B9bLqrvktH25wsveIdn3MjTf5JRXvZnFwpv+9ZTEMbFQ9P91dshN9E0dmjLrHxaVegFOjgp5Phdhnkf/uq0zp9I+xxDuSEPaoTLKdabEp6pwC8DAwAAAAABAQAAAAAAAARub25lAAAAEFJTQS1QS0NTMS1TSEEyNTYAAAA= request-method GET response-head HTTP/1.1 200 OK
Date: Thu, 28 Mar 2019 06:16:28 GMT
Server: Apache
Last-Modified: Sun, 26 Aug 2018 13:11:08 GMT
Accept-Ranges: bytes
Content-Length: 259181
Content-Type: application/javascript
 original-response-headers Date: Thu, 28 Mar 2019 06:16:28 GMT
Server: Apache
Last-Modified: Sun, 26 Aug 2018 13:11:08 GMT
Accept-Ranges: bytes
Content-Length: 259181
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive
Content-Type: application/javascript
 uncompressed-len 0 net-response-time-onstart 57 net-response-time-onstop 148  m